<!doctype html><html lang="en"><head><title data-rh="true">Stock Price Prediction Using Transformers | by Mattafrank | May, 2024 | Medium</title><meta data-rh="true" charset="utf-8"/><meta data-rh="true" name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1,maximum-scale=1"/><meta data-rh="true" name="theme-color" content="#000000"/><meta data-rh="true" name="twitter:app:name:iphone" content="Medium"/><meta data-rh="true" name="twitter:app:id:iphone" content="828256236"/><meta data-rh="true" property="al:ios:app_name" content="Medium"/><meta data-rh="true" property="al:ios:app_store_id" content="828256236"/><meta data-rh="true" property="al:android:package" content="com.medium.reader"/><meta data-rh="true" property="fb:app_id" content="542599432471018"/><meta data-rh="true" property="og:site_name" content="Medium"/><meta data-rh="true" property="og:type" content="article"/><meta data-rh="true" property="article:published_time" content="2024-05-06T19:00:59.212Z"/><meta data-rh="true" name="title" content="Stock Price Prediction Using Transformers | by Mattafrank | May, 2024 | Medium"/><meta data-rh="true" property="og:title" content="Stock Price Prediction Using Transformers"/><meta data-rh="true" property="al:android:url" content="medium://p/2d84341ff213"/><meta data-rh="true" property="al:ios:url" content="medium://p/2d84341ff213"/><meta data-rh="true" property="al:android:app_name" content="Medium"/><meta data-rh="true" name="description" content="In the fast-paced world of finance, the ability to predict stock prices accurately offers a significant advantage to traders and investors alike. However, the inherently volatile nature of financial…"/><meta data-rh="true" property="og:description" content="Introduction: The Evolving Landscape of Stock Price Prediction"/><meta data-rh="true" property="og:url" content="https://medium.com/@Matthew_Frank/stock-price-prediction-using-transformers-2d84341ff213"/><meta data-rh="true" property="al:web:url" content="https://medium.com/@Matthew_Frank/stock-price-prediction-using-transformers-2d84341ff213"/><meta data-rh="true" property="og:image" content="https://miro.medium.com/v2/da:true/resize:fit:1024/0*DkD1UqtzggbRdfe8"/><meta data-rh="true" property="article:author" content="https://medium.com/@Matthew_Frank"/><meta data-rh="true" name="author" content="Mattafrank"/><meta data-rh="true" name="robots" content="index,follow,max-image-preview:large"/><meta data-rh="true" name="referrer" content="unsafe-url"/><meta data-rh="true" property="twitter:title" content="Stock Price Prediction Using Transformers"/><meta data-rh="true" name="twitter:site" content="@Medium"/><meta data-rh="true" name="twitter:app:url:iphone" content="medium://p/2d84341ff213"/><meta data-rh="true" property="twitter:description" content="Introduction: The Evolving Landscape of Stock Price Prediction"/><meta data-rh="true" name="twitter:image:src" content="https://miro.medium.com/v2/da:true/resize:fit:1024/0*DkD1UqtzggbRdfe8"/><meta data-rh="true" name="twitter:card" content="summary_large_image"/><meta data-rh="true" name="twitter:label1" content="Reading time"/><meta data-rh="true" name="twitter:data1" content="20 min read"/><link data-rh="true" rel="icon" href="https://miro.medium.com/v2/1*m-R_BkNf1Qjr1YbyOIJY2w.png"/><link data-rh="true" rel="search" type="application/opensearchdescription+xml" title="Medium" href="/osd.xml"/><link data-rh="true" rel="apple-touch-icon" sizes="152x152" href="https://miro.medium.com/v2/resize:fill:152:152/1*sHhtYhaCe2Uc3IU0IgKwIQ.png"/><link data-rh="true" rel="apple-touch-icon" sizes="120x120" href="https://miro.medium.com/v2/resize:fill:120:120/1*sHhtYhaCe2Uc3IU0IgKwIQ.png"/><link data-rh="true" rel="apple-touch-icon" sizes="76x76" href="https://miro.medium.com/v2/resize:fill:76:76/1*sHhtYhaCe2Uc3IU0IgKwIQ.png"/><link data-rh="true" rel="apple-touch-icon" sizes="60x60" href="https://miro.medium.com/v2/resize:fill:60:60/1*sHhtYhaCe2Uc3IU0IgKwIQ.png"/><link data-rh="true" rel="mask-icon" href="https://cdn-static-1.medium.com/_/fp/icons/Medium-Avatar-500x500.svg" color="#171717"/><link data-rh="true" rel="preconnect" href="https://glyph.medium.com" crossOrigin=""/><link data-rh="true" id="glyph_preload_link" rel="preload" as="style" type="text/css" href="https://glyph.medium.com/css/unbound.css"/><link data-rh="true" id="glyph_link" rel="stylesheet" type="text/css" href="https://glyph.medium.com/css/unbound.css"/><link data-rh="true" rel="author" href="https://medium.com/@Matthew_Frank"/><link data-rh="true" rel="canonical" href="https://medium.com/@Matthew_Frank/stock-price-prediction-using-transformers-2d84341ff213"/><link data-rh="true" rel="alternate" href="android-app://com.medium.reader/https/medium.com/p/2d84341ff213"/><script data-rh="true" type="application/ld+json">{"@context":"http:\u002F\u002Fschema.org","@type":"NewsArticle","image":["https:\u002F\u002Fmiro.medium.com\u002Fv2\u002Fda:true\u002Fresize:fit:1200\u002F0*DkD1UqtzggbRdfe8"],"url":"https:\u002F\u002Fmedium.com\u002F@Matthew_Frank\u002Fstock-price-prediction-using-transformers-2d84341ff213","dateCreated":"2024-05-05T22:15:31.568Z","datePublished":"2024-05-05T22:15:31.568Z","dateModified":"2024-05-26T07:52:13.681Z","headline":"Stock Price Prediction Using Transformers - Mattafrank - Medium","name":"Stock Price Prediction Using Transformers - Mattafrank - Medium","description":"In the fast-paced world of finance, the ability to predict stock prices accurately offers a significant advantage to traders and investors alike. However, the inherently volatile nature of financial…","identifier":"2d84341ff213","author":{"@type":"Person","name":"Mattafrank","url":"https:\u002F\u002Fmedium.com\u002F@Matthew_Frank"},"creator":["Mattafrank"],"publisher":{"@type":"Organization","name":"Medium","url":"https:\u002F\u002Fmedium.com\u002F","logo":{"@type":"ImageObject","width":308,"height":60,"url":"https:\u002F\u002Fmiro.medium.com\u002Fv2\u002Fresize:fit:616\u002F1*OMF3fSqH8t4xBJ9-6oZDZw.png"}},"mainEntityOfPage":"https:\u002F\u002Fmedium.com\u002F@Matthew_Frank\u002Fstock-price-prediction-using-transformers-2d84341ff213"}</script><style type="text/css" data-fela-rehydration="556" data-fela-type="STATIC">html{box-sizing:border-box;-webkit-text-size-adjust:100%}*, *:before, *:after{box-sizing:inherit}body{margin:0;padding:0;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;color:rgba(0,0,0,0.8);position:relative;min-height:100vh}h1, h2, h3, h4, h5, h6, dl, dd, ol, ul, menu, figure, blockquote, p, pre, form{margin:0}menu, ol, ul{padding:0;list-style:none;list-style-image:none}main{display:block}a{color:inherit;text-decoration:none}a, button, input{-webkit-tap-highlight-color:transparent}img, svg{vertical-align:middle}button{background:transparent;overflow:visible}button, input, optgroup, select, textarea{margin:0}:root{--reach-tabs:1;--reach-menu-button:1}#speechify-root{font-family:Sohne, sans-serif}div[data-popper-reference-hidden="true"]{visibility:hidden;pointer-events:none}.grecaptcha-badge{visibility:hidden}
/*XCode style (c) Angel Garcia <angelgarcia.mail@gmail.com>*/.hljs {background: #fff;color: black;
}/* Gray DOCTYPE selectors like WebKit */
.xml .hljs-meta {color: #c0c0c0;
}.hljs-comment,
.hljs-quote {color: #007400;
}.hljs-tag,
.hljs-attribute,
.hljs-keyword,
.hljs-selector-tag,
.hljs-literal,
.hljs-name {color: #aa0d91;
}.hljs-variable,
.hljs-template-variable {color: #3F6E74;
}.hljs-code,
.hljs-string,
.hljs-meta .hljs-string {color: #c41a16;
}.hljs-regexp,
.hljs-link {color: #0E0EFF;
}.hljs-title,
.hljs-symbol,
.hljs-bullet,
.hljs-number {color: #1c00cf;
}.hljs-section,
.hljs-meta {color: #643820;
}.hljs-title.class_,
.hljs-class .hljs-title,
.hljs-type,
.hljs-built_in,
.hljs-params {color: #5c2699;
}.hljs-attr {color: #836C28;
}.hljs-subst {color: #000;
}.hljs-formula {background-color: #eee;font-style: italic;
}.hljs-addition {background-color: #baeeba;
}.hljs-deletion {background-color: #ffc8bd;
}.hljs-selector-id,
.hljs-selector-class {color: #9b703f;
}.hljs-doctag,
.hljs-strong {font-weight: bold;
}.hljs-emphasis {font-style: italic;
}
</style><style type="text/css" data-fela-rehydration="556" data-fela-type="KEYFRAME">@-webkit-keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}@-moz-keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}@keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}</style><style type="text/css" data-fela-rehydration="556" data-fela-type="RULE">.a{font-family:medium-content-sans-serif-font, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif}.b{font-weight:400}.c{background-color:rgba(255, 255, 255, 1)}.l{display:block}.m{position:sticky}.n{top:0}.o{z-index:500}.p{padding:0 24px}.q{align-items:center}.r{border-bottom:solid 1px #F2F2F2}.y{height:41px}.z{line-height:20px}.ab{display:flex}.ac{height:57px}.ae{flex:1 0 auto}.af{color:inherit}.ag{fill:inherit}.ah{font-size:inherit}.ai{border:inherit}.aj{font-family:inherit}.ak{letter-spacing:inherit}.al{font-weight:inherit}.am{padding:0}.an{margin:0}.ao{cursor:pointer}.ap:disabled{cursor:not-allowed}.aq:disabled{color:#6B6B6B}.ar:disabled{fill:#6B6B6B}.au{margin-left:16px}.av{border:none}.aw{border-radius:20px}.ax{width:240px}.ay{background:#F9F9F9}.az path{fill:#6B6B6B}.bb{outline:none}.bc{font-family:sohne, "Helvetica Neue", Helvetica, Arial, sans-serif}.bd{font-size:14px}.be{width:100%}.bf{padding:10px 20px 10px 0}.bg{background-color:transparent}.bh{color:#242424}.bi::placeholder{color:#6B6B6B}.bj{display:inline-block}.bk{margin-left:12px}.bl{margin-right:12px}.bm{border-radius:4px}.bn{margin-left:24px}.bo{height:24px}.bu{background-color:#F9F9F9}.bv{border-radius:50%}.bw{height:32px}.bx{width:32px}.by{justify-content:center}.ce{max-width:680px}.cf{min-width:0}.cg{animation:k1 1.2s ease-in-out infinite}.ch{height:100vh}.ci{margin-bottom:16px}.cj{margin-top:48px}.ck{align-items:flex-start}.cl{flex-direction:column}.cm{justify-content:space-between}.cn{margin-bottom:24px}.ct{width:80%}.cu{background-color:#F2F2F2}.da{height:44px}.db{width:44px}.dc{margin:auto 0}.dd{margin-bottom:4px}.de{height:16px}.df{width:120px}.dg{width:80px}.dm{margin-bottom:8px}.dn{width:96%}.do{width:98%}.dp{width:81%}.dq{margin-left:8px}.dr{color:#6B6B6B}.ds{font-size:13px}.dt{height:100%}.el{color:#FFFFFF}.em{fill:#FFFFFF}.eo{background:#1A8917}.ep{border-color:#1A8917}.et:disabled{cursor:inherit !important}.eu:disabled{opacity:0.3}.ev:disabled:hover{background:#1A8917}.ew:disabled:hover{border-color:#1A8917}.ex{border-radius:99em}.ey{border-width:1px}.ez{border-style:solid}.fa{box-sizing:border-box}.fb{text-decoration:none}.fc{text-align:center}.ff{margin-right:32px}.fg{position:relative}.fh{fill:#6B6B6B}.fk{background:transparent}.fl svg{margin-left:4px}.fm svg{fill:#6B6B6B}.fo{box-shadow:inset 0 0 0 1px rgba(0, 0, 0, 0.05)}.fp{position:absolute}.fw{margin:0 24px}.ga{background:rgba(255, 255, 255, 1)}.gb{border:1px solid #F2F2F2}.gc{box-shadow:0 1px 4px #F2F2F2}.gd{max-height:100vh}.ge{overflow-y:auto}.gf{left:0}.gg{top:calc(100vh + 100px)}.gh{bottom:calc(100vh + 100px)}.gi{width:10px}.gj{pointer-events:none}.gk{word-break:break-word}.gl{word-wrap:break-word}.gm:after{display:block}.gn:after{content:""}.go:after{clear:both}.gp{line-height:1.23}.gq{letter-spacing:0}.gr{font-style:normal}.gs{font-weight:700}.hn{margin-bottom:-0.27em}.ho{line-height:1.394}.ie{@media all and (max-width: 551.98px):8px}.if{@media all and (min-width: 552px) and (max-width: 727.98px):8px}.ig{@media all and (min-width: 728px) and (max-width: 903.98px):16px}.ih{@media all and (min-width: 904px) and (max-width: 1079.98px):16px}.ii{@media all and (min-width: 1080px):16px}.io{align-items:baseline}.ip{width:48px}.iq{height:48px}.ir{border:2px solid rgba(255, 255, 255, 1)}.is{z-index:0}.it{box-shadow:none}.iu{border:1px solid rgba(0, 0, 0, 0.05)}.iv{margin-bottom:2px}.iw{flex-wrap:nowrap}.ix{font-size:16px}.iy{line-height:24px}.ja{margin:0 8px}.jb{display:inline}.jc{color:#1A8917}.jd{fill:#1A8917}.jg{flex:0 0 auto}.jj{flex-wrap:wrap}.jk{padding-left:8px}.jl{padding-right:8px}.km> *{flex-shrink:0}.kn{overflow-x:scroll}.ko::-webkit-scrollbar{display:none}.kp{scrollbar-width:none}.kq{-ms-overflow-style:none}.kr{width:74px}.ks{flex-direction:row}.kt{z-index:2}.ku{margin-right:4px}.kx{-webkit-user-select:none}.ky{border:0}.kz{fill:rgba(117, 117, 117, 1)}.lc{outline:0}.ld{user-select:none}.le> svg{pointer-events:none}.ln{cursor:progress}.lo{margin-left:4px}.lp{margin-top:0px}.lq{opacity:1}.lr{padding:4px 0}.lu{width:16px}.lw{display:inline-flex}.mc{max-width:100%}.md{padding:8px 2px}.me svg{color:#6B6B6B}.mv{line-height:1.58}.mw{letter-spacing:-0.004em}.mx{font-family:source-serif-pro, Georgia, Cambria, "Times New Roman", Times, serif}.nq{margin-bottom:-0.46em}.nr{font-style:italic}.ns{text-decoration:underline}.nt{margin-top:32px}.nu{margin-bottom:14px}.nv{padding-top:24px}.nw{padding-bottom:10px}.nx{background-color:#000000}.ny{height:3px}.nz{width:3px}.oa{margin-right:20px}.ob{line-height:1.12}.oc{letter-spacing:-0.022em}.od{font-weight:600}.ow{margin-bottom:-0.28em}.pc{overflow-x:auto}.pd{font-family:source-code-pro, Menlo, Monaco, "Courier New", Courier, monospace}.pe{padding:32px}.pf{border:1px solid #E5E5E5}.pg{line-height:1.4}.ph{margin-top:-0.2em}.pi{margin-bottom:-0.2em}.pj{white-space:pre}.pk{min-width:fit-content}.pv{line-height:1.18}.qj{margin-bottom:-0.31em}.qk{padding:2px 4px}.ql{font-size:75%}.qm> strong{font-family:inherit}.qn{list-style-type:disc}.qo{margin-left:30px}.qp{padding-left:0px}.qv{clear:both}.rb{margin-left:auto}.rc{margin-right:auto}.rd{max-width:1387px}.re{padding-top:5px}.rf{padding-bottom:5px}.rh{cursor:zoom-in}.ri{z-index:auto}.rk{height:auto}.rl{list-style-type:decimal}.rm{max-width:2498px}.rn{box-shadow:inset 3px 0 0 0 #242424}.ro{padding-left:23px}.rp{margin-left:-20px}.rq{max-width:459px}.rr{max-width:862px}.rs{max-width:1267px}.rt{max-width:1264px}.ru{max-width:738px}.rv{max-width:1024px}.rw{margin-bottom:26px}.rx{margin-top:6px}.ry{margin-top:8px}.rz{margin-right:8px}.sa{padding:8px 16px}.sb{border-radius:100px}.sc{transition:background 300ms ease}.se{white-space:nowrap}.sf{border-top:none}.sl{height:52px}.sm{max-height:52px}.sn{box-sizing:content-box}.so{position:static}.sp{z-index:1}.sr{max-width:155px}.tc{align-items:flex-end}.td{width:76px}.te{height:76px}.tf{border:2px solid #F9F9F9}.tg{height:72px}.th{width:72px}.ti{width:auto}.tj{stroke:#F2F2F2}.tk{height:36px}.tl{width:36px}.tm{color:#F2F2F2}.tn{fill:#F2F2F2}.to{background:#F2F2F2}.tp{border-color:#F2F2F2}.tv{font-weight:500}.tw{font-size:24px}.tx{line-height:30px}.ty{letter-spacing:-0.016em}.tz{margin-top:16px}.ua{height:0px}.ub{border-bottom:solid 1px #E5E5E5}.uh{margin-top:72px}.ui{padding:24px 0}.uj{margin-bottom:0px}.uk{margin-right:16px}.as:hover:not(:disabled){color:rgba(25, 25, 25, 1)}.at:hover:not(:disabled){fill:rgba(25, 25, 25, 1)}.eq:hover{background:#156D12}.er:hover{border-color:#156D12}.es:hover{cursor:pointer}.fi:hover{color:#242424}.fj:hover{fill:#242424}.fn:hover svg{fill:#242424}.fq:hover{background-color:rgba(0, 0, 0, 0.1)}.iz:hover{text-decoration:underline}.je:hover:not(:disabled){color:#156D12}.jf:hover:not(:disabled){fill:#156D12}.lb:hover{fill:rgba(8, 8, 8, 1)}.ls:hover{fill:#000000}.lt:hover p{color:#000000}.lv:hover{color:#000000}.mf:hover svg{color:#000000}.sd:hover{background-color:#F2F2F2}.tq:hover{background:#F2F2F2}.tr:hover{border-color:#F2F2F2}.ts:hover{cursor:wait}.tt:hover{color:#F2F2F2}.tu:hover{fill:#F2F2F2}.ba:focus-within path{fill:#242424}.la:focus{fill:rgba(8, 8, 8, 1)}.mg:focus svg{color:#000000}.rj:focus{transform:scale(1.01)}.lf:active{border-style:none}</style><style type="text/css" data-fela-rehydration="556" data-fela-type="RULE" media="all and (min-width: 1080px)">.d{display:none}.bt{width:64px}.cd{margin:0 64px}.cs{height:48px}.cz{margin-bottom:52px}.dl{margin-bottom:48px}.ec{font-size:14px}.ed{line-height:20px}.ej{font-size:13px}.ek{padding:5px 12px}.fe{display:flex}.fv{margin-bottom:68px}.fz{max-width:680px}.hj{font-size:42px}.hk{margin-top:1.19em}.hl{line-height:52px}.hm{letter-spacing:-0.011em}.ib{font-size:22px}.ic{margin-top:0.92em}.id{line-height:28px}.in{align-items:center}.jy{border-top:solid 1px #F2F2F2}.jz{border-bottom:solid 1px #F2F2F2}.ka{margin:32px 0 0}.kb{padding:3px 8px}.kk> *{margin-right:24px}.kl> :last-child{margin-right:0}.lm{margin-top:0px}.mb{margin:0}.nm{font-size:20px}.nn{margin-top:2.14em}.no{line-height:32px}.np{letter-spacing:-0.003em}.os{font-size:24px}.ot{margin-top:1.25em}.ou{line-height:30px}.ov{letter-spacing:-0.016em}.pb{margin-top:56px}.pp{margin-top:1.95em}.pu{margin-top:0.94em}.qg{margin-top:1.72em}.qh{line-height:24px}.qi{letter-spacing:0}.qu{margin-top:1.14em}.ra{max-width:1192px}.sk{margin-bottom:88px}.sw{display:inline-block}.tb{padding-top:72px}.ug{margin-top:40px}</style><style type="text/css" data-fela-rehydration="556" data-fela-type="RULE" media="all and (max-width: 1079.98px)">.e{display:none}.ll{margin-top:0px}.sv{display:inline-block}</style><style type="text/css" data-fela-rehydration="556" data-fela-type="RULE" media="all and (max-width: 903.98px)">.f{display:none}.lk{margin-top:0px}.su{display:inline-block}</style><style type="text/css" data-fela-rehydration="556" data-fela-type="RULE" media="all and (max-width: 727.98px)">.g{display:none}.li{margin-top:0px}.lj{margin-right:0px}.st{display:inline-block}</style><style type="text/css" data-fela-rehydration="556" data-fela-type="RULE" media="all and (max-width: 551.98px)">.h{display:none}.s{display:flex}.t{justify-content:space-between}.bp{width:24px}.bz{margin:0 24px}.co{height:40px}.cv{margin-bottom:44px}.dh{margin-bottom:32px}.du{font-size:13px}.dv{line-height:20px}.ee{padding:0px 8px 1px}.fr{margin-bottom:4px}.gt{font-size:32px}.gu{margin-top:1.01em}.gv{line-height:38px}.gw{letter-spacing:-0.014em}.hp{font-size:18px}.hq{margin-top:0.79em}.hr{line-height:24px}.ij{align-items:flex-start}.jh{flex-direction:column}.jm{margin:24px -24px 0}.jn{padding:0}.kc> *{margin-right:8px}.kd> :last-child{margin-right:24px}.kv{margin-left:0px}.lg{margin-top:0px}.lh{margin-right:0px}.lx{margin:0}.mh{border:1px solid #F2F2F2}.mi{border-radius:99em}.mj{padding:0px 16px 0px 12px}.mk{height:38px}.ml{align-items:center}.mn svg{margin-right:8px}.my{margin-top:1.56em}.mz{line-height:28px}.na{letter-spacing:-0.003em}.oe{font-size:20px}.of{margin-top:0.93em}.og{letter-spacing:0}.ox{margin-top:40px}.pl{margin-top:1.2em}.pq{margin-top:0.67em}.pw{font-size:16px}.px{margin-top:1.23em}.qq{margin-top:1.34em}.qw{max-width:100%}.sg{margin-bottom:80px}.ss{display:inline-block}.sx{padding-top:48px}.uc{margin-top:32px}.mm:hover{border-color:#E5E5E5}</style><style type="text/css" data-fela-rehydration="556" data-fela-type="RULE" media="all and (min-width: 904px) and (max-width: 1079.98px)">.i{display:none}.bs{width:64px}.cc{margin:0 64px}.cr{height:48px}.cy{margin-bottom:52px}.dk{margin-bottom:48px}.ea{font-size:14px}.eb{line-height:20px}.eh{font-size:13px}.ei{padding:5px 12px}.fd{display:flex}.fu{margin-bottom:68px}.fy{max-width:680px}.hf{font-size:42px}.hg{margin-top:1.19em}.hh{line-height:52px}.hi{letter-spacing:-0.011em}.hy{font-size:22px}.hz{margin-top:0.92em}.ia{line-height:28px}.im{align-items:center}.ju{border-top:solid 1px #F2F2F2}.jv{border-bottom:solid 1px #F2F2F2}.jw{margin:32px 0 0}.jx{padding:3px 8px}.ki> *{margin-right:24px}.kj> :last-child{margin-right:0}.ma{margin:0}.ni{font-size:20px}.nj{margin-top:2.14em}.nk{line-height:32px}.nl{letter-spacing:-0.003em}.oo{font-size:24px}.op{margin-top:1.25em}.oq{line-height:30px}.or{letter-spacing:-0.016em}.pa{margin-top:56px}.po{margin-top:1.95em}.pt{margin-top:0.94em}.qd{margin-top:1.72em}.qe{line-height:24px}.qf{letter-spacing:0}.qt{margin-top:1.14em}.qz{max-width:1192px}.sj{margin-bottom:88px}.ta{padding-top:72px}.uf{margin-top:40px}</style><style type="text/css" data-fela-rehydration="556" data-fela-type="RULE" media="all and (min-width: 728px) and (max-width: 903.98px)">.j{display:none}.w{display:flex}.x{justify-content:space-between}.br{width:64px}.cb{margin:0 48px}.cq{height:48px}.cx{margin-bottom:52px}.dj{margin-bottom:48px}.dy{font-size:13px}.dz{line-height:20px}.eg{padding:0px 8px 1px}.ft{margin-bottom:68px}.fx{max-width:680px}.hb{font-size:42px}.hc{margin-top:1.19em}.hd{line-height:52px}.he{letter-spacing:-0.011em}.hv{font-size:22px}.hw{margin-top:0.92em}.hx{line-height:28px}.il{align-items:center}.jq{border-top:solid 1px #F2F2F2}.jr{border-bottom:solid 1px #F2F2F2}.js{margin:32px 0 0}.jt{padding:3px 8px}.kg> *{margin-right:24px}.kh> :last-child{margin-right:0}.lz{margin:0}.ne{font-size:20px}.nf{margin-top:2.14em}.ng{line-height:32px}.nh{letter-spacing:-0.003em}.ok{font-size:24px}.ol{margin-top:1.25em}.om{line-height:30px}.on{letter-spacing:-0.016em}.oz{margin-top:56px}.pn{margin-top:1.95em}.ps{margin-top:0.94em}.qa{margin-top:1.72em}.qb{line-height:24px}.qc{letter-spacing:0}.qs{margin-top:1.14em}.qy{max-width:100%}.si{margin-bottom:88px}.sz{padding-top:72px}.ue{margin-top:40px}</style><style type="text/css" data-fela-rehydration="556" data-fela-type="RULE" media="all and (min-width: 552px) and (max-width: 727.98px)">.k{display:none}.u{display:flex}.v{justify-content:space-between}.bq{width:24px}.ca{margin:0 24px}.cp{height:40px}.cw{margin-bottom:44px}.di{margin-bottom:32px}.dw{font-size:13px}.dx{line-height:20px}.ef{padding:0px 8px 1px}.fs{margin-bottom:4px}.gx{font-size:32px}.gy{margin-top:1.01em}.gz{line-height:38px}.ha{letter-spacing:-0.014em}.hs{font-size:18px}.ht{margin-top:0.79em}.hu{line-height:24px}.ik{align-items:flex-start}.ji{flex-direction:column}.jo{margin:24px 0 0}.jp{padding:0}.ke> *{margin-right:8px}.kf> :last-child{margin-right:8px}.kw{margin-left:0px}.ly{margin:0}.mo{border:1px solid #F2F2F2}.mp{border-radius:99em}.mq{padding:0px 16px 0px 12px}.mr{height:38px}.ms{align-items:center}.mu svg{margin-right:8px}.nb{margin-top:1.56em}.nc{line-height:28px}.nd{letter-spacing:-0.003em}.oh{font-size:20px}.oi{margin-top:0.93em}.oj{letter-spacing:0}.oy{margin-top:40px}.pm{margin-top:1.2em}.pr{margin-top:0.67em}.py{font-size:16px}.pz{margin-top:1.23em}.qr{margin-top:1.34em}.qx{max-width:100%}.sh{margin-bottom:80px}.sy{padding-top:48px}.ud{margin-top:32px}.mt:hover{border-color:#E5E5E5}</style><style type="text/css" data-fela-rehydration="556" data-fela-type="RULE" media="print">.sq{display:none}</style><style type="text/css" data-fela-rehydration="556" data-fela-type="RULE" media="(prefers-reduced-motion: no-preference)">.rg{transition:transform 300ms cubic-bezier(0.2, 0, 0.2, 1)}</style></head><body><div id="root"><div class="a b c"><div class="d e f g h i j k"></div><script>document.domain = document.domain;</script><div class="l c"><div class="l m n o c"><div class="p q r s t u v w x i d y z"><a class="dr ag ds bc ak b am an ao ap aq ar as at s u w i d q dt z" href="https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F2d84341ff213&amp;%7Efeature=LoOpenInAppButton&amp;%7Echannel=ShowPostUnderUser&amp;source=---two_column_layout_nav----------------------------------" rel="noopener follow">Open in app<svg width="10" height="10" viewBox="0 0 10 10" fill="none" class="dq"><path d="M.98 8.48a.37.37 0 1 0 .54.54l-.54-.54zm7.77-7.23h.38c0-.2-.17-.38-.38-.38v.38zM8.37 6.5a.37.37 0 1 0 .76 0h-.76zM3.5.87a.37.37 0 1 0 0 .76V.88zM1.52 9.03l7.5-7.5-.54-.54-7.5 7.5.54.54zm6.86-7.77V6.5h.74V1.25h-.74zm-4.88.38h5.25V.88H3.5v.74z" fill="currentColor"></path></svg></a><div class="ab q"><p class="bc b du dv dw dx dy dz ea eb ec ed dr"><span><button class="bc b du dv ee dw dx ef dy dz eg eh eb ei ej ed ek el em eo ep eq er es et eu ev ew ex ey ez fa bj fb fc" data-testid="headerSignUpButton">Sign up</button></span></p><div class="au l"><p class="bc b du dv dw dx dy dz ea eb ec ed dr"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerSignInButton" rel="noopener follow" href="/m/signin?operation=login&amp;redirect=https%3A%2F%2Fmedium.com%2F%40Matthew_Frank%2Fstock-price-prediction-using-transformers-2d84341ff213&amp;source=post_page---two_column_layout_nav-----------------------global_nav-----------">Sign in</a></span></p></div></div></div><div class="p q r ab ac"><div class="ab q ae"><a class="af ag ah ai aj ak al am an ao ap aq ar as at ab" aria-label="Homepage" data-testid="headerMediumLogo" rel="noopener follow" href="/?source=---two_column_layout_nav----------------------------------"><svg width="120" height="27" viewBox="0 0 120 27" fill="none"><mask id="logo-wordmark-pride_svg__a" style="mask-type:alpha" maskUnits="userSpaceOnUse" x="1" y="0" width="119" height="27"><path d="M29.69 2.36h.03v-.29h-7.26L15.7 18.05 8.96 2.07H1.12v.28l.04.01c1.32.3 2 .75 2 2.37v19c0 1.62-.68 2.07-2 2.37h-.04v.29h5.31v-.28H6.4c-1.33-.3-2-.76-2-2.38V5.83l8.67 20.56h.5l8.91-21.13V24.2c-.1 1.28-.78 1.67-1.98 1.95h-.03v.28h9.25v-.27l-.03-.01c-1.2-.28-1.89-.67-2-1.95V4.73c0-1.62.67-2.07 2-2.37zm4.23 12.58c.15-3.41 1.37-5.87 3.4-5.92.64.01 1.17.22 1.58.62.87.86 1.28 2.64 1.22 5.3h-6.2zm-.1.96h10.86v-.04c-.03-2.61-.78-4.64-2.23-6.03a7.3 7.3 0 0 0-5.05-1.87h-.04a7.31 7.31 0 0 0-5.75 2.78 10.4 10.4 0 0 0-2.08 5.72l-.02.2a7.61 7.61 0 0 0-.02.56v.58c.11 5.09 2.84 9.16 7.69 9.16 4.25 0 6.73-3.14 7.35-7.34l-.32-.11c-1.08 2.26-3.03 3.63-5.25 3.46-3.03-.23-5.35-3.32-5.13-7.06m23.12 6.89c-.36.85-1.1 1.32-2.1 1.32s-1.9-.7-2.55-1.94a12.23 12.23 0 0 1-1.06-5.49c0-4.68 1.45-7.7 3.68-7.7.94 0 1.68.47 2.03 1.28V22.8zm7.2 3.33c-1.33-.31-2-.78-2-2.49V.96l-8.07 2.39v.3l.05-.01c1.11-.1 1.87.06 2.3.47.35.32.52.8.52 1.5v3.1a5.18 5.18 0 0 0-2.89-.75c-2.33 0-4.45.98-5.99 2.78-1.6 1.86-2.44 4.42-2.44 7.38 0 5.28 2.58 8.84 6.43 8.84a5.09 5.09 0 0 0 4.89-3.34v2.81h7.23v-.29h-.03zm6.9-22.09c0-1.65-1.23-2.9-2.87-2.9a2.87 2.87 0 0 0-2.9 2.9c0 1.63 1.27 2.9 2.9 2.9a2.82 2.82 0 0 0 2.88-2.9zm1.91 22.1c-1.32-.32-2-.8-2-2.5V8.01l-7.24 2.1v.28h.05c1.56.14 1.99.68 1.99 2.53v13.51H73v-.29h-.04zm18.54 0c-1.33-.32-2-.8-2-2.5V8.01l-6.89 2.02v.29h.04c1.28.14 1.65.71 1.65 2.56v9.88a2.48 2.48 0 0 1-2.2 1.4c-1.57 0-2.43-1.08-2.43-3.02V8.01l-7.24 2.1v.28h.04c1.57.14 2 .68 2 2.53v8.36c0 .58.05 1.16.15 1.74l.13.57c.61 2.21 2.22 3.37 4.73 3.37 2.13 0 4-1.33 4.82-3.4v2.88h7.23v-.3h-.03zm28.1.3v-.3h-.03c-1.44-.34-2-.97-2-2.26V13.25c0-3.31-1.85-5.3-4.95-5.3a5.08 5.08 0 0 0-4.9 3.37c-.58-2.17-2.25-3.36-4.73-3.36a4.7 4.7 0 0 0-4.61 3.1V8.02l-7.23 2v.3h.04c1.55.14 2 .7 2 2.49v13.63h6.74v-.29h-.03c-1.15-.28-1.52-.78-1.52-2.05V11.9c.3-.71.91-1.56 2.13-1.56 1.5 0 2.26 1.05 2.26 3.12v12.97h6.75v-.29h-.03c-1.15-.28-1.52-.78-1.52-2.05V13.25a7 7 0 0 0-.1-1.21c.32-.78.97-1.7 2.23-1.7 1.53 0 2.27 1.02 2.27 3.12v12.97h7.23z" fill="#242424"></path></mask><g filter="url(#logo-wordmark-pride_svg__filter0_f_238_6555)" mask="url(#logo-wordmark-pride_svg__a)"><path d="M42.3-64.7l-15.52-6.74L-24.62 47l15.53 6.74L42.3-64.7z" fill="#000"></path><path d="M53.18-59.98L42.3-64.7-9.1 53.74l10.88 4.72 51.4-118.44z" fill="#603917"></path><path d="M64.96-54.87l-11.78-5.11L1.78 58.46l11.79 5.11 51.4-118.44z" fill="#71E2FD"></path><path d="M75.84-50.15l-10.88-4.72-51.4 118.44 10.89 4.72L75.84-50.15z" fill="#FF9BC9"></path><path d="M86.71-45.43l-10.87-4.72L24.44 68.3l10.88 4.72 51.4-118.44z" fill="#FF472F"></path><path d="M97.6-40.7L86.7-45.44 35.32 73.01l10.88 4.72L97.6-40.7z" fill="#FF8312"></path><path d="M108.47-35.99L97.6-40.7 46.2 77.73l10.88 4.72 51.4-118.44z" fill="#FFCE00"></path><path d="M120.25-30.88l-11.78-5.1-51.4 118.43 11.79 5.11 51.4-118.44z" fill="#48E348"></path><path d="M131.13-26.16l-10.88-4.72L68.86 87.56l10.88 4.72 51.4-118.44z" fill="#008EF0"></path><path d="M148.48-18.63l-17.35-7.53-51.4 118.44 17.35 7.53 51.4-118.44z" fill="#9A50FC"></path></g><defs><filter id="logo-wordmark-pride_svg__filter0_f_238_6555" x="-29.5" y="-76.33" width="182.87" height="181.03" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB"><feFlood flood-opacity="0" result="BackgroundImageFix"></feFlood><feBlend in="SourceGraphic" in2="BackgroundImageFix" result="shape"></feBlend><feGaussianBlur stdDeviation="2.45" result="effect1_foregroundBlur_238_6555"></feGaussianBlur></filter></defs></svg></a><div class="au h"><div class="ab av aw ax ay q az ba"><div class="bj" aria-hidden="false" aria-describedby="searchResults" aria-labelledby="searchResults"></div><div class="bk bl ab"><svg width="24" height="24" viewBox="0 0 24 24" fill="none"><path fill-rule="evenodd" clip-rule="evenodd" d="M4.1 11.06a6.95 6.95 0 1 1 13.9 0 6.95 6.95 0 0 1-13.9 0zm6.94-8.05a8.05 8.05 0 1 0 5.13 14.26l3.75 3.75a.56.56 0 1 0 .8-.79l-3.74-3.73A8.05 8.05 0 0 0 11.04 3v.01z" fill="currentColor"></path></svg></div><input role="combobox" aria-controls="searchResults" aria-expanded="false" aria-label="search" data-testid="headerSearchInput" tabindex="0" class="av bb bc bd z be bf bg bh bi" placeholder="Search" value=""/></div></div></div><div class="h k w fd fe"><div class="ff ab"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerWriteButton" rel="noopener follow" href="/m/signin?operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fnew-story&amp;source=---two_column_layout_nav-----------------------new_post_topnav-----------"><div class="bc b bd z dr fg fh ab q fi fj"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" aria-label="Write"><path d="M14 4a.5.5 0 0 0 0-1v1zm7 6a.5.5 0 0 0-1 0h1zm-7-7H4v1h10V3zM3 4v16h1V4H3zm1 17h16v-1H4v1zm17-1V10h-1v10h1zm-1 1a1 1 0 0 0 1-1h-1v1zM3 20a1 1 0 0 0 1 1v-1H3zM4 3a1 1 0 0 0-1 1h1V3z" fill="currentColor"></path><path d="M17.5 4.5l-8.46 8.46a.25.25 0 0 0-.06.1l-.82 2.47c-.07.2.12.38.31.31l2.47-.82a.25.25 0 0 0 .1-.06L19.5 6.5m-2-2l2.32-2.32c.1-.1.26-.1.36 0l1.64 1.64c.1.1.1.26 0 .36L19.5 6.5m-2-2l2 2" stroke="currentColor"></path></svg><div class="dq l">Write</div></div></a></span></div></div><div class="k j i d"><div class="ff ab"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerSearchButton" rel="noopener follow" href="/search?source=---two_column_layout_nav----------------------------------"><div class="bc b bd z dr fg fh ab q fi fj"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" aria-label="Search"><path fill-rule="evenodd" clip-rule="evenodd" d="M4.1 11.06a6.95 6.95 0 1 1 13.9 0 6.95 6.95 0 0 1-13.9 0zm6.94-8.05a8.05 8.05 0 1 0 5.13 14.26l3.75 3.75a.56.56 0 1 0 .8-.79l-3.74-3.73A8.05 8.05 0 0 0 11.04 3v.01z" fill="currentColor"></path></svg></div></a></div></div><div class="ff h k j"><div class="ab q"><p class="bc b du dv dw dx dy dz ea eb ec ed dr"><span><button class="bc b du dv ee dw dx ef dy dz eg eh eb ei ej ed ek el em eo ep eq er es et eu ev ew ex ey ez fa bj fb fc" data-testid="headerSignUpButton">Sign up</button></span></p><div class="au l"><p class="bc b du dv dw dx dy dz ea eb ec ed dr"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerSignInButton" rel="noopener follow" href="/m/signin?operation=login&amp;redirect=https%3A%2F%2Fmedium.com%2F%40Matthew_Frank%2Fstock-price-prediction-using-transformers-2d84341ff213&amp;source=post_page---two_column_layout_nav-----------------------global_nav-----------">Sign in</a></span></p></div></div></div><div class="l" aria-hidden="false"><button class="av fk am ab q ao fl fm fn" aria-label="user options menu" data-testid="headerUserIcon"><div class="l fg"><img alt="" class="l fa bv bw bx cu" src="https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png" width="32" height="32" loading="lazy" role="presentation"/><div class="fo bv l bw bx fp n av fq"></div></div></button></div></div></div><div class="l"><div class="fr fs ft fu fv l"><div class="ab by"><div class="cf be fw fx fy fz"></div></div><article><div class="l"><div class="l"><span class="l"></span><section><div><div class="fp gf gg gh gi gj"></div><div class="gk gl gm gn go"><div class="ab by"><div class="cf be fw fx fy fz"><div><h1 id="fdb8" class="pw-post-title gp gq gr bc gs gt gu gv gw gx gy gz ha hb hc hd he hf hg hh hi hj hk hl hm hn bh" data-testid="storyTitle">Stock Price Prediction Using Transformers</h1></div><div><h2 id="5bde" class="pw-subtitle-paragraph ho gq gr bc b hp hq hr hs ht hu hv hw hx hy hz ia ib ic id cn dr">Introduction: The Evolving Landscape of Stock Price Prediction</h2><div class="ie if ig ih ii"><div class="speechify-ignore ab cm"><div class="speechify-ignore be l"><div class="ij ik il im in ab"><div><div class="ab io"><a rel="noopener follow" href="/@Matthew_Frank?source=post_page-----2d84341ff213--------------------------------"><div><div class="bj" aria-hidden="false"><div class="l ip iq bv ir is"><div class="l fg"><img alt="Mattafrank" class="l fa bv da db cu" src="https://miro.medium.com/v2/resize:fill:88:88/1*qcpoaEXNU6D1tZbZVTZisw.png" width="44" height="44" loading="lazy" data-testid="authorPhoto"/><div class="it bv l da db fp n iu fq"></div></div></div></div></div></a></div></div><div class="bk be l"><div class="ab"><div style="flex:1"><span class="bc b bd z bh"><div class="iv ab q"><div class="ab q iw"><div class="ab q"><div><div class="bj" aria-hidden="false"><p class="bc b ix iy bh"><a class="af ag ah ai aj ak al am an ao ap aq ar iz" data-testid="authorName" rel="noopener follow" href="/@Matthew_Frank?source=post_page-----2d84341ff213--------------------------------">Mattafrank</a></p></div></div></div><span class="ja jb" aria-hidden="true"><span class="bc b bd z dr">·</span></span><p class="bc b ix iy dr"><span><a class="jc jd ah ai aj ak al am an ao ap aq ar eu je jf" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F60c8a92cde0b&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%40Matthew_Frank%2Fstock-price-prediction-using-transformers-2d84341ff213&amp;user=Mattafrank&amp;userId=60c8a92cde0b&amp;source=post_page-60c8a92cde0b----2d84341ff213---------------------post_header-----------">Follow</a></span></p></div></div></span></div></div><div class="l jg"><span class="bc b bd z dr"><div class="ab ck jh ji jj"><span class="bc b bd z dr"><div class="ab ae"><span data-testid="storyReadTime">20 min read</span><div class="jk jl l" aria-hidden="true"><span class="l" aria-hidden="true"><span class="bc b bd z dr">·</span></span></div><span data-testid="storyPublishDate">May 5, 2024</span></div></span></div></span></div></div></div><div class="ab cm jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb"><div class="h k w fd fe q"><div class="kr l"><div class="ab q ks kt"><div class="pw-multi-vote-icon fg ku kv kw kx"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerClapButton" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fp%2F2d84341ff213&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%40Matthew_Frank%2Fstock-price-prediction-using-transformers-2d84341ff213&amp;user=Mattafrank&amp;userId=60c8a92cde0b&amp;source=-----2d84341ff213---------------------clap_footer-----------"><div><div class="bj" aria-hidden="false"><div class="ky ao kz la lb lc am ld le lf kx"><svg width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" clip-rule="evenodd" d="M11.37.83L12 3.28l.63-2.45h-1.26zM13.92 3.95l1.52-2.1-1.18-.4-.34 2.5zM8.59 1.84l1.52 2.11-.34-2.5-1.18.4zM18.52 18.92a4.23 4.23 0 0 1-2.62 1.33l.41-.37c2.39-2.4 2.86-4.95 1.4-7.63l-.91-1.6-.8-1.67c-.25-.56-.19-.98.21-1.29a.7.7 0 0 1 .55-.13c.28.05.54.23.72.5l2.37 4.16c.97 1.62 1.14 4.23-1.33 6.7zm-11-.44l-4.15-4.15a.83.83 0 0 1 1.17-1.17l2.16 2.16a.37.37 0 0 0 .51-.52l-2.15-2.16L3.6 11.2a.83.83 0 0 1 1.17-1.17l3.43 3.44a.36.36 0 0 0 .52 0 .36.36 0 0 0 0-.52L5.29 9.51l-.97-.97a.83.83 0 0 1 0-1.16.84.84 0 0 1 1.17 0l.97.97 3.44 3.43a.36.36 0 0 0 .51 0 .37.37 0 0 0 0-.52L6.98 7.83a.82.82 0 0 1-.18-.9.82.82 0 0 1 .76-.51c.22 0 .43.09.58.24l5.8 5.79a.37.37 0 0 0 .58-.42L13.4 9.67c-.26-.56-.2-.98.2-1.29a.7.7 0 0 1 .55-.13c.28.05.55.23.73.5l2.2 3.86c1.3 2.38.87 4.59-1.29 6.75a4.65 4.65 0 0 1-4.19 1.37 7.73 7.73 0 0 1-4.07-2.25zm3.23-12.5l2.12 2.11c-.41.5-.47 1.17-.13 1.9l.22.46-3.52-3.53a.81.81 0 0 1-.1-.36c0-.23.09-.43.24-.59a.85.85 0 0 1 1.17 0zm7.36 1.7a1.86 1.86 0 0 0-1.23-.84 1.44 1.44 0 0 0-1.12.27c-.3.24-.5.55-.58.89-.25-.25-.57-.4-.91-.47-.28-.04-.56 0-.82.1l-2.18-2.18a1.56 1.56 0 0 0-2.2 0c-.2.2-.33.44-.4.7a1.56 1.56 0 0 0-2.63.75 1.6 1.6 0 0 0-2.23-.04 1.56 1.56 0 0 0 0 2.2c-.24.1-.5.24-.72.45a1.56 1.56 0 0 0 0 2.2l.52.52a1.56 1.56 0 0 0-.75 2.61L7 19a8.46 8.46 0 0 0 4.48 2.45 5.18 5.18 0 0 0 3.36-.5 4.89 4.89 0 0 0 4.2-1.51c2.75-2.77 2.54-5.74 1.43-7.59L18.1 7.68z"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l lg lh li lj lk ll lm"><p class="bc b ds z dr"><span class="ln">--</span></p></div></div></div><div><div class="bj" aria-hidden="false"><button class="ao ky lq lr ab q fh ls lt" aria-label="responses"><svg width="24" height="24" viewBox="0 0 24 24" class="lp"><path d="M18 16.8a7.14 7.14 0 0 0 2.24-5.32c0-4.12-3.53-7.48-8.05-7.48C7.67 4 4 7.36 4 11.48c0 4.13 3.67 7.48 8.2 7.48a8.9 8.9 0 0 0 2.38-.32c.23.2.48.39.75.56 1.06.69 2.2 1.04 3.4 1.04.22 0 .4-.11.48-.29a.5.5 0 0 0-.04-.52 6.4 6.4 0 0 1-1.16-2.65v.02zm-3.12 1.06l-.06-.22-.32.1a8 8 0 0 1-2.3.33c-4.03 0-7.3-2.96-7.3-6.59S8.17 4.9 12.2 4.9c4 0 7.1 2.96 7.1 6.6 0 1.8-.6 3.47-2.02 4.72l-.2.16v.26l.02.3a6.74 6.74 0 0 0 .88 2.4 5.27 5.27 0 0 1-2.17-.86c-.28-.17-.72-.38-.94-.59l.01-.02z"></path></svg><p class="bc b ds z dr"><span class="pw-responses-count lo lp">4</span></p></button></div></div></div><div class="ab q kc kd ke kf kg kh ki kj kk kl km kn ko kp kq"><div class="lu k j i d"></div><div class="h k"><div><div class="bj" aria-hidden="false"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerBookmarkButton" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F2d84341ff213&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%40Matthew_Frank%2Fstock-price-prediction-using-transformers-2d84341ff213&amp;source=-----2d84341ff213---------------------bookmark_footer-----------"><svg width="25" height="25" viewBox="0 0 25 25" fill="none" class="dr lv" aria-label="Add to list bookmark button"><path d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18V2.5zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .8.4l5.7-4.4 5.7 4.4a.5.5 0 0 0 .8-.4v-8.5a.5.5 0 0 0-1 0v7.48l-5.2-4a.5.5 0 0 0-.6 0l-5.2 4V7z" fill="currentColor"></path></svg></a></span></div></div></div><div class="fa lw ck"><div class="l ae"><div class="ab by"><div class="lx ly lz ma mb mc cf be"><div class="ab"><div class="bj be" aria-hidden="false"><div><div class="bj" aria-hidden="false"><button aria-label="Listen" data-testid="audioPlayButton" class="af fh ah ai aj ak al md an ao ap eu me mf lt mg mh mi mj mk s ml mm mn mo mp mq mr u ms mt mu"><svg width="24" height="24" viewBox="0 0 24 24" fill="none"><path fill-rule="evenodd" clip-rule="evenodd" d="M3 12a9 9 0 1 1 18 0 9 9 0 0 1-18 0zm9-10a10 10 0 1 0 0 20 10 10 0 0 0 0-20zm3.38 10.42l-4.6 3.06a.5.5 0 0 1-.78-.41V8.93c0-.4.45-.63.78-.41l4.6 3.06c.3.2.3.64 0 .84z" fill="currentColor"></path></svg><div class="j i d"><p class="bc b bd z dr">Listen</p></div></button></div></div></div></div></div></div></div></div><div class="bj" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bj" aria-hidden="false"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="headerSocialShareButton" class="af fh ah ai aj ak al md an ao ap eu me mf lt mg mh mi mj mk s ml mm mn mo mp mq mr u ms mt mu"><svg width="24" height="24" viewBox="0 0 24 24" fill="none"><path fill-rule="evenodd" clip-rule="evenodd" d="M15.22 4.93a.42.42 0 0 1-.12.13h.01a.45.45 0 0 1-.29.08.52.52 0 0 1-.3-.13L12.5 3v7.07a.5.5 0 0 1-.5.5.5.5 0 0 1-.5-.5V3.02l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.8a.42.42 0 0 1 .07.5zm-.1.14zm.88 2h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11a2 2 0 0 1-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.14c.1.1.15.22.15.35a.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9V8.96c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1z" fill="currentColor"></path></svg><div class="j i d"><p class="bc b bd z dr">Share</p></div></button></div></div></div></div></div></div></div></div></div><p id="4b98" class="pw-post-body-paragraph mv mw gr mx b hp my mz na hs nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq gk bh">In the fast-paced world of finance, the ability to predict stock prices accurately offers a significant advantage to traders and investors alike. However, the inherently volatile nature of financial markets makes this task extraordinarily challenging. Traditional statistical methods have long been employed to forecast trends and movements, but the rise of machine learning has revolutionized this field.</p><p id="df79" class="pw-post-body-paragraph mv mw gr mx b hp my mz na hs nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq gk bh">Among the various machine learning techniques, the introduction of Neural Network Architectures has marked a significant leap in predictive accuracy and processing capabilities. Recently, <strong class="mx gs"><em class="nr">Transformers</em></strong>, which are at the core of Large Language Models (LLMs), have emerged as a cutting-edge technology in this domain. Originally designed for natural language processing tasks, Transformers excel at handling sequential data due to their sophisticated attention mechanisms. This makes them exceptionally well-suited for time series analysis like stock price prediction, traditionally dominated by Long Short-Term Memory networks (LSTMs). While LSTMs have been a staple due to their ability to capture temporal dependencies, they are increasingly seen as less efficient compared to the parallel processing capabilities and scalability of Transformers.</p><p id="1562" class="pw-post-body-paragraph mv mw gr mx b hp my mz na hs nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq gk bh">Given the complexity of predicting exact stock prices, our approach focuses on determining the directional movement of stock prices instead. More specifically, we aim to predict whether the stock price at the end of the third hour will be higher or lower than the last known price at the end of the second hour. To achieve this, our model leverages 2 hours’ worth of data, segmented into 5-minute intervals, to make its predictions. This method not only simplifies the challenge but also aligns more closely with practical trading strategies where directional trends are often more valuable than exact future prices.</p><p id="459d" class="pw-post-body-paragraph mv mw gr mx b hp my mz na hs nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq gk bh">This article will delve into the specifics of employing a Transformer-based model for stock price prediction, exploring the intricacies of the architecture, the rationale behind using such a model, and the potential it holds for the future of algorithmic trading</p><p id="d68a" class="pw-post-body-paragraph mv mw gr mx b hp my mz na hs nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq gk bh">You can check out my notebook for this project <a class="af ns" href="https://colab.research.google.com/drive/1j3AYSIxhiNJSCP692pKPbLk4_-kG4Pmh?usp=sharing" rel="noopener ugc nofollow" target="_blank"><strong class="mx gs">here</strong></a><strong class="mx gs">.<br/></strong>Lets jump into some code!</p></div></div></div><div class="ab by nt nu nv nw" role="separator"><span class="nx bv bj ny nz oa"></span><span class="nx bv bj ny nz oa"></span><span class="nx bv bj ny nz"></span></div><div class="gk gl gm gn go"><div class="ab by"><div class="cf be fw fx fy fz"><h1 id="abf1" class="ob oc gr bc od oe of hr og oh oi hu oj ok ol om on oo op oq or os ot ou ov ow bh">Import Libraries</h1><pre class="ox oy oz pa pb pc pd pe bm pf ay bh"><span id="5c5e" class="pg oc gr pd b bd ph pi l pj pk">import math<br/>import numpy as np<br/>import pandas as pd<br/><br/>import tensorflow as tf<br/>from tensorflow.keras.models import Model<br/>from tensorflow.keras.callbacks import ModelCheckpoint<br/>from tensorflow.keras.layers import Input, Dense, Dropout, LayerNormalization, MultiHeadAttention, Add, GlobalAveragePooling1D<br/><br/>import yfinance as yf</span></pre><h1 id="73d2" class="ob oc gr bc od oe pl hr og oh pm hu oj ok pn om on oo po oq or os pp ou ov ow bh">Leveraging Financial Indicators for Enhanced Predictive Analysis</h1><p id="ecbd" class="pw-post-body-paragraph mv mw gr mx b hp pq mz na hs pr nc nd ne ps ng nh ni pt nk nl nm pu no np nq gk bh">In the world of stock trading, using the right financial indicators can significantly enhance the predictive capabilities of machine learning models. These indicators provide statistical insights into market trends and behaviors, which are crucial for making informed predictions. Below, we discuss three key metrics used in our model: Bollinger Bands, the Relative Strength Index (RSI), and the Rate of Change (ROC).</p><h2 id="13c8" class="pv oc gr bc od pw px dv og py pz dx oj ne qa qb qc ni qd qe qf nm qg qh qi qj bh">Bollinger Bands</h2><p id="7db4" class="pw-post-body-paragraph mv mw gr mx b hp pq mz na hs pr nc nd ne ps ng nh ni pt nk nl nm pu no np nq gk bh">Bollinger Bands are a type of statistical chart characterizing the prices and volatility over time of a financial instrument or commodity. The Bands consist of a middle band being a rolling mean, and two outer bands located at a distance that is a standard deviation away. This setup helps in identifying whether prices are high or low on a relative basis. They are particularly useful for finding periods of oversupply and undersupply, which can signal potential buying or selling opportunities.</p><h2 id="5525" class="pv oc gr bc od pw px dv og py pz dx oj ne qa qb qc ni qd qe qf nm qg qh qi qj bh">Relative Strength Index (RSI)</h2><p id="2a64" class="pw-post-body-paragraph mv mw gr mx b hp pq mz na hs pr nc nd ne ps ng nh ni pt nk nl nm pu no np nq gk bh">The Relative Strength Index (RSI) is a momentum oscillator that measures the speed and change of price movements. RSI oscillates between zero and 100. Traditionally, and according to Wilder, RSI is considered overbought when above 70 and oversold when below 30. This indicator helps traders identify potential reversal points based on the internal strength of the asset’s price movement.</p><h2 id="cc6e" class="pv oc gr bc od pw px dv og py pz dx oj ne qa qb qc ni qd qe qf nm qg qh qi qj bh">Rate of Change (ROC)</h2><p id="cd32" class="pw-post-body-paragraph mv mw gr mx b hp pq mz na hs pr nc nd ne ps ng nh ni pt nk nl nm pu no np nq gk bh">The Rate of Change (ROC) is a momentum oscillator, which measures the percentage change between the current price and the price a certain number of periods ago. ROC is often used to detect divergences, which occur when the price of an asset moves in the opposite direction of a technical indicator and may indicate that an asset’s price will undergo a reversal.</p><pre class="ox oy oz pa pb pc pd pe bm pf ay bh"><span id="5c0c" class="pg oc gr pd b bd ph pi l pj pk">def calculate_bollinger_bands(data, window=10, num_of_std=2):<br/>    &quot;&quot;&quot;Calculate Bollinger Bands&quot;&quot;&quot;<br/>    rolling_mean = data.rolling(window=window).mean()<br/>    rolling_std = data.rolling(window=window).std()<br/>    upper_band = rolling_mean + (rolling_std * num_of_std)<br/>    lower_band = rolling_mean - (rolling_std * num_of_std)<br/>    return upper_band, lower_band<br/><br/>def calculate_rsi(data, window=10):<br/>    &quot;&quot;&quot;Calculate Relative Strength Index&quot;&quot;&quot;<br/>    delta = data.diff()<br/>    gain = delta.clip(lower=0)<br/>    loss = -delta.clip(upper=0)<br/>    avg_gain = gain.rolling(window=window, min_periods=1).mean()<br/>    avg_loss = loss.rolling(window=window, min_periods=1).mean()<br/>    rs = avg_gain / avg_loss<br/>    rsi = 100 - (100 / (1 + rs))<br/>    return rsi<br/><br/>def calculate_roc(data, periods=10):<br/>    &quot;&quot;&quot;Calculate Rate of Change.&quot;&quot;&quot;<br/>    roc = ((data - data.shift(periods)) / data.shift(periods)) * 100<br/>    return roc</span></pre><h1 id="cde2" class="ob oc gr bc od oe pl hr og oh pm hu oj ok pn om on oo po oq or os pp ou ov ow bh">Focusing on Big Tech</h1><p id="ee35" class="pw-post-body-paragraph mv mw gr mx b hp pq mz na hs pr nc nd ne ps ng nh ni pt nk nl nm pu no np nq gk bh">In the rapidly evolving tech sector, companies like Meta, Apple, Microsoft, Amazon, and Alphabet (commonly referred to collectively as MAMAA) stand out not only for their size but also for their significant impact on global markets. By focusing our predictive model on these industry leaders, we aim to capture trends and patterns that are most relevant to the big tech sector. This strategic choice allows us to develop a model that can generalize across similarly positioned companies, offering insights into the movements of some of the most influential players in the stock market.</p><pre class="ox oy oz pa pb pc pd pe bm pf ay bh"><span id="9093" class="pg oc gr pd b bd ph pi l pj pk"># List of tickers for the big tech companies, forming the MAMAA group<br/>tickers = [&#x27;META&#x27;, &#x27;AAPL&#x27;, &#x27;MSFT&#x27;, &#x27;AMZN&#x27;, &#x27;GOOG&#x27;]</span></pre><h1 id="ad7d" class="ob oc gr bc od oe pl hr og oh pm hu oj ok pn om on oo po oq or os pp ou ov ow bh">Standardizing and Enhancing Data for Predictive Accuracy</h1><p id="b89a" class="pw-post-body-paragraph mv mw gr mx b hp pq mz na hs pr nc nd ne ps ng nh ni pt nk nl nm pu no np nq gk bh">To ensure our model can accurately interpret trends and make predictions, we meticulously process and enhance the data associated with each company in the MAMAA group. This involves several critical steps that transform raw stock data into a refined format ready for machine learning analysis.</p><h2 id="97b8" class="pv oc gr bc od pw px dv og py pz dx oj ne qa qb qc ni qd qe qf nm qg qh qi qj bh">Data Processing</h2><p id="5c8a" class="pw-post-body-paragraph mv mw gr mx b hp pq mz na hs pr nc nd ne ps ng nh ni pt nk nl nm pu no np nq gk bh"><strong class="mx gs">Data Retrieval:</strong> We download 60 days of historical stock data at 5-minute intervals using <code class="cu qk ql qm pd b">yfinance</code>. This high-resolution data helps capture intra-day volatility and trends.</p><p id="0b20" class="pw-post-body-paragraph mv mw gr mx b hp my mz na hs nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq gk bh"><strong class="mx gs">Feature Engineering:</strong></p><ul class=""><li id="55be" class="mv mw gr mx b hp my mz na hs nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq qn qo qp bh"><em class="nr">Bollinger Bands:</em> We calculate the Bollinger Bands to assess volatility. The width between the upper and lower bands (<code class="cu qk ql qm pd b">width</code>) is used as a feature, providing insights into market volatility.</li><li id="a874" class="mv mw gr mx b hp qq mz na hs qr nc nd ne qs ng nh ni qt nk nl nm qu no np nq qn qo qp bh"><em class="nr">Close Price and Volume:</em> We directly use the closing price and trading volume as features, which are fundamental to most trading models.</li><li id="09a2" class="mv mw gr mx b hp qq mz na hs qr nc nd ne qs ng nh ni qt nk nl nm qu no np nq qn qo qp bh"><em class="nr">Price Differences:</em> We calculate the difference (<code class="cu qk ql qm pd b">diff</code>) between the current close price and the previous close, capturing immediate price movements.</li><li id="1d96" class="mv mw gr mx b hp qq mz na hs qr nc nd ne qs ng nh ni qt nk nl nm qu no np nq qn qo qp bh"><em class="nr">Percentage Change:</em> The percentage change in close price from the previous close (<code class="cu qk ql qm pd b">percent_change_close</code>) highlights the rate of price changes, serving as a momentum indicator.</li></ul><p id="e72d" class="pw-post-body-paragraph mv mw gr mx b hp my mz na hs nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq gk bh"><strong class="mx gs">Normalization:</strong></p><ul class=""><li id="6709" class="mv mw gr mx b hp my mz na hs nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq qn qo qp bh">To ensure all features contribute equally to the model’s learning process, we standardize each feature by subtracting the mean and dividing by the standard deviation (<code class="cu qk ql qm pd b">mean</code> and <code class="cu qk ql qm pd b">std</code>).</li><li id="5123" class="mv mw gr mx b hp qq mz na hs qr nc nd ne qs ng nh ni qt nk nl nm qu no np nq qn qo qp bh">We save these statistical parameters (mean and standard deviation) for each feature. This is crucial for later “un-scaling” the model’s predictions to interpret them in their original scales.</li></ul><pre class="ox oy oz pa pb pc pd pe bm pf ay bh"><span id="e8d8" class="pg oc gr pd b bd ph pi l pj pk">ticker_data_frames = []<br/>stats = {}<br/>for ticker in tickers:<br/>  <br/>    # Download historical data for the ticker<br/>    data = yf.download(ticker, period=&quot;60d&quot;, interval=&quot;5m&quot;)<br/><br/>    # Calculate the daily percentage change<br/>    close = data[&#x27;Close&#x27;]<br/>    upper, lower = calculate_bollinger_bands(close, window=14, num_of_std=2)<br/>    width = upper - lower<br/>    rsi = calculate_rsi(close, window=14)<br/>    roc = calculate_roc(close, periods=14)<br/>    volume = data[&#x27;Volume&#x27;]<br/>    diff = data[&#x27;Close&#x27;].diff(1)<br/>    percent_change_close = data[&#x27;Close&#x27;].pct_change() * 100<br/><br/>    # Create a DataFrame for the current ticker and append it to the list<br/>    ticker_df = pd.DataFrame({<br/>        ticker+&#x27;_close&#x27;: close,<br/>        ticker+&#x27;_width&#x27;: width,<br/>        ticker+&#x27;_rsi&#x27;: rsi,<br/>        ticker+&#x27;_roc&#x27;: roc,<br/>        ticker+&#x27;_volume&#x27;: volume,<br/>        ticker+&#x27;_diff&#x27;: diff,<br/>        ticker+&#x27;_percent_change_close&#x27;: percent_change_close,<br/>    })<br/>    <br/>    MEAN = ticker_df.mean()<br/>    STD = ticker_df.std()<br/><br/>    # Keep track of mean and std<br/>    for column in MEAN.index:<br/>      stats[f&quot;{column}_mean&quot;] = MEAN[column]<br/>      stats[f&quot;{column}_std&quot;] = STD[column]<br/>    <br/>    # Normalize the training features<br/>    ticker_df = (ticker_df - MEAN) / STD<br/><br/>    ticker_data_frames.append(ticker_df)</span></pre><h1 id="5c73" class="ob oc gr bc od oe pl hr og oh pm hu oj ok pn om on oo po oq or os pp ou ov ow bh">Organizing Statistical Data for Model Reference</h1><p id="4a76" class="pw-post-body-paragraph mv mw gr mx b hp pq mz na hs pr nc nd ne ps ng nh ni pt nk nl nm pu no np nq gk bh">Once we have computed the necessary statistics for each feature across all tickers, it is essential to organize this data in a structured format. This organization aids in both model training and later stages where we might need to reverse the normalization process for interpretation and analysis.</p><h2 id="3f56" class="pv oc gr bc od pw px dv og py pz dx oj ne qa qb qc ni qd qe qf nm qg qh qi qj bh">Storing and Viewing Statistics</h2><p id="0e76" class="pw-post-body-paragraph mv mw gr mx b hp pq mz na hs pr nc nd ne ps ng nh ni pt nk nl nm pu no np nq gk bh">The statistical parameters — mean and standard deviation — for each feature are initially stored in a dictionary for ease of access and manipulation. To streamline the usage of these parameters within our model’s training and prediction phases, we convert this dictionary into a Pandas DataFrame. This conversion not only structures the data but also facilitates quick look-ups and operations on the statistical data.</p><pre class="ox oy oz pa pb pc pd pe bm pf ay bh"><span id="d3ac" class="pg oc gr pd b bd ph pi l pj pk"># Convert the dictionary containing feature statistics to a DataFrame for easier access<br/>stats = pd.DataFrame([stats], index=[0])<br/><br/># Display the DataFrame to verify its structure<br/>stats.head()</span></pre></div></div><div class="qv"><div class="ab by"><div class="lx qw ly qx lz qy cc qz cd ra cf be"><figure class="ox oy oz pa pb qv re rf paragraph-image"><div role="button" tabindex="0" class="rg rh fg ri be rj"><div class="rb rc rd"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*n7yaiUukh7X3jfaWXG-QfQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*n7yaiUukh7X3jfaWXG-QfQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*n7yaiUukh7X3jfaWXG-QfQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*n7yaiUukh7X3jfaWXG-QfQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*n7yaiUukh7X3jfaWXG-QfQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*n7yaiUukh7X3jfaWXG-QfQ.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*n7yaiUukh7X3jfaWXG-QfQ.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*n7yaiUukh7X3jfaWXG-QfQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*n7yaiUukh7X3jfaWXG-QfQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*n7yaiUukh7X3jfaWXG-QfQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*n7yaiUukh7X3jfaWXG-QfQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*n7yaiUukh7X3jfaWXG-QfQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*n7yaiUukh7X3jfaWXG-QfQ.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*n7yaiUukh7X3jfaWXG-QfQ.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"/><img alt="" class="be mc rk c" width="1000" height="86" loading="eager" role="presentation"/></picture></div></div></figure></div></div></div><div class="ab by"><div class="cf be fw fx fy fz"><h1 id="3772" class="ob oc gr bc od oe pl hr og oh pm hu oj ok pn om on oo po oq or os pp ou ov ow bh">Consolidating Data for Comprehensive Analysis</h1><p id="afb9" class="pw-post-body-paragraph mv mw gr mx b hp pq mz na hs pr nc nd ne ps ng nh ni pt nk nl nm pu no np nq gk bh">To facilitate a unified analysis and ensure that our model can learn from a broader dataset encompassing all selected big tech companies, we consolidate the individual dataframes into a single structure. This approach allows the model to understand and find patterns across multiple stocks simultaneously.</p><h2 id="c291" class="pv oc gr bc od pw px dv og py pz dx oj ne qa qb qc ni qd qe qf nm qg qh qi qj bh">Data Consolidation and Cleaning</h2><ol class=""><li id="0b28" class="mv mw gr mx b hp pq mz na hs pr nc nd ne ps ng nh ni pt nk nl nm pu no np nq rl qo qp bh"><strong class="mx gs">Concatenation:</strong> We concatenate the dataframes for each ticker along the columns. This means each ticker’s features will be side by side, enabling our model to access all relevant data points across different stocks within the same model input.</li><li id="0b7d" class="mv mw gr mx b hp qq mz na hs qr nc nd ne qs ng nh ni qt nk nl nm qu no np nq rl qo qp bh"><strong class="mx gs">Handling Infinite Values:</strong> In data processing, especially after normalization, it’s possible to encounter infinite values due to division by zero or other anomalies. We replace these infinite values with NaN (Not a Number) to prevent them from affecting subsequent calculations.</li><li id="f8ed" class="mv mw gr mx b hp qq mz na hs qr nc nd ne qs ng nh ni qt nk nl nm qu no np nq rl qo qp bh"><strong class="mx gs">Removing Missing Data:</strong> We then remove any rows that contain NaN values. This step is crucial to maintain the quality of the dataset, ensuring that the model trains on complete and accurate data only.</li><li id="c672" class="mv mw gr mx b hp qq mz na hs qr nc nd ne qs ng nh ni qt nk nl nm qu no np nq rl qo qp bh"><strong class="mx gs">Previewing the Data:</strong> Finally, to verify that our data is well-structured and ready for modeling, we display the first few rows. This preview helps confirm that the data alignment and cleaning processes have been executed correctly.</li></ol><pre class="ox oy oz pa pb pc pd pe bm pf ay bh"><span id="7e90" class="pg oc gr pd b bd ph pi l pj pk">df = pd.concat(ticker_data_frames, axis=1)<br/>df.replace([np.inf, -np.inf], np.nan, inplace=True)<br/>df.dropna(inplace=True)<br/>df.head()</span></pre></div></div><div class="qv"><div class="ab by"><div class="lx qw ly qx lz qy cc qz cd ra cf be"><figure class="ox oy oz pa pb qv re rf paragraph-image"><div role="button" tabindex="0" class="rg rh fg ri be rj"><div class="rb rc rm"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*xkcK0FSavHIwISDEP-NqvA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*xkcK0FSavHIwISDEP-NqvA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*xkcK0FSavHIwISDEP-NqvA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*xkcK0FSavHIwISDEP-NqvA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*xkcK0FSavHIwISDEP-NqvA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*xkcK0FSavHIwISDEP-NqvA.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*xkcK0FSavHIwISDEP-NqvA.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*xkcK0FSavHIwISDEP-NqvA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*xkcK0FSavHIwISDEP-NqvA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*xkcK0FSavHIwISDEP-NqvA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*xkcK0FSavHIwISDEP-NqvA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*xkcK0FSavHIwISDEP-NqvA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*xkcK0FSavHIwISDEP-NqvA.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*xkcK0FSavHIwISDEP-NqvA.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"/><img alt="" class="be mc rk c" width="1000" height="186" loading="eager" role="presentation"/></picture></div></div></figure></div></div></div><div class="ab by"><div class="cf be fw fx fy fz"><h1 id="7890" class="ob oc gr bc od oe pl hr og oh pm hu oj ok pn om on oo po oq or os pp ou ov ow bh">Preparing Data Labels for Predictive Modeling</h1><p id="085a" class="pw-post-body-paragraph mv mw gr mx b hp pq mz na hs pr nc nd ne ps ng nh ni pt nk nl nm pu no np nq gk bh">We generate labels by shifting the dataset to align future data points (i.e., future stock prices or indicators) with the current row’s features. This arrangement prepares the model to predict future outcomes based on current input data.</p><h2 id="6279" class="pv oc gr bc od pw px dv og py pz dx oj ne qa qb qc ni qd qe qf nm qg qh qi qj bh">Label Creation and Data Alignment</h2><ol class=""><li id="7389" class="mv mw gr mx b hp pq mz na hs pr nc nd ne ps ng nh ni pt nk nl nm pu no np nq rl qo qp bh"><strong class="mx gs">Creating Labels:</strong> We create the labels by shifting the entire DataFrame up by one position. This shift aligns each row with the subsequent time step’s data, which the model will attempt to predict.</li><li id="31bc" class="mv mw gr mx b hp qq mz na hs qr nc nd ne qs ng nh ni qt nk nl nm qu no np nq rl qo qp bh"><strong class="mx gs">Ensuring Data Integrity:</strong> After shifting the data, the last row in the DataFrame will not have a corresponding future data point to act as a label. To maintain data integrity and avoid training on incomplete data, we remove the last row from both the feature set (df) and the labels.</li></ol><pre class="ox oy oz pa pb pc pd pe bm pf ay bh"><span id="65c5" class="pg oc gr pd b bd ph pi l pj pk"># Shift the dataframe up by one to align current features with the next step&#x27;s outcomes<br/>labels = df.shift(-1)<br/><br/># Remove the last row from both the features and labels to maintain consistent data pairs<br/>df = df.iloc[:-1]<br/>labels = labels.iloc[:-1]</span></pre><h1 id="1555" class="ob oc gr bc od oe pl hr og oh pm hu oj ok pn om on oo po oq or os pp ou ov ow bh">Structuring Data into Sequences for Time-Series Forecasting</h1><p id="86c1" class="pw-post-body-paragraph mv mw gr mx b hp pq mz na hs pr nc nd ne ps ng nh ni pt nk nl nm pu no np nq gk bh">To train our model effectively on time-series data, it is crucial to structure the input into sequences that reflect the temporal dependencies inherent in stock prices. Our approach involves creating sequences that represent 2 hours of trading data, which prepares the model to predict stock movements in the subsequent hour.</p><h2 id="b818" class="pv oc gr bc od pw px dv og py pz dx oj ne qa qb qc ni qd qe qf nm qg qh qi qj bh">Sequence Creation and Label Preparation</h2><ol class=""><li id="6094" class="mv mw gr mx b hp pq mz na hs pr nc nd ne ps ng nh ni pt nk nl nm pu no np nq rl qo qp bh"><strong class="mx gs">Defining Sequence Length:</strong> We define the sequence length as 24, which corresponds to 2 hours of data at 5-minute intervals. This length is chosen to provide the model with enough recent historical data to detect short-term trends and patterns.</li><li id="467a" class="mv mw gr mx b hp qq mz na hs qr nc nd ne qs ng nh ni qt nk nl nm qu no np nq rl qo qp bh"><strong class="mx gs">Sequence and Label Generation:</strong></li></ol><ul class=""><li id="6a09" class="mv mw gr mx b hp my mz na hs nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq qn qo qp bh">The function <code class="cu qk ql qm pd b">create_sequences</code> constructs sequences of the specified length and prepares the corresponding labels. We aim to predict the stock price movement an hour beyond the end of each sequence, hence the additional 12 steps (representing 60 minutes) beyond the sequence length.</li><li id="b3e6" class="mv mw gr mx b hp qq mz na hs qr nc nd ne qs ng nh ni qt nk nl nm qu no np nq qn qo qp bh">Each label array not only includes the target value but also the mean and standard deviation of the feature set. This inclusion is critical for later stages when we need to un-scale predictions to their original scale for accurate interpretation and evaluation</li></ul><p id="b249" class="pw-post-body-paragraph mv mw gr mx b hp my mz na hs nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq gk bh">3. <strong class="mx gs">Importance of Scaling Information:</strong> Attaching the mean and standard deviation to each label is essential for our custom metrics during model evaluation. These scaling factors allow us to convert the model’s output back to the original scale, enabling us to accurately measure performance and make actionable predictions.</p><pre class="ox oy oz pa pb pc pd pe bm pf ay bh"><span id="2557" class="pg oc gr pd b bd ph pi l pj pk">SEQUENCE_LEN = 24  # 2 hours of data at 5-minute intervals<br/><br/>def create_sequences(data, labels, mean, std, sequence_length=SEQUENCE_LEN):<br/>    sequences = []<br/>    lab = []<br/>    data_size = len(data)<br/><br/>    # Loop to create each sequence and its corresponding label<br/>    for i in range(data_size - (sequence_length + 13)): # Ensure we have data for the label<br/>        if i == 0:<br/>          continue<br/>        sequences.append(data[i:i + sequence_length])  # The sequence of data<br/>        lab.append([labels[i-1], labels[i + 12], mean[0], std[0]]) # The label and scaling factors<br/>        <br/>    return np.array(sequences), np.array(lab)</span></pre><h1 id="1aec" class="ob oc gr bc od oe pl hr og oh pm hu oj ok pn om on oo po oq or os pp ou ov ow bh">Generating Training Sequences for Each Ticker</h1><p id="24cd" class="pw-post-body-paragraph mv mw gr mx b hp pq mz na hs pr nc nd ne ps ng nh ni pt nk nl nm pu no np nq gk bh">For our model to learn effectively from the vast array of stock data available, it’s essential to transform the preprocessed data into a format that the neural network can understand and learn from. This involves creating training sequences for each ticker that encapsulate the necessary features and labels.</p><h2 id="87de" class="pv oc gr bc od pw px dv og py pz dx oj ne qa qb qc ni qd qe qf nm qg qh qi qj bh">Sequence Generation for Each Ticker</h2><ol class=""><li id="dacc" class="mv mw gr mx b hp pq mz na hs pr nc nd ne ps ng nh ni pt nk nl nm pu no np nq rl qo qp bh"><strong class="mx gs">Data Extraction:</strong> For each ticker, we extract multiple features from the DataFrame. These features include the closing price, Bollinger Band width, RSI, ROC, trading volume, the difference in closing prices, and the percentage change in closing prices. These are key indicators that can help predict stock price movements.</li><li id="cb5f" class="mv mw gr mx b hp qq mz na hs qr nc nd ne qs ng nh ni qt nk nl nm qu no np nq rl qo qp bh"><strong class="mx gs">Combining Data:</strong> The extracted data is combined into a single array for each ticker. This combination allows us to handle the data more efficiently and ensures that all relevant features are included in the sequence generation process.</li><li id="ad46" class="mv mw gr mx b hp qq mz na hs qr nc nd ne qs ng nh ni qt nk nl nm qu no np nq rl qo qp bh"><strong class="mx gs">Sequence and Label Creation:</strong></li></ol><ul class=""><li id="46dc" class="mv mw gr mx b hp my mz na hs nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq qn qo qp bh">Using the previously defined <code class="cu qk ql qm pd b">create_sequences</code> function, we generate sequences of the combined data. This function also prepares the corresponding labels, using the future close price as the target for prediction.</li><li id="f392" class="mv mw gr mx b hp qq mz na hs qr nc nd ne qs ng nh ni qt nk nl nm qu no np nq qn qo qp bh">The sequences include scaling factors (mean and standard deviation), ensuring that we can revert the model’s predictions to the original scale for accurate evaluation and interpretation.</li></ul><pre class="ox oy oz pa pb pc pd pe bm pf ay bh"><span id="ecee" class="pg oc gr pd b bd ph pi l pj pk">sequences_dict = {}<br/>sequence_labels = {}<br/>for ticker in tickers:<br/><br/>    # Extract close and volume data for the ticker<br/>    close = df[ticker+&#x27;_close&#x27;].values<br/>    width = df[ticker+&#x27;_width&#x27;].values<br/>    rsi = df[ticker+&#x27;_rsi&#x27;].values<br/>    roc = df[ticker+&#x27;_roc&#x27;].values<br/>    volume = df[ticker+&#x27;_volume&#x27;].values<br/>    diff = df[ticker+&#x27;_diff&#x27;].values<br/>    pct_change = df[ticker+&#x27;_percent_change_close&#x27;].values<br/>    <br/>    # Combine close and volume data<br/>    ticker_data = np.column_stack((close,<br/>                                   width,<br/>                                   rsi,<br/>                                   roc,<br/>                                   volume,<br/>                                   diff,<br/>                                   pct_change))<br/>    <br/>    # Generate sequences<br/>    attribute = ticker+&quot;_close&quot;<br/>    ticker_sequences, lab = create_sequences(ticker_data,<br/>                                             labels[attribute].values[SEQUENCE_LEN-1:],<br/>                                             stats[attribute+&quot;_mean&quot;].values,<br/>                                             stats[attribute+&quot;_std&quot;].values)<br/>    <br/>    sequences_dict[ticker] = ticker_sequences<br/>    sequence_labels[ticker] = lab</span></pre><h1 id="2c60" class="ob oc gr bc od oe pl hr og oh pm hu oj ok pn om on oo po oq or os pp ou ov ow bh">Aggregating Data Across Tickers for Unified Model Training</h1><p id="7276" class="pw-post-body-paragraph mv mw gr mx b hp pq mz na hs pr nc nd ne ps ng nh ni pt nk nl nm pu no np nq gk bh">To ensure our model benefits from a diverse and comprehensive dataset, we aggregate the sequences and labels from each ticker into a unified dataset. This approach enables the model to learn generalized patterns that apply across different stocks within the big tech sector.</p><h2 id="6e02" class="pv oc gr bc od pw px dv og py pz dx oj ne qa qb qc ni qd qe qf nm qg qh qi qj bh">Aggregating Sequences and Labels</h2><p id="beb0" class="pw-post-body-paragraph mv mw gr mx b hp pq mz na hs pr nc nd ne ps ng nh ni pt nk nl nm pu no np nq gk bh">Here’s a step-by-step breakdown of how we combine the sequences and labels from all tickers into a consolidated training dataset:</p><ol class=""><li id="c8df" class="mv mw gr mx b hp my mz na hs nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq rl qo qp bh"><strong class="mx gs">Data Aggregation:</strong> By iterating over each ticker, we extend these lists with sequences and labels generated for each stock, effectively pooling all the data into a single dataset.</li><li id="5a3d" class="mv mw gr mx b hp qq mz na hs qr nc nd ne qs ng nh ni qt nk nl nm qu no np nq rl qo qp bh"><strong class="mx gs">Conversion to Numpy Arrays:</strong> After aggregating the data, we convert the lists of sequences and labels into Numpy arrays. This conversion is crucial for compatibility with TensorFlow and Keras, which prefer Numpy array inputs for model training and evaluation. It also facilitates efficient handling and computation during the training process.</li></ol><pre class="ox oy oz pa pb pc pd pe bm pf ay bh"><span id="dcd5" class="pg oc gr pd b bd ph pi l pj pk"># Combine data and labels from all tickers<br/>all_sequences = []<br/>all_labels = []<br/><br/>for ticker in tickers:<br/>    all_sequences.extend(sequences_dict[ticker])<br/>    all_labels.extend(sequence_labels[ticker])<br/><br/># Convert to numpy arrays<br/>all_sequences = np.array(all_sequences)<br/>all_labels = np.array(all_labels)</span></pre><h1 id="7918" class="ob oc gr bc od oe pl hr og oh pm hu oj ok pn om on oo po oq or os pp ou ov ow bh">Preparing Dataset Splits for Model Training and Evaluation</h1><p id="ffba" class="pw-post-body-paragraph mv mw gr mx b hp pq mz na hs pr nc nd ne ps ng nh ni pt nk nl nm pu no np nq gk bh">A crucial step in preparing our dataset for the machine learning workflow is to shuffle and split the data into training, validation, and test sets. This process ensures that the model is trained on a diverse subset of data, validated on unseen data to avoid overfitting, and finally tested on completely separate data to evaluate its performance.</p><h2 id="63b6" class="pv oc gr bc od pw px dv og py pz dx oj ne qa qb qc ni qd qe qf nm qg qh qi qj bh">Shuffling and Splitting the Dataset</h2><ol class=""><li id="12ac" class="mv mw gr mx b hp pq mz na hs pr nc nd ne ps ng nh ni pt nk nl nm pu no np nq rl qo qp bh"><strong class="mx gs">Setting a Random Seed:</strong> We set a random seed to ensure reproducibility. This means the random processes will behave the same way each time the code is run, which is important for debugging and comparing model performance across different runs.</li><li id="b096" class="mv mw gr mx b hp qq mz na hs qr nc nd ne qs ng nh ni qt nk nl nm qu no np nq rl qo qp bh"><strong class="mx gs">Shuffling the Data:</strong> We shuffle the sequences and their corresponding labels to randomize the order. This randomization helps prevent any biases that might occur due to the order in which data was originally processed or collected.</li><li id="d1d0" class="mv mw gr mx b hp qq mz na hs qr nc nd ne qs ng nh ni qt nk nl nm qu no np nq rl qo qp bh"><strong class="mx gs">Splitting the Data: </strong>We first determine the size of the training set as 90% of the total data. The remaining 10% will be split further into validation and test sets.</li><li id="a371" class="mv mw gr mx b hp qq mz na hs qr nc nd ne qs ng nh ni qt nk nl nm qu no np nq rl qo qp bh"><strong class="mx gs">Creating Validation and Test Sets:</strong> The validation set is set to 50% of the remaining data. The rest is reserved as the test set. This split provides a good balance, allowing sufficient data for both validation and final evaluation.</li></ol><pre class="ox oy oz pa pb pc pd pe bm pf ay bh"><span id="072e" class="pg oc gr pd b bd ph pi l pj pk">np.random.seed(42)<br/>shuffled_indices = np.random.permutation(len(all_sequences))<br/>all_sequences = all_sequences[shuffled_indices]<br/>all_labels = all_labels[shuffled_indices]<br/><br/>train_size = int(len(all_sequences) * 0.9)<br/><br/># Split sequences<br/>train_sequences = all_sequences[:train_size]<br/>train_labels    = all_labels[:train_size]<br/><br/>other_sequences = all_sequences[train_size:]<br/>other_labels    = all_labels[train_size:]<br/><br/>shuffled_indices = np.random.permutation(len(other_sequences))<br/>other_sequences = other_sequences[shuffled_indices]<br/>other_labels = other_labels[shuffled_indices]<br/><br/>val_size = int(len(other_sequences) * 0.5)<br/><br/>validation_sequences = other_sequences[:val_size]<br/>validation_labels = other_labels[:val_size]<br/><br/>test_sequences = other_sequences[val_size:]<br/>test_labels = other_labels[val_size:]</span></pre><p id="8941" class="pw-post-body-paragraph mv mw gr mx b hp my mz na hs nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq gk bh">Now that we have prepared our data, lets build our transformer model</p></div></div></div><div class="ab by nt nu nv nw" role="separator"><span class="nx bv bj ny nz oa"></span><span class="nx bv bj ny nz oa"></span><span class="nx bv bj ny nz"></span></div><div class="gk gl gm gn go"><div class="ab by"><div class="cf be fw fx fy fz"><h1 id="b966" class="ob oc gr bc od oe of hr og oh oi hu oj ok ol om on oo op oq or os ot ou ov ow bh">Building a Transformer Model for Time-Series Forecasting</h1><p id="ef04" class="pw-post-body-paragraph mv mw gr mx b hp pq mz na hs pr nc nd ne ps ng nh ni pt nk nl nm pu no np nq gk bh">In this section, we delve into the architecture of the Transformer model, specifically tailored for time-series forecasting. The Transformer, known for its effectiveness in handling sequence data thanks to its attention mechanisms, is particularly well-suited for complex tasks like stock price prediction.</p><h2 id="718d" class="pv oc gr bc od pw px dv og py pz dx oj ne qa qb qc ni qd qe qf nm qg qh qi qj bh">Transformer Model Architecture</h2><blockquote class="rn ro rp"><p id="8bdf" class="mv mw nr mx b hp my mz na hs nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq gk bh"><strong class="mx gs">Transformer Encoder Function:</strong></p></blockquote><ul class=""><li id="9ab9" class="mv mw gr mx b hp my mz na hs nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq qn qo qp bh">The encoder function forms the core of our Transformer model. It comprises several key operations that process the input sequences.</li><li id="2210" class="mv mw gr mx b hp qq mz na hs qr nc nd ne qs ng nh ni qt nk nl nm qu no np nq qn qo qp bh">Layer Normalization: Normalizes the input layer to speed up the training and stabilize the network.</li><li id="6b28" class="mv mw gr mx b hp qq mz na hs qr nc nd ne qs ng nh ni qt nk nl nm qu no np nq qn qo qp bh">Multi-Head Attention: Allows the model to jointly attend to information from different representation subspaces at different positions, capturing various aspects of the input data.</li><li id="16d4" class="mv mw gr mx b hp qq mz na hs qr nc nd ne qs ng nh ni qt nk nl nm qu no np nq qn qo qp bh">Feed Forward Network: A simple neural network applied to each position separately and identically, enhancing the model’s ability to process complex patterns.</li></ul><pre class="ox oy oz pa pb pc pd pe bm pf ay bh"><span id="fd2e" class="pg oc gr pd b bd ph pi l pj pk">def transformer_encoder(inputs, head_size, num_heads, ff_dim, dropout=0):<br/>    # Attention and Normalization<br/>    x = LayerNormalization(epsilon=1e-6)(inputs)<br/>    x = MultiHeadAttention(key_dim=head_size, num_heads=num_heads, dropout=dropout)(x, x)<br/>    x = Add()([x, inputs])<br/><br/>    # Feed Forward Part<br/>    y = LayerNormalization(epsilon=1e-6)(x)<br/>    y = Dense(ff_dim, activation=&quot;relu&quot;)(y)<br/>    y = Dropout(dropout)(y)<br/>    y = Dense(inputs.shape[-1])(y)<br/>    return Add()([y, x])</span></pre><blockquote class="rn ro rp"><p id="2b11" class="mv mw nr mx b hp my mz na hs nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq gk bh"><strong class="mx gs">Building the Complete Model:</strong></p></blockquote><ul class=""><li id="9fde" class="mv mw gr mx b hp my mz na hs nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq qn qo qp bh">The model is built by stacking multiple layers of the transformer encoder to deepen the network, which enhances its ability to learn from data.</li><li id="1971" class="mv mw gr mx b hp qq mz na hs qr nc nd ne qs ng nh ni qt nk nl nm qu no np nq qn qo qp bh">A Global Average Pooling layer follows the Transformer blocks to reduce the dimensionality of the output, making the model more manageable and focusing on the most important features.</li><li id="eff3" class="mv mw gr mx b hp qq mz na hs qr nc nd ne qs ng nh ni qt nk nl nm qu no np nq qn qo qp bh">The final output layer is a dense layer with a linear activation function, designed to predict continuous values, such as stock prices.</li></ul><pre class="ox oy oz pa pb pc pd pe bm pf ay bh"><span id="7820" class="pg oc gr pd b bd ph pi l pj pk">def build_transformer_model(input_shape, head_size, num_heads, ff_dim, num_layers, dropout=0):<br/>    inputs = Input(shape=input_shape)<br/>    x = inputs<br/>    for _ in range(num_layers):<br/>        x = transformer_encoder(x, head_size, num_heads, ff_dim, dropout)<br/>    x = GlobalAveragePooling1D()(x)<br/>    x = LayerNormalization(epsilon=1e-6)(x)<br/>    outputs = Dense(1, activation=&quot;linear&quot;)(x)<br/>    return Model(inputs=inputs, outputs=outputs)</span></pre><blockquote class="rn ro rp"><p id="2214" class="mv mw nr mx b hp my mz na hs nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq gk bh"><strong class="mx gs">Model Parameters and Compilation:</strong></p></blockquote><ul class=""><li id="7be7" class="mv mw gr mx b hp my mz na hs nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq qn qo qp bh">We specify the model parameters such as the input shape, head size, number of heads, dimensionality of the feed-forward network, number of layers, and dropout rate.</li><li id="ad50" class="mv mw gr mx b hp qq mz na hs qr nc nd ne qs ng nh ni qt nk nl nm qu no np nq qn qo qp bh">These parameters are crucial as they define how deep and complex the model is, influencing its ability to learn and generalize.</li></ul><pre class="ox oy oz pa pb pc pd pe bm pf ay bh"><span id="8072" class="pg oc gr pd b bd ph pi l pj pk">input_shape = train_sequences.shape[1:]<br/>head_size = 256<br/>num_heads = 16<br/>ff_dim = 1024<br/>num_layers = 12<br/>dropout = 0.20<br/><br/>model = build_transformer_model(input_shape, head_size, num_heads, ff_dim, num_layers, dropout)<br/>model.summary()</span></pre><figure class="ox oy oz pa pb qv rb rc paragraph-image"><div class="rb rc rq"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*IcRJj9NmCANxpU8Z6Fe5gQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*IcRJj9NmCANxpU8Z6Fe5gQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*IcRJj9NmCANxpU8Z6Fe5gQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*IcRJj9NmCANxpU8Z6Fe5gQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*IcRJj9NmCANxpU8Z6Fe5gQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*IcRJj9NmCANxpU8Z6Fe5gQ.png 1100w, https://miro.medium.com/v2/resize:fit:918/format:webp/1*IcRJj9NmCANxpU8Z6Fe5gQ.png 918w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 459px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*IcRJj9NmCANxpU8Z6Fe5gQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*IcRJj9NmCANxpU8Z6Fe5gQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*IcRJj9NmCANxpU8Z6Fe5gQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*IcRJj9NmCANxpU8Z6Fe5gQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*IcRJj9NmCANxpU8Z6Fe5gQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*IcRJj9NmCANxpU8Z6Fe5gQ.png 1100w, https://miro.medium.com/v2/resize:fit:918/1*IcRJj9NmCANxpU8Z6Fe5gQ.png 918w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 459px"/><img alt="" class="be mc rk c" width="459" height="83" loading="lazy" role="presentation"/></picture></div></figure><h1 id="481f" class="ob oc gr bc od oe pl hr og oh pm hu oj ok pn om on oo po oq or os pp ou ov ow bh">Implementing Custom Loss Function and Accuracy Metric</h1><p id="1084" class="pw-post-body-paragraph mv mw gr mx b hp pq mz na hs pr nc nd ne ps ng nh ni pt nk nl nm pu no np nq gk bh">To optimize our Transformer model for stock price prediction, we define a custom mean absolute error (MAE) loss function and a directional accuracy metric. These functions are tailored to accurately assess the performance of our model in predicting the direction of stock price movements, which is often more valuable than predicting exact prices in financial markets.</p><h2 id="805c" class="pv oc gr bc od pw px dv og py pz dx oj ne qa qb qc ni qd qe qf nm qg qh qi qj bh">Custom MAE Loss Function &amp; Directional Accuracy</h2><ol class=""><li id="bd07" class="mv mw gr mx b hp pq mz na hs pr nc nd ne ps ng nh ni pt nk nl nm pu no np nq rl qo qp bh"><strong class="mx gs">Custom MAE Loss Function:</strong> The custom MAE loss function calculates the mean absolute error between the predicted next value and the actual next value. This loss function helps in minimizing the prediction error in terms of actual price values.</li><li id="b378" class="mv mw gr mx b hp qq mz na hs qr nc nd ne qs ng nh ni qt nk nl nm qu no np nq rl qo qp bh"><strong class="mx gs">Directional Accuracy Metric:</strong></li></ol><ul class=""><li id="f15d" class="mv mw gr mx b hp my mz na hs nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq qn qo qp bh">This metric calculates the accuracy with which the model predicts the direction of price movement, rather than the exact values. It compares the sign of the true change in price (up or down) to the sign of the predicted change.</li><li id="b33a" class="mv mw gr mx b hp qq mz na hs qr nc nd ne qs ng nh ni qt nk nl nm qu no np nq qn qo qp bh">The metric is essential for trading strategies where the correct prediction of price movement direction can yield significant returns.</li><li id="fb59" class="mv mw gr mx b hp qq mz na hs qr nc nd ne qs ng nh ni qt nk nl nm qu no np nq qn qo qp bh"><strong class="mx gs"><em class="nr">Note: Directional Accuracy is the reason why we must have Mean and Standard Deviation with our label.</em></strong></li></ul><pre class="ox oy oz pa pb pc pd pe bm pf ay bh"><span id="b2f8" class="pg oc gr pd b bd ph pi l pj pk">def custom_mae_loss(y_true, y_pred):<br/>    y_true_next = tf.cast(y_true[:, 1], tf.float64)  # Extract the true next values, scaled<br/>    y_pred_next = tf.cast(y_pred[:, 0], tf.float64)  # Extract the predicted next values, scaled<br/>    abs_error = tf.abs(y_true_next - y_pred_next)  # Calculate the absolute error<br/>    return tf.reduce_mean(abs_error)  # Return the mean of these errors<br/><br/>def dir_acc(y_true, y_pred):<br/>    mean, std = tf.cast(y_true[:, 2], tf.float64), tf.cast(y_true[:, 3], tf.float64)  # Retrieve scaling factors<br/>    y_true_prev = (tf.cast(y_true[:, 0], tf.float64) * std) + mean  # Un-scale previous true price<br/>    y_true_next = (tf.cast(y_true[:, 1], tf.float64) * std) + mean  # Un-scale next true price<br/>    y_pred_next = (tf.cast(y_pred[:, 0], tf.float64) * std) + mean  # Un-scale predicted next price<br/><br/>    true_change = y_true_next - y_true_prev  # Calculate true change<br/>    pred_change = y_pred_next - y_true_prev  # Calculate predicted change<br/><br/>    correct_direction = tf.equal(tf.sign(true_change), tf.sign(pred_change))  # Check if the signs match<br/>    return tf.reduce_mean(tf.cast(correct_direction, tf.float64))  # Return the mean of correct directions</span></pre><h1 id="2803" class="ob oc gr bc od oe pl hr og oh pm hu oj ok pn om on oo po oq or os pp ou ov ow bh">Optimizing Training with Callbacks and Learning Rate Scheduling</h1><p id="cf5f" class="pw-post-body-paragraph mv mw gr mx b hp pq mz na hs pr nc nd ne ps ng nh ni pt nk nl nm pu no np nq gk bh">To maximize the performance of our Transformer model and ensure robust training, we implement several TensorFlow callbacks. These include mechanisms to save the best performing models and to adjust the learning rate dynamically during training. Such techniques help improve the model’s convergence and generalization capabilities.</p><h2 id="28b7" class="pv oc gr bc od pw px dv og py pz dx oj ne qa qb qc ni qd qe qf nm qg qh qi qj bh">Model Checkpoint Callbacks</h2><ol class=""><li id="ac7c" class="mv mw gr mx b hp pq mz na hs pr nc nd ne ps ng nh ni pt nk nl nm pu no np nq rl qo qp bh"><strong class="mx gs">Saving the Best Training Model:</strong> We use <code class="cu qk ql qm pd b">ModelCheckpoint</code> to automatically save the model weights that achieve the highest &#x27;directional accuracy&#x27; during training. This ensures that we retain the best model iteration, potentially preventing overfitting on the training data.</li><li id="802e" class="mv mw gr mx b hp qq mz na hs qr nc nd ne qs ng nh ni qt nk nl nm qu no np nq rl qo qp bh"><strong class="mx gs">Saving the Best Validation Model:</strong> Similarly, we set another checkpoint for the validation phase. This saves the model iteration that performs best on the validation dataset, according to the ‘directional accuracy’ metric. It’s crucial for tuning the model to perform well on unseen data.</li><li id="718a" class="mv mw gr mx b hp qq mz na hs qr nc nd ne qs ng nh ni qt nk nl nm qu no np nq rl qo qp bh"><strong class="mx gs">Dynamic Learning Rate Adjustment:</strong></li></ol><ul class=""><li id="b4e2" class="mv mw gr mx b hp my mz na hs nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq qn qo qp bh">Adjusting the learning rate during training can significantly impact the model’s training dynamics and final performance. We implement a custom learning rate scheduler that:</li><li id="8edb" class="mv mw gr mx b hp qq mz na hs qr nc nd ne qs ng nh ni qt nk nl nm qu no np nq qn qo qp bh">Warms up the learning rate linearly during the initial phase.</li><li id="adb8" class="mv mw gr mx b hp qq mz na hs qr nc nd ne qs ng nh ni qt nk nl nm qu no np nq qn qo qp bh">Holds the maximum learning rate for a sustain phase, if defined.</li><li id="001c" class="mv mw gr mx b hp qq mz na hs qr nc nd ne qs ng nh ni qt nk nl nm qu no np nq qn qo qp bh">Applies a cosine decay for the learning rate to smoothly reduce it to a minimum, helping the model to fine-tune its weights in later epochs.</li></ul><pre class="ox oy oz pa pb pc pd pe bm pf ay bh"><span id="9b80" class="pg oc gr pd b bd ph pi l pj pk"># Define a callback to save the best model<br/>checkpoint_callback_train = ModelCheckpoint(<br/>    &quot;transformer_train_model.keras&quot;,  # Filepath to save the best model<br/>    monitor=&quot;dir_acc&quot;,  #&quot;loss&quot;,  # Metric to monitor<br/>    save_best_only=True,  # Save only the best model<br/>    mode=&quot;max&quot;,  # Minimize the monitored metric <br/>    verbose=1,  # Display progress<br/>)<br/><br/># Define a callback to save the best model<br/>checkpoint_callback_val = ModelCheckpoint(<br/>    &quot;transformer_val_model.keras&quot;,  # Filepath to save the best model<br/>    monitor=&quot;val_dir_acc&quot;, #&quot;val_loss&quot;,  # Metric to monitor<br/>    save_best_only=True,  # Save only the best model<br/>    mode=&quot;max&quot;,  # Minimize the monitored metric <br/>    verbose=1,  # Display progress<br/>)<br/><br/>def get_lr_callback(batch_size=16, mode=&#x27;cos&#x27;, epochs=500, plot=False):<br/>    lr_start, lr_max, lr_min = 0.0001, 0.005, 0.00001  # Adjust learning rate boundaries<br/>    lr_ramp_ep = int(0.30 * epochs)  # 30% of epochs for warm-up<br/>    lr_sus_ep = max(0, int(0.10 * epochs) - lr_ramp_ep)  # Optional sustain phase, adjust as needed<br/><br/>    def lrfn(epoch):<br/>        if epoch &lt; lr_ramp_ep:  # Warm-up phase<br/>            lr = (lr_max - lr_start) / lr_ramp_ep * epoch + lr_start<br/>        elif epoch &lt; lr_ramp_ep + lr_sus_ep:  # Sustain phase at max learning rate<br/>            lr = lr_max<br/>        elif mode == &#x27;cos&#x27;:<br/>            decay_total_epochs, decay_epoch_index = epochs - lr_ramp_ep - lr_sus_ep, epoch - lr_ramp_ep - lr_sus_ep<br/>            phase = math.pi * decay_epoch_index / decay_total_epochs<br/>            lr = (lr_max - lr_min) * 0.5 * (1 + math.cos(phase)) + lr_min<br/>        else:<br/>            lr = lr_min  # Default to minimum learning rate if mode is not recognized<br/><br/>        return lr<br/><br/>    if plot:  # Plot learning rate curve if plot is True<br/>        plt.figure(figsize=(10, 5))<br/>        plt.plot(np.arange(epochs), [lrfn(epoch) for epoch in np.arange(epochs)], marker=&#x27;o&#x27;)<br/>        plt.xlabel(&#x27;Epoch&#x27;)<br/>        plt.ylabel(&#x27;Learning Rate&#x27;)<br/>        plt.title(&#x27;Learning Rate Scheduler&#x27;)<br/>        plt.show()<br/><br/>    return tf.keras.callbacks.LearningRateScheduler(lrfn, verbose=True)</span></pre><figure class="ox oy oz pa pb qv rb rc paragraph-image"><div role="button" tabindex="0" class="rg rh fg ri be rj"><div class="rb rc rr"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*ZsbF0HgSM9IBd-0XexYrLA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*ZsbF0HgSM9IBd-0XexYrLA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*ZsbF0HgSM9IBd-0XexYrLA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*ZsbF0HgSM9IBd-0XexYrLA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*ZsbF0HgSM9IBd-0XexYrLA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*ZsbF0HgSM9IBd-0XexYrLA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZsbF0HgSM9IBd-0XexYrLA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*ZsbF0HgSM9IBd-0XexYrLA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*ZsbF0HgSM9IBd-0XexYrLA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*ZsbF0HgSM9IBd-0XexYrLA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*ZsbF0HgSM9IBd-0XexYrLA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*ZsbF0HgSM9IBd-0XexYrLA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*ZsbF0HgSM9IBd-0XexYrLA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*ZsbF0HgSM9IBd-0XexYrLA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="be mc rk c" width="700" height="381" loading="lazy" role="presentation"/></picture></div></div></figure><h1 id="3413" class="ob oc gr bc od oe pl hr og oh pm hu oj ok pn om on oo po oq or os pp ou ov ow bh">Training the Transformer Model</h1><p id="526f" class="pw-post-body-paragraph mv mw gr mx b hp pq mz na hs pr nc nd ne ps ng nh ni pt nk nl nm pu no np nq gk bh">Now that we have set up our model and defined the necessary callbacks and learning rate adjustments, we can proceed to train the model. Training involves feeding the model with sequences of stock data and optimizing the model parameters to minimize prediction errors on the training data while validating its performance on unseen validation data.</p><h2 id="b32a" class="pv oc gr bc od pw px dv og py pz dx oj ne qa qb qc ni qd qe qf nm qg qh qi qj bh">Model Training Process</h2><ol class=""><li id="dc21" class="mv mw gr mx b hp pq mz na hs pr nc nd ne ps ng nh ni pt nk nl nm pu no np nq rl qo qp bh"><strong class="mx gs">Setting Training Parameters:</strong> We define the <code class="cu qk ql qm pd b">BATCH_SIZE</code> and <code class="cu qk ql qm pd b">EPOCHS</code>, which are crucial for determining how the data is fed into the model and how many times the entire dataset is passed through the model, respectively.</li><li id="e673" class="mv mw gr mx b hp qq mz na hs qr nc nd ne qs ng nh ni qt nk nl nm qu no np nq rl qo qp bh"><strong class="mx gs">Model Fitting:</strong></li></ol><ul class=""><li id="4fd4" class="mv mw gr mx b hp my mz na hs nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq qn qo qp bh">The <code class="cu qk ql qm pd b">fit</code> method on our model object is used to start the training process. We specify the training data, the corresponding labels, the validation data, and the number of epochs.</li><li id="109f" class="mv mw gr mx b hp qq mz na hs qr nc nd ne qs ng nh ni qt nk nl nm qu no np nq qn qo qp bh">Callbacks including model checkpoints and learning rate adjustments are passed to monitor and enhance the training process as needed.</li></ul><pre class="ox oy oz pa pb pc pd pe bm pf ay bh"><span id="ddec" class="pg oc gr pd b bd ph pi l pj pk">BATCH_SIZE = 64  # Number of training examples used to calculate each iteration&#x27;s gradient<br/>EPOCHS = 100  # Total number of times the entire dataset is passed through the network<br/><br/>model.fit(<br/>    train_sequences,  # Training features<br/>    train_labels,  # Training labels<br/>    validation_data=(validation_sequences, validation_labels),  # Validation data<br/>    epochs=EPOCHS,  # Number of epochs to train for<br/>    batch_size=BATCH_SIZE,  # Size of each batch<br/>    shuffle=True,  # Shuffle training data before each epoch<br/>    callbacks=[checkpoint_callback_train, checkpoint_callback_val, get_lr_callback(batch_size=BATCH_SIZE, epochs=EPOCHS)]  # Callbacks for saving models and adjusting learning rate<br/>)</span></pre></div></div><div class="qv"><div class="ab by"><div class="lx qw ly qx lz qy cc qz cd ra cf be"><figure class="ox oy oz pa pb qv re rf paragraph-image"><div role="button" tabindex="0" class="rg rh fg ri be rj"><div class="rb rc rs"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*KJb9_JqK62Db-_D9A1urrg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*KJb9_JqK62Db-_D9A1urrg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*KJb9_JqK62Db-_D9A1urrg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*KJb9_JqK62Db-_D9A1urrg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*KJb9_JqK62Db-_D9A1urrg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*KJb9_JqK62Db-_D9A1urrg.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*KJb9_JqK62Db-_D9A1urrg.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*KJb9_JqK62Db-_D9A1urrg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*KJb9_JqK62Db-_D9A1urrg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*KJb9_JqK62Db-_D9A1urrg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*KJb9_JqK62Db-_D9A1urrg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*KJb9_JqK62Db-_D9A1urrg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*KJb9_JqK62Db-_D9A1urrg.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*KJb9_JqK62Db-_D9A1urrg.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"/><img alt="" class="be mc rk c" width="1000" height="419" loading="eager" role="presentation"/></picture></div></div></figure></div></div></div></div><div class="ab by nt nu nv nw" role="separator"><span class="nx bv bj ny nz oa"></span><span class="nx bv bj ny nz oa"></span><span class="nx bv bj ny nz"></span></div><div class="gk gl gm gn go"><div class="qv"><div class="ab by"><div class="lx qw ly qx lz qy cc qz cd ra cf be"><figure class="ox oy oz pa pb qv re rf paragraph-image"><div role="button" tabindex="0" class="rg rh fg ri be rj"><div class="rb rc rt"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*8b8if47FR9gyz1bANftuFA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*8b8if47FR9gyz1bANftuFA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*8b8if47FR9gyz1bANftuFA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*8b8if47FR9gyz1bANftuFA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*8b8if47FR9gyz1bANftuFA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*8b8if47FR9gyz1bANftuFA.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*8b8if47FR9gyz1bANftuFA.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*8b8if47FR9gyz1bANftuFA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*8b8if47FR9gyz1bANftuFA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*8b8if47FR9gyz1bANftuFA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*8b8if47FR9gyz1bANftuFA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*8b8if47FR9gyz1bANftuFA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*8b8if47FR9gyz1bANftuFA.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*8b8if47FR9gyz1bANftuFA.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"/><img alt="" class="be mc rk c" width="1000" height="412" loading="eager" role="presentation"/></picture></div></div></figure></div></div></div><div class="ab by"><div class="cf be fw fx fy fz"><h1 id="5ee5" class="ob oc gr bc od oe pl hr og oh pm hu oj ok pn om on oo po oq or os pp ou ov ow bh">Evaluating the Transformer Model’s Performance</h1><p id="9ce6" class="pw-post-body-paragraph mv mw gr mx b hp pq mz na hs pr nc nd ne ps ng nh ni pt nk nl nm pu no np nq gk bh">After training the model and optimizing its parameters through various training epochs, the next step is to load the best-performing model and evaluate its performance on the test dataset. This step is crucial to verify the model’s effectiveness in making predictions in a real-world scenario.</p><h2 id="3832" class="pv oc gr bc od pw px dv og py pz dx oj ne qa qb qc ni qd qe qf nm qg qh qi qj bh">Model Evaluation and Metric Calculation</h2><p id="cca8" class="pw-post-body-paragraph mv mw gr mx b hp pq mz na hs pr nc nd ne ps ng nh ni pt nk nl nm pu no np nq gk bh"><strong class="mx gs">Loading the Best Model Weights:</strong> We begin by loading the weights of the model that performed best on the validation dataset. This ensures that the evaluation is done using the most effective version of the trained model.</p><ol class=""><li id="d274" class="mv mw gr mx b hp my mz na hs nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq rl qo qp bh"><strong class="mx gs">Model Evaluation on Test Data:</strong> We use the <code class="cu qk ql qm pd b">evaluate</code> method to assess the model’s performance on the test dataset. This method computes the loss and any other metrics we defined earlier, like directional accuracy, on this new dataset.</li><li id="0a69" class="mv mw gr mx b hp qq mz na hs qr nc nd ne qs ng nh ni qt nk nl nm qu no np nq rl qo qp bh"><strong class="mx gs">Calculating Additional Metrics:</strong> To gain more insights into the model’s predictive power, we calculate the R-squared statistic, which provides a measure of how well the observed outcomes are replicated by the model, based on the proportion of total variation of outcomes explained by the model.</li></ol><pre class="ox oy oz pa pb pc pd pe bm pf ay bh"><span id="e8f4" class="pg oc gr pd b bd ph pi l pj pk">model.load_weights(&quot;transformer_val_model.keras&quot;)  # Load the best model from the validation phase<br/>accuracy = model.evaluate(test_sequences, test_labels)[1]  # Evaluate the model on the test data<br/>print(accuracy)<br/><br/>from sklearn.metrics import r2_score<br/><br/>predictions = model.predict(test_sequences)  # Make predictions on the test dataset<br/>r2 = r2_score(test_labels[:, 1], predictions[:, 0])  # Calculate R-squared value<br/>print(f&quot;R-squared: {r2}&quot;)</span></pre><figure class="ox oy oz pa pb qv rb rc paragraph-image"><div role="button" tabindex="0" class="rg rh fg ri be rj"><div class="rb rc ru"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*dyqTQDByFO4JUd7ZS_ujhA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*dyqTQDByFO4JUd7ZS_ujhA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*dyqTQDByFO4JUd7ZS_ujhA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*dyqTQDByFO4JUd7ZS_ujhA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*dyqTQDByFO4JUd7ZS_ujhA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*dyqTQDByFO4JUd7ZS_ujhA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dyqTQDByFO4JUd7ZS_ujhA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*dyqTQDByFO4JUd7ZS_ujhA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*dyqTQDByFO4JUd7ZS_ujhA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*dyqTQDByFO4JUd7ZS_ujhA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*dyqTQDByFO4JUd7ZS_ujhA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*dyqTQDByFO4JUd7ZS_ujhA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*dyqTQDByFO4JUd7ZS_ujhA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*dyqTQDByFO4JUd7ZS_ujhA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="be mc rk c" width="700" height="75" loading="lazy" role="presentation"/></picture></div></div></figure></div></div></div><div class="ab by nt nu nv nw" role="separator"><span class="nx bv bj ny nz oa"></span><span class="nx bv bj ny nz oa"></span><span class="nx bv bj ny nz"></span></div><div class="gk gl gm gn go"><div class="ab by"><div class="cf be fw fx fy fz"><h1 id="2544" class="ob oc gr bc od oe of hr og oh oi hu oj ok ol om on oo op oq or os ot ou ov ow bh">Conclusion and Future Directions</h1><p id="3428" class="pw-post-body-paragraph mv mw gr mx b hp pq mz na hs pr nc nd ne ps ng nh ni pt nk nl nm pu no np nq gk bh">Our journey through developing and training a Transformer model for predicting stock price movements has shown promising results. Starting from a baseline accuracy of 50%, we have achieved significant improvements, reaching directional accuracies around 70% towards the end of 100 training epochs. This progression underscores the potential of our model to effectively capture and predict trends in stock prices.</p><h2 id="8cae" class="pv oc gr bc od pw px dv og py pz dx oj ne qa qb qc ni qd qe qf nm qg qh qi qj bh">Achievements</h2><ul class=""><li id="ce39" class="mv mw gr mx b hp pq mz na hs pr nc nd ne ps ng nh ni pt nk nl nm pu no np nq qn qo qp bh">Model Performance: The improvement in accuracy demonstrates the model’s capacity to learn complex patterns in the stock market data, affirming the effectiveness of the Transformer architecture for this type of time-series analysis.</li><li id="5a7f" class="mv mw gr mx b hp qq mz na hs qr nc nd ne qs ng nh ni qt nk nl nm qu no np nq qn qo qp bh">Progressive Learning: The continued enhancements observed up to the 100th epoch indicate that the model benefits from extended training periods, progressively refining its predictions.</li></ul><h2 id="538c" class="pv oc gr bc od pw px dv og py pz dx oj ne qa qb qc ni qd qe qf nm qg qh qi qj bh">Challenges and Limitations</h2><ul class=""><li id="dc30" class="mv mw gr mx b hp pq mz na hs pr nc nd ne ps ng nh ni pt nk nl nm pu no np nq qn qo qp bh">Hardware and Time Constraints: Despite the promising improvements, further training was curtailed by limitations in available computational resources and time. Such constraints are common in real-world scenarios and need to be planned for accordingly.</li><li id="fffc" class="mv mw gr mx b hp qq mz na hs qr nc nd ne qs ng nh ni qt nk nl nm qu no np nq qn qo qp bh">Convergence: The model had not fully converged within the allocated 100 epochs, suggesting that additional epochs could yield further gains in accuracy.</li></ul><h2 id="ad1c" class="pv oc gr bc od pw px dv og py pz dx oj ne qa qb qc ni qd qe qf nm qg qh qi qj bh">Recommendations for Future Work</h2><ol class=""><li id="04f3" class="mv mw gr mx b hp pq mz na hs pr nc nd ne ps ng nh ni pt nk nl nm pu no np nq rl qo qp bh">Extended Training: If resources permit, future experiments should consider extending the number of epochs. This could help the model to fully converge and potentially uncover more nuanced patterns in the data.</li><li id="a6b2" class="mv mw gr mx b hp qq mz na hs qr nc nd ne qs ng nh ni qt nk nl nm qu no np nq rl qo qp bh">Hardware Optimization: Leveraging more powerful computing resources or cloud-based platforms could mitigate hardware limitations, allowing for more extensive training and experimentation.</li><li id="f42a" class="mv mw gr mx b hp qq mz na hs qr nc nd ne qs ng nh ni qt nk nl nm qu no np nq rl qo qp bh">Hyperparameter Tuning: Experimenting with different model architectures, learning rates, and other hyperparameters could further enhance model performance.</li><li id="2c5c" class="mv mw gr mx b hp qq mz na hs qr nc nd ne qs ng nh ni qt nk nl nm qu no np nq rl qo qp bh">Feature Engineering: Incorporating additional features or experimenting with different combinations of existing indicators might provide new insights and improve predictive accuracy.</li></ol><h2 id="512a" class="pv oc gr bc od pw px dv og py pz dx oj ne qa qb qc ni qd qe qf nm qg qh qi qj bh">Final Thoughts</h2><p id="d8e5" class="pw-post-body-paragraph mv mw gr mx b hp pq mz na hs pr nc nd ne ps ng nh ni pt nk nl nm pu no np nq gk bh">The work done so far lays a solid foundation for future exploration and improvements. The Transformer model, with its advanced capabilities for handling sequential data, presents a robust framework for financial market analysis. While we have encountered practical limitations, the pathway for enhancing this model is clear and well-defined. Continued efforts in this direction are likely to yield a model that is not only accurate but also invaluable for real-time trading strategies.</p><p id="4b9d" class="pw-post-body-paragraph mv mw gr mx b hp my mz na hs nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq gk bh">You can check out my notebook for this project <a class="af ns" href="https://colab.research.google.com/drive/1j3AYSIxhiNJSCP692pKPbLk4_-kG4Pmh?usp=sharing" rel="noopener ugc nofollow" target="_blank">here</a>.</p><figure class="ox oy oz pa pb qv rb rc paragraph-image"><div role="button" tabindex="0" class="rg rh fg ri be rj"><div class="rb rc rv"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/0*DkD1UqtzggbRdfe8 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*DkD1UqtzggbRdfe8 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*DkD1UqtzggbRdfe8 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*DkD1UqtzggbRdfe8 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*DkD1UqtzggbRdfe8 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*DkD1UqtzggbRdfe8 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/0*DkD1UqtzggbRdfe8 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/0*DkD1UqtzggbRdfe8 640w, https://miro.medium.com/v2/resize:fit:720/0*DkD1UqtzggbRdfe8 720w, https://miro.medium.com/v2/resize:fit:750/0*DkD1UqtzggbRdfe8 750w, https://miro.medium.com/v2/resize:fit:786/0*DkD1UqtzggbRdfe8 786w, https://miro.medium.com/v2/resize:fit:828/0*DkD1UqtzggbRdfe8 828w, https://miro.medium.com/v2/resize:fit:1100/0*DkD1UqtzggbRdfe8 1100w, https://miro.medium.com/v2/resize:fit:1400/0*DkD1UqtzggbRdfe8 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="be mc rk c" width="700" height="700" loading="lazy" role="presentation"/></picture></div></div></figure></div></div></div></div></section></div></div></article></div><div class="ab by"><div class="cf be fw fx fy fz"><div class="rw rx ab jj"><div class="ry ab"><a class="rz av am ao" rel="noopener follow" href="/tag/transformers?source=post_page-----2d84341ff213---------------transformers-----------------"><div class="sa fg cu sb gb sc sd bc b bd z bh se">Transformers</div></a></div><div class="ry ab"><a class="rz av am ao" rel="noopener follow" href="/tag/machine-learning?source=post_page-----2d84341ff213---------------machine_learning-----------------"><div class="sa fg cu sb gb sc sd bc b bd z bh se">Machine Learning</div></a></div><div class="ry ab"><a class="rz av am ao" rel="noopener follow" href="/tag/artificial-intelligence?source=post_page-----2d84341ff213---------------artificial_intelligence-----------------"><div class="sa fg cu sb gb sc sd bc b bd z bh se">Artificial Intelligence</div></a></div><div class="ry ab"><a class="rz av am ao" rel="noopener follow" href="/tag/stock-market?source=post_page-----2d84341ff213---------------stock_market-----------------"><div class="sa fg cu sb gb sc sd bc b bd z bh se">Stock Market</div></a></div><div class="ry ab"><a class="rz av am ao" rel="noopener follow" href="/tag/python?source=post_page-----2d84341ff213---------------python-----------------"><div class="sa fg cu sb gb sc sd bc b bd z bh se">Python</div></a></div></div></div></div><div class="l"></div><footer class="sf sg sh si sj sk sl sm sn ab q so sp c"><div class="l ae"><div class="ab by"><div class="cf be fw fx fy fz"><div class="ab cm sq"><div class="ab q ks"><div class="sr l"><span class="l ss st su e d"><div class="ab q ks kt"><div class="pw-multi-vote-icon fg ku kv kw kx"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="footerClapButton" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fp%2F2d84341ff213&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%40Matthew_Frank%2Fstock-price-prediction-using-transformers-2d84341ff213&amp;user=Mattafrank&amp;userId=60c8a92cde0b&amp;source=-----2d84341ff213---------------------clap_footer-----------"><div><div class="bj" aria-hidden="false"><div class="ky ao kz la lb lc am ld le lf kx"><svg width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" clip-rule="evenodd" d="M11.37.83L12 3.28l.63-2.45h-1.26zM13.92 3.95l1.52-2.1-1.18-.4-.34 2.5zM8.59 1.84l1.52 2.11-.34-2.5-1.18.4zM18.52 18.92a4.23 4.23 0 0 1-2.62 1.33l.41-.37c2.39-2.4 2.86-4.95 1.4-7.63l-.91-1.6-.8-1.67c-.25-.56-.19-.98.21-1.29a.7.7 0 0 1 .55-.13c.28.05.54.23.72.5l2.37 4.16c.97 1.62 1.14 4.23-1.33 6.7zm-11-.44l-4.15-4.15a.83.83 0 0 1 1.17-1.17l2.16 2.16a.37.37 0 0 0 .51-.52l-2.15-2.16L3.6 11.2a.83.83 0 0 1 1.17-1.17l3.43 3.44a.36.36 0 0 0 .52 0 .36.36 0 0 0 0-.52L5.29 9.51l-.97-.97a.83.83 0 0 1 0-1.16.84.84 0 0 1 1.17 0l.97.97 3.44 3.43a.36.36 0 0 0 .51 0 .37.37 0 0 0 0-.52L6.98 7.83a.82.82 0 0 1-.18-.9.82.82 0 0 1 .76-.51c.22 0 .43.09.58.24l5.8 5.79a.37.37 0 0 0 .58-.42L13.4 9.67c-.26-.56-.2-.98.2-1.29a.7.7 0 0 1 .55-.13c.28.05.55.23.73.5l2.2 3.86c1.3 2.38.87 4.59-1.29 6.75a4.65 4.65 0 0 1-4.19 1.37 7.73 7.73 0 0 1-4.07-2.25zm3.23-12.5l2.12 2.11c-.41.5-.47 1.17-.13 1.9l.22.46-3.52-3.53a.81.81 0 0 1-.1-.36c0-.23.09-.43.24-.59a.85.85 0 0 1 1.17 0zm7.36 1.7a1.86 1.86 0 0 0-1.23-.84 1.44 1.44 0 0 0-1.12.27c-.3.24-.5.55-.58.89-.25-.25-.57-.4-.91-.47-.28-.04-.56 0-.82.1l-2.18-2.18a1.56 1.56 0 0 0-2.2 0c-.2.2-.33.44-.4.7a1.56 1.56 0 0 0-2.63.75 1.6 1.6 0 0 0-2.23-.04 1.56 1.56 0 0 0 0 2.2c-.24.1-.5.24-.72.45a1.56 1.56 0 0 0 0 2.2l.52.52a1.56 1.56 0 0 0-.75 2.61L7 19a8.46 8.46 0 0 0 4.48 2.45 5.18 5.18 0 0 0 3.36-.5 4.89 4.89 0 0 0 4.2-1.51c2.75-2.77 2.54-5.74 1.43-7.59L18.1 7.68z"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l lg lh li lj lk ll lm"><p class="bc b ds z dr"><span class="ln">--</span></p></div></div></span><span class="l h g f sv sw"><div class="ab q ks kt"><div class="pw-multi-vote-icon fg ku kv kw kx"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="footerClapButton" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fp%2F2d84341ff213&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%40Matthew_Frank%2Fstock-price-prediction-using-transformers-2d84341ff213&amp;user=Mattafrank&amp;userId=60c8a92cde0b&amp;source=-----2d84341ff213---------------------clap_footer-----------"><div><div class="bj" aria-hidden="false"><div class="ky ao kz la lb lc am ld le lf kx"><svg width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" clip-rule="evenodd" d="M11.37.83L12 3.28l.63-2.45h-1.26zM13.92 3.95l1.52-2.1-1.18-.4-.34 2.5zM8.59 1.84l1.52 2.11-.34-2.5-1.18.4zM18.52 18.92a4.23 4.23 0 0 1-2.62 1.33l.41-.37c2.39-2.4 2.86-4.95 1.4-7.63l-.91-1.6-.8-1.67c-.25-.56-.19-.98.21-1.29a.7.7 0 0 1 .55-.13c.28.05.54.23.72.5l2.37 4.16c.97 1.62 1.14 4.23-1.33 6.7zm-11-.44l-4.15-4.15a.83.83 0 0 1 1.17-1.17l2.16 2.16a.37.37 0 0 0 .51-.52l-2.15-2.16L3.6 11.2a.83.83 0 0 1 1.17-1.17l3.43 3.44a.36.36 0 0 0 .52 0 .36.36 0 0 0 0-.52L5.29 9.51l-.97-.97a.83.83 0 0 1 0-1.16.84.84 0 0 1 1.17 0l.97.97 3.44 3.43a.36.36 0 0 0 .51 0 .37.37 0 0 0 0-.52L6.98 7.83a.82.82 0 0 1-.18-.9.82.82 0 0 1 .76-.51c.22 0 .43.09.58.24l5.8 5.79a.37.37 0 0 0 .58-.42L13.4 9.67c-.26-.56-.2-.98.2-1.29a.7.7 0 0 1 .55-.13c.28.05.55.23.73.5l2.2 3.86c1.3 2.38.87 4.59-1.29 6.75a4.65 4.65 0 0 1-4.19 1.37 7.73 7.73 0 0 1-4.07-2.25zm3.23-12.5l2.12 2.11c-.41.5-.47 1.17-.13 1.9l.22.46-3.52-3.53a.81.81 0 0 1-.1-.36c0-.23.09-.43.24-.59a.85.85 0 0 1 1.17 0zm7.36 1.7a1.86 1.86 0 0 0-1.23-.84 1.44 1.44 0 0 0-1.12.27c-.3.24-.5.55-.58.89-.25-.25-.57-.4-.91-.47-.28-.04-.56 0-.82.1l-2.18-2.18a1.56 1.56 0 0 0-2.2 0c-.2.2-.33.44-.4.7a1.56 1.56 0 0 0-2.63.75 1.6 1.6 0 0 0-2.23-.04 1.56 1.56 0 0 0 0 2.2c-.24.1-.5.24-.72.45a1.56 1.56 0 0 0 0 2.2l.52.52a1.56 1.56 0 0 0-.75 2.61L7 19a8.46 8.46 0 0 0 4.48 2.45 5.18 5.18 0 0 0 3.36-.5 4.89 4.89 0 0 0 4.2-1.51c2.75-2.77 2.54-5.74 1.43-7.59L18.1 7.68z"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l lg lh li lj lk ll lm"><p class="bc b ds z dr"><span class="ln">--</span></p></div></div></span></div><div class="bn ab"><div><div class="bj" aria-hidden="false"><button class="ao ky lq lr ab q fh ls lt" aria-label="responses"><svg width="24" height="24" viewBox="0 0 24 24" class="lp"><path d="M18 16.8a7.14 7.14 0 0 0 2.24-5.32c0-4.12-3.53-7.48-8.05-7.48C7.67 4 4 7.36 4 11.48c0 4.13 3.67 7.48 8.2 7.48a8.9 8.9 0 0 0 2.38-.32c.23.2.48.39.75.56 1.06.69 2.2 1.04 3.4 1.04.22 0 .4-.11.48-.29a.5.5 0 0 0-.04-.52 6.4 6.4 0 0 1-1.16-2.65v.02zm-3.12 1.06l-.06-.22-.32.1a8 8 0 0 1-2.3.33c-4.03 0-7.3-2.96-7.3-6.59S8.17 4.9 12.2 4.9c4 0 7.1 2.96 7.1 6.6 0 1.8-.6 3.47-2.02 4.72l-.2.16v.26l.02.3a6.74 6.74 0 0 0 .88 2.4 5.27 5.27 0 0 1-2.17-.86c-.28-.17-.72-.38-.94-.59l.01-.02z"></path></svg><p class="bc b bd z dr"><span class="pw-responses-count lo lp">4</span></p></button></div></div></div></div><div class="ab q"><div class="oa l jg"><div><div class="bj" aria-hidden="false"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="footerBookmarkButton" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F2d84341ff213&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%40Matthew_Frank%2Fstock-price-prediction-using-transformers-2d84341ff213&amp;source=--------------------------bookmark_footer-----------"><svg width="25" height="25" viewBox="0 0 25 25" fill="none" class="dr lv" aria-label="Add to list bookmark button"><path d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18V2.5zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .8.4l5.7-4.4 5.7 4.4a.5.5 0 0 0 .8-.4v-8.5a.5.5 0 0 0-1 0v7.48l-5.2-4a.5.5 0 0 0-.6 0l-5.2 4V7z" fill="currentColor"></path></svg></a></span></div></div></div><div class="oa l jg"><div class="bj" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bj" aria-hidden="false"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="footerSocialShareButton" class="af fh ah ai aj ak al md an ao ap eu me mf lt mg"><svg width="24" height="24" viewBox="0 0 24 24" fill="none"><path fill-rule="evenodd" clip-rule="evenodd" d="M15.22 4.93a.42.42 0 0 1-.12.13h.01a.45.45 0 0 1-.29.08.52.52 0 0 1-.3-.13L12.5 3v7.07a.5.5 0 0 1-.5.5.5.5 0 0 1-.5-.5V3.02l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.8a.42.42 0 0 1 .07.5zm-.1.14zm.88 2h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11a2 2 0 0 1-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.14c.1.1.15.22.15.35a.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9V8.96c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1z" fill="currentColor"></path></svg></button></div></div></div></div></div></div></div></div></div></footer><div class="sx sy sz ta tb l bu"><div class="ab by"><div class="cf be fw fx fy fz"><div class="ci ab tc cm"><div class="ab io"><a rel="noopener follow" href="/@Matthew_Frank?source=post_page-----2d84341ff213--------------------------------"><div class="l td te bv tf is"><div class="l fg"><img alt="Mattafrank" class="l fa bv tg th cu" src="https://miro.medium.com/v2/resize:fill:144:144/1*qcpoaEXNU6D1tZbZVTZisw.png" width="72" height="72" loading="lazy"/><div class="it bv l tg th fp n iu fq"></div></div></div></a></div><div class="j i d"><div class="ab"><span><button class="bc b bd z el sa em eo ep eq er es et eu ev ew ex ti ey ez fa bj fb fc">Follow</button></span><div class="dq l"><div><div><div class="bj" aria-hidden="false"><div class="l"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F186dc1a4f649&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%40Matthew_Frank%2Fstock-price-prediction-using-transformers-2d84341ff213&amp;newsletterV3=60c8a92cde0b&amp;newsletterV3Id=186dc1a4f649&amp;user=Mattafrank&amp;userId=60c8a92cde0b&amp;source=-----2d84341ff213---------------------subscribe_user-----------"><button class="bc b bd z tm am tn to tp tq tr ts tt tu et eu ev ew ex ey ez fa bj fb fc" aria-label="Subscribe"><svg width="38" height="38" viewBox="0 0 38 38" fill="none" class="tj tk tl"><rect x="26.25" y="9.25" width="0.5" height="6.5" rx="0.25"></rect><rect x="29.75" y="12.25" width="0.5" height="6.5" rx="0.25" transform="rotate(90 29.75 12.25)"></rect><path d="M19.5 12.5h-7a1 1 0 0 0-1 1v11a1 1 0 0 0 1 1h13a1 1 0 0 0 1-1v-5"></path><path d="M11.5 14.5L19 20l4-3"></path></svg></button></a></span></div></div></div></div></div></div></div></div><div class="ab ck cm"><div class="l"><div class="ab q"><a class="af ag ah ai aj ak al am an ao ap aq ar as at ab q" rel="noopener follow" href="/@Matthew_Frank?source=post_page-----2d84341ff213--------------------------------"><h2 class="pw-author-name bc tv tw tx ty bh"><span class="gk jl">Written by <!-- -->Mattafrank</span></h2></a></div><div class="ry ab"><div class="l jg"><span class="pw-follower-count bc b bd z bh"><a class="af ag ah ai aj ak al am an ao ap aq ar iz" rel="noopener follow" href="/@Matthew_Frank/followers?source=post_page-----2d84341ff213--------------------------------">37 Followers</a></span></div></div><div class="tz l"><p class="bc b bd z bh"><span class="gk">Software Engineer specializing in ML. Data Science MS from Berkeley.</span></p></div></div><div class="h k"><div class="ab"><span><button class="bc b bd z el sa em eo ep eq er es et eu ev ew ex ti ey ez fa bj fb fc">Follow</button></span><div class="dq l"><div><div><div class="bj" aria-hidden="false"><div class="l"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F186dc1a4f649&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%40Matthew_Frank%2Fstock-price-prediction-using-transformers-2d84341ff213&amp;newsletterV3=60c8a92cde0b&amp;newsletterV3Id=186dc1a4f649&amp;user=Mattafrank&amp;userId=60c8a92cde0b&amp;source=-----2d84341ff213---------------------subscribe_user-----------"><button class="bc b bd z tm am tn to tp tq tr ts tt tu et eu ev ew ex ey ez fa bj fb fc" aria-label="Subscribe"><svg width="38" height="38" viewBox="0 0 38 38" fill="none" class="tj tk tl"><rect x="26.25" y="9.25" width="0.5" height="6.5" rx="0.25"></rect><rect x="29.75" y="12.25" width="0.5" height="6.5" rx="0.25" transform="rotate(90 29.75 12.25)"></rect><path d="M19.5 12.5h-7a1 1 0 0 0-1 1v11a1 1 0 0 0 1 1h13a1 1 0 0 0 1-1v-5"></path><path d="M11.5 14.5L19 20l4-3"></path></svg></button></a></span></div></div></div></div></div></div></div></div><div class="ua be ub uc ud ue uf ug"></div></div></div><div class="h k j"><div class="ua be ub uh"></div><div class="ab by"><div class="cf be fw fx fy fz"><div class="ui ab ks jj"><div class="uj uk l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://help.medium.com/hc/en-us?source=post_page-----2d84341ff213--------------------------------" rel="noopener follow"><p class="bc b ds z dr">Help</p></a></div><div class="uj uk l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.statuspage.io/?source=post_page-----2d84341ff213--------------------------------" rel="noopener follow"><p class="bc b ds z dr">Status</p></a></div><div class="uj uk l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="/about?autoplay=1&amp;source=post_page-----2d84341ff213--------------------------------"><p class="bc b ds z dr">About</p></a></div><div class="uj uk l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----2d84341ff213--------------------------------"><p class="bc b ds z dr">Careers</p></a></div><div class="uj uk l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="mailto:pressinquiries@medium.com?source=post_page-----2d84341ff213--------------------------------" rel="noopener follow"><p class="bc b ds z dr">Press</p></a></div><div class="uj uk l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://blog.medium.com/?source=post_page-----2d84341ff213--------------------------------" rel="noopener follow"><p class="bc b ds z dr">Blog</p></a></div><div class="uj uk l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----2d84341ff213--------------------------------" rel="noopener follow"><p class="bc b ds z dr">Privacy</p></a></div><div class="uj uk l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----2d84341ff213--------------------------------" rel="noopener follow"><p class="bc b ds z dr">Terms</p></a></div><div class="uj uk l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://speechify.com/medium?source=post_page-----2d84341ff213--------------------------------" rel="noopener follow"><p class="bc b ds z dr">Text to speech</p></a></div><div class="uj l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="/business?source=post_page-----2d84341ff213--------------------------------"><p class="bc b ds z dr">Teams</p></a></div></div></div></div></div></div></div></div></div></div><script>window.__BUILD_ID__="main-20240618-222925-f18ac6f9c0"</script><script>window.__GRAPHQL_URI__ = "https://medium.com/_/graphql"</script><script>window.__PRELOADED_STATE__ = {"algolia":{"queries":{}},"cache":{"experimentGroupSet":true,"reason":"","group":"enabled","tags":["group-edgeCachePosts","post-2d84341ff213","user-60c8a92cde0b"],"serverVariantState":"44136fa355b3678a1146ad16f7e8649e94fb4fc21fe77e8310c060f61caaff8a","middlewareEnabled":true,"cacheStatus":"DYNAMIC","shouldUseCache":true,"vary":[],"updatedPostPreviewsEnabled":false,"lohpExperimentEnabled":"control","prideLogoEnabled":true},"client":{"hydrated":false,"isUs":false,"isNativeMedium":false,"isSafariMobile":false,"isSafari":false,"isFirefox":false,"routingEntity":{"type":"DEFAULT","explicit":false},"viewerIsBot":false},"debug":{"requestId":"60485e02-c156-48e6-8f89-555ac64720dd","hybridDevServices":[],"originalSpanCarrier":{"ot-tracer-spanid":"2988ba6f296f93b0","ot-tracer-traceid":"3871fb50273a3017","ot-tracer-sampled":"true"}},"multiVote":{"clapsPerPost":{}},"navigation":{"branch":{"show":null,"hasRendered":null,"blockedByCTA":false},"hideGoogleOneTap":false,"hasRenderedAlternateUserBanner":null,"currentLocation":"https:\u002F\u002Fmedium.com\u002F@Matthew_Frank\u002Fstock-price-prediction-using-transformers-2d84341ff213","host":"medium.com","hostname":"medium.com","referrer":"","hasSetReferrer":false,"susiModal":{"step":null,"operation":"register"},"postRead":false,"partnerProgram":{"selectedCountryCode":null},"queryString":"","currentHash":""},"config":{"nodeEnv":"production","version":"main-20240618-222925-f18ac6f9c0","target":"production","productName":"Medium","publicUrl":"https:\u002F\u002Fcdn-client.medium.com\u002Flite","authDomain":"medium.com","authGoogleClientId":"216296035834-k1k6qe060s2tp2a2jam4ljdcms00sttg.apps.googleusercontent.com","favicon":"production","glyphUrl":"https:\u002F\u002Fglyph.medium.com","branchKey":"key_live_ofxXr2qTrrU9NqURK8ZwEhknBxiI6KBm","algolia":{"appId":"MQ57UUUQZ2","apiKeySearch":"394474ced050e3911ae2249ecc774921","indexPrefix":"medium_","host":"-dsn.algolia.net"},"recaptchaKey":"6Lfc37IUAAAAAKGGtC6rLS13R1Hrw_BqADfS1LRk","recaptcha3Key":"6Lf8R9wUAAAAABMI_85Wb8melS7Zj6ziuf99Yot5","recaptchaEnterpriseKeyId":"6Le-uGgpAAAAAPprRaokM8AKthQ9KNGdoxaGUvVp","datadog":{"applicationId":"6702d87d-a7e0-42fe-bbcb-95b469547ea0","clientToken":"pub853ea8d17ad6821d9f8f11861d23dfed","rumToken":"pubf9cc52896502b9413b68ba36fc0c7162","context":{"deployment":{"target":"production","tag":"main-20240618-222925-f18ac6f9c0","commit":"f18ac6f9c0feb646a16229c86b98d1637117b4fa"}},"datacenter":"us"},"googleAnalyticsCode":"G-7JY7T788PK","googlePay":{"apiVersion":"2","apiVersionMinor":"0","merchantId":"BCR2DN6TV7EMTGBM","merchantName":"Medium","instanceMerchantId":"13685562959212738550"},"applePay":{"version":3},"signInWallCustomDomainCollectionIds":["3a8144eabfe3","336d898217ee","61061eb0c96b","138adf9c44c","819cc2aaeee0"],"mediumMastodonDomainName":"me.dm","mediumOwnedAndOperatedCollectionIds":["8a9336e5bb4","b7e45b22fec3","193b68bd4fba","8d6b8a439e32","54c98c43354d","3f6ecf56618","d944778ce714","92d2092dc598","ae2a65f35510","1285ba81cada","544c7006046e","fc8964313712","40187e704f1c","88d9857e584e","7b6769f2748b","bcc38c8f6edf","cef6983b292","cb8577c9149e","444d13b52878","713d7dbc99b0","ef8e90590e66","191186aaafa0","55760f21cdc5","9dc80918cc93","bdc4052bbdba","8ccfed20cbb2"],"tierOneDomains":["medium.com","thebolditalic.com","arcdigital.media","towardsdatascience.com","uxdesign.cc","codeburst.io","psiloveyou.xyz","writingcooperative.com","entrepreneurshandbook.co","prototypr.io","betterhumans.coach.me","theascent.pub"],"topicsToFollow":["d61cf867d93f","8a146bc21b28","1eca0103fff3","4d562ee63426","aef1078a3ef5","e15e46793f8d","6158eb913466","55f1c20aba7a","3d18b94f6858","4861fee224fd","63c6f1f93ee","1d98b3a9a871","decb52b64abf","ae5d4995e225","830cded25262"],"topicToTagMappings":{"accessibility":"accessibility","addiction":"addiction","android-development":"android-development","art":"art","artificial-intelligence":"artificial-intelligence","astrology":"astrology","basic-income":"basic-income","beauty":"beauty","biotech":"biotech","blockchain":"blockchain","books":"books","business":"business","cannabis":"cannabis","cities":"cities","climate-change":"climate-change","comics":"comics","coronavirus":"coronavirus","creativity":"creativity","cryptocurrency":"cryptocurrency","culture":"culture","cybersecurity":"cybersecurity","data-science":"data-science","design":"design","digital-life":"digital-life","disability":"disability","economy":"economy","education":"education","equality":"equality","family":"family","feminism":"feminism","fiction":"fiction","film":"film","fitness":"fitness","food":"food","freelancing":"freelancing","future":"future","gadgets":"gadgets","gaming":"gaming","gun-control":"gun-control","health":"health","history":"history","humor":"humor","immigration":"immigration","ios-development":"ios-development","javascript":"javascript","justice":"justice","language":"language","leadership":"leadership","lgbtqia":"lgbtqia","lifestyle":"lifestyle","machine-learning":"machine-learning","makers":"makers","marketing":"marketing","math":"math","media":"media","mental-health":"mental-health","mindfulness":"mindfulness","money":"money","music":"music","neuroscience":"neuroscience","nonfiction":"nonfiction","outdoors":"outdoors","parenting":"parenting","pets":"pets","philosophy":"philosophy","photography":"photography","podcasts":"podcast","poetry":"poetry","politics":"politics","privacy":"privacy","product-management":"product-management","productivity":"productivity","programming":"programming","psychedelics":"psychedelics","psychology":"psychology","race":"race","relationships":"relationships","religion":"religion","remote-work":"remote-work","san-francisco":"san-francisco","science":"science","self":"self","self-driving-cars":"self-driving-cars","sexuality":"sexuality","social-media":"social-media","society":"society","software-engineering":"software-engineering","space":"space","spirituality":"spirituality","sports":"sports","startups":"startup","style":"style","technology":"technology","transportation":"transportation","travel":"travel","true-crime":"true-crime","tv":"tv","ux":"ux","venture-capital":"venture-capital","visual-design":"visual-design","work":"work","world":"world","writing":"writing"},"defaultImages":{"avatar":{"imageId":"1*dmbNkD5D-u45r44go_cf0g.png","height":150,"width":150},"orgLogo":{"imageId":"1*OMF3fSqH8t4xBJ9-6oZDZw.png","height":106,"width":545},"postLogo":{"imageId":"1*kFrc4tBFM_tCis-2Ic87WA.png","height":810,"width":1440},"postPreviewImage":{"imageId":"1*hn4v1tCaJy7cWMyb0bpNpQ.png","height":386,"width":579}},"collectionStructuredData":{"8d6b8a439e32":{"name":"Elemental","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F980\u002F1*9ygdqoKprhwuTVKUM0DLPA@2x.png","width":980,"height":159}}},"3f6ecf56618":{"name":"Forge","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F596\u002F1*uULpIlImcO5TDuBZ6lm7Lg@2x.png","width":596,"height":183}}},"ae2a65f35510":{"name":"GEN","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F264\u002F1*RdVZMdvfV3YiZTw6mX7yWA.png","width":264,"height":140}}},"88d9857e584e":{"name":"LEVEL","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*JqYMhNX6KNNb2UlqGqO2WQ.png","width":540,"height":108}}},"7b6769f2748b":{"name":"Marker","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F383\u002F1*haCUs0wF6TgOOvfoY-jEoQ@2x.png","width":383,"height":92}}},"444d13b52878":{"name":"OneZero","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*cw32fIqCbRWzwJaoQw6BUg.png","width":540,"height":123}}},"8ccfed20cbb2":{"name":"Zora","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*tZUQqRcCCZDXjjiZ4bDvgQ.png","width":540,"height":106}}}},"embeddedPostIds":{"coronavirus":"cd3010f9d81f"},"sharedCdcMessaging":{"COVID_APPLICABLE_TAG_SLUGS":[],"COVID_APPLICABLE_TOPIC_NAMES":[],"COVID_APPLICABLE_TOPIC_NAMES_FOR_TOPIC_PAGE":[],"COVID_MESSAGES":{"tierA":{"text":"For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":66,"end":73,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"tierB":{"text":"Anyone can publish on Medium per our Policies, but we don’t fact-check every story. For more info about the coronavirus, see cdc.gov.","markups":[{"start":37,"end":45,"href":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Fcategories\u002F201931128-Policies-Safety"},{"start":125,"end":132,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"paywall":{"text":"This article has been made free for everyone, thanks to Medium Members. For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":56,"end":70,"href":"https:\u002F\u002Fmedium.com\u002Fmembership"},{"start":138,"end":145,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"unbound":{"text":"This article is free for everyone, thanks to Medium Members. For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":45,"end":59,"href":"https:\u002F\u002Fmedium.com\u002Fmembership"},{"start":127,"end":134,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]}},"COVID_BANNER_POST_ID_OVERRIDE_WHITELIST":["3b31a67bff4a"]},"sharedVoteMessaging":{"TAGS":["politics","election-2020","government","us-politics","election","2020-presidential-race","trump","donald-trump","democrats","republicans","congress","republican-party","democratic-party","biden","joe-biden","maga"],"TOPICS":["politics","election"],"MESSAGE":{"text":"Find out more about the U.S. election results here.","markups":[{"start":46,"end":50,"href":"https:\u002F\u002Fcookpolitical.com\u002F2020-national-popular-vote-tracker"}]},"EXCLUDE_POSTS":["397ef29e3ca5"]},"embedPostRules":[],"recircOptions":{"v1":{"limit":3},"v2":{"limit":8}},"braintreeClientKey":"production_zjkj96jm_m56f8fqpf7ngnrd4","braintree":{"enabled":true,"merchantId":"m56f8fqpf7ngnrd4","merchantAccountId":{"usd":"AMediumCorporation_instant","eur":"amediumcorporation_EUR","cad":"amediumcorporation_CAD"},"publicKey":"ds2nn34bg2z7j5gd","braintreeEnvironment":"production","dashboardUrl":"https:\u002F\u002Fwww.braintreegateway.com\u002Fmerchants","gracePeriodDurationInDays":14,"mediumMembershipPlanId":{"monthly":"ce105f8c57a3","monthlyV2":"e8a5e126-792b-4ee6-8fba-d574c1b02fc5","monthlyWithTrial":"d5ee3dbe3db8","monthlyPremium":"fa741a9b47a2","yearly":"a40ad4a43185","yearlyV2":"3815d7d6-b8ca-4224-9b8c-182f9047866e","yearlyStaff":"d74fb811198a","yearlyWithTrial":"b3bc7350e5c7","yearlyPremium":"e21bd2c12166","monthlyOneYearFree":"e6c0637a-2bad-4171-ab4f-3c268633d83c","monthly25PercentOffFirstYear":"235ecc62-0cdb-49ae-9378-726cd21c504b","monthly20PercentOffFirstYear":"ba518864-9c13-4a99-91ca-411bf0cac756","monthly15PercentOffFirstYear":"594c029b-9f89-43d5-88f8-8173af4e070e","monthly10PercentOffFirstYear":"c6c7bc9a-40f2-4b51-8126-e28511d5bdb0","monthlyForStudents":"629ebe51-da7d-41fd-8293-34cd2f2030a8","yearlyOneYearFree":"78ba7be9-0d9f-4ece-aa3e-b54b826f2bf1","yearly25PercentOffFirstYear":"2dbb010d-bb8f-4eeb-ad5c-a08509f42d34","yearly20PercentOffFirstYear":"47565488-435b-47f8-bf93-40d5fbe0ebc8","yearly15PercentOffFirstYear":"8259809b-0881-47d9-acf7-6c001c7f720f","yearly10PercentOffFirstYear":"9dd694fb-96e1-472c-8d9e-3c868d5c1506","yearlyForStudents":"e29345ef-ab1c-4234-95c5-70e50fe6bc23","monthlyCad":"p52orjkaceei","yearlyCad":"h4q9g2up9ktt"},"braintreeDiscountId":{"oneMonthFree":"MONTHS_FREE_01","threeMonthsFree":"MONTHS_FREE_03","sixMonthsFree":"MONTHS_FREE_06","fiftyPercentOffOneYear":"FIFTY_PERCENT_OFF_ONE_YEAR"},"3DSecureVersion":"2","defaultCurrency":"usd","providerPlanIdCurrency":{"4ycw":"usd","rz3b":"usd","3kqm":"usd","jzw6":"usd","c2q2":"usd","nnsw":"usd","q8qw":"usd","d9y6":"usd","fx7w":"cad","nwf2":"cad"}},"paypalClientId":"AXj1G4fotC2GE8KzWX9mSxCH1wmPE3nJglf4Z2ig_amnhvlMVX87otaq58niAg9iuLktVNF_1WCMnN7v","paypal":{"host":"https:\u002F\u002Fapi.paypal.com:443","clientMode":"production","serverMode":"live","webhookId":"4G466076A0294510S","monthlyPlan":{"planId":"P-9WR0658853113943TMU5FDQA","name":"Medium Membership (Monthly) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"yearlyPlan":{"planId":"P-7N8963881P8875835MU5JOPQ","name":"Medium Membership (Annual) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"oneYearGift":{"name":"Medium Membership (1 Year, Digital Gift Code)","description":"Unlimited access to the best and brightest stories on Medium. Gift codes can be redeemed at medium.com\u002Fredeem.","price":"50.00","currency":"USD","sku":"membership-gift-1-yr"},"oldMonthlyPlan":{"planId":"P-96U02458LM656772MJZUVH2Y","name":"Medium Membership (Monthly)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"oldYearlyPlan":{"planId":"P-59P80963JF186412JJZU3SMI","name":"Medium Membership (Annual)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"monthlyPlanWithTrial":{"planId":"P-66C21969LR178604GJPVKUKY","name":"Medium Membership (Monthly) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"yearlyPlanWithTrial":{"planId":"P-6XW32684EX226940VKCT2MFA","name":"Medium Membership (Annual) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"oldMonthlyPlanNoSetupFee":{"planId":"P-4N046520HR188054PCJC7LJI","name":"Medium Membership (Monthly)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"oldYearlyPlanNoSetupFee":{"planId":"P-7A4913502Y5181304CJEJMXQ","name":"Medium Membership (Annual)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"sdkUrl":"https:\u002F\u002Fwww.paypal.com\u002Fsdk\u002Fjs"},"stripePublishableKey":"pk_live_7FReX44VnNIInZwrIIx6ghjl","log":{"json":true,"level":"info"},"imageUploadMaxSizeMb":25,"staffPicks":{"title":"Staff Picks","catalogId":"c7bc6e1ee00f"}},"session":{"xsrf":""}}</script><script>window.__APOLLO_STATE__ = {"ROOT_QUERY":{"__typename":"Query","isLoggedIn":false,"viewer":null,"postResult({\"id\":\"2d84341ff213\"})":{"__ref":"Post:2d84341ff213"},"collectionByDomainOrSlug({\"domainOrSlug\":\"medium.com\"})":null},"LinkedAccounts:60c8a92cde0b":{"__typename":"LinkedAccounts","mastodon":null,"id":"60c8a92cde0b"},"UserViewerEdge:userId:60c8a92cde0b-viewerId:lo_a608cef94991":{"__typename":"UserViewerEdge","id":"userId:60c8a92cde0b-viewerId:lo_a608cef94991","isFollowing":false,"isUser":false,"isMuting":false},"NewsletterV3:186dc1a4f649":{"__typename":"NewsletterV3","id":"186dc1a4f649","type":"NEWSLETTER_TYPE_AUTHOR","slug":"60c8a92cde0b","name":"60c8a92cde0b","collection":null,"user":{"__ref":"User:60c8a92cde0b"}},"User:60c8a92cde0b":{"__typename":"User","id":"60c8a92cde0b","name":"Mattafrank","username":"Matthew_Frank","newsletterV3":{"__ref":"NewsletterV3:186dc1a4f649"},"linkedAccounts":{"__ref":"LinkedAccounts:60c8a92cde0b"},"isSuspended":false,"imageId":"1*qcpoaEXNU6D1tZbZVTZisw.png","mediumMemberAt":1710263678000,"verifications":{"__typename":"VerifiedInfo","isBookAuthor":false},"socialStats":{"__typename":"SocialStats","followerCount":37},"customDomainState":null,"hasSubdomain":false,"bio":"Software Engineer specializing in ML. Data Science MS from Berkeley.","isPartnerProgramEnrolled":false,"viewerEdge":{"__ref":"UserViewerEdge:userId:60c8a92cde0b-viewerId:lo_a608cef94991"},"viewerIsUser":false,"postSubscribeMembershipUpsellShownAt":0,"allowNotes":true,"membership":{"__ref":"Membership:d171e69d6a0d"},"twitterScreenName":"","pronouns":[]},"Paragraph:9d2a01304107_0":{"__typename":"Paragraph","id":"9d2a01304107_0","name":"fdb8","type":"H3","href":null,"layout":null,"metadata":null,"text":"Stock Price Prediction Using Transformers","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_1":{"__typename":"Paragraph","id":"9d2a01304107_1","name":"5bde","type":"H4","href":null,"layout":null,"metadata":null,"text":"Introduction: The Evolving Landscape of Stock Price Prediction","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_2":{"__typename":"Paragraph","id":"9d2a01304107_2","name":"4b98","type":"P","href":null,"layout":null,"metadata":null,"text":"In the fast-paced world of finance, the ability to predict stock prices accurately offers a significant advantage to traders and investors alike. However, the inherently volatile nature of financial markets makes this task extraordinarily challenging. Traditional statistical methods have long been employed to forecast trends and movements, but the rise of machine learning has revolutionized this field.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_3":{"__typename":"Paragraph","id":"9d2a01304107_3","name":"df79","type":"P","href":null,"layout":null,"metadata":null,"text":"Among the various machine learning techniques, the introduction of Neural Network Architectures has marked a significant leap in predictive accuracy and processing capabilities. Recently, Transformers, which are at the core of Large Language Models (LLMs), have emerged as a cutting-edge technology in this domain. Originally designed for natural language processing tasks, Transformers excel at handling sequential data due to their sophisticated attention mechanisms. This makes them exceptionally well-suited for time series analysis like stock price prediction, traditionally dominated by Long Short-Term Memory networks (LSTMs). While LSTMs have been a staple due to their ability to capture temporal dependencies, they are increasingly seen as less efficient compared to the parallel processing capabilities and scalability of Transformers.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":188,"end":200,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":188,"end":200,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_4":{"__typename":"Paragraph","id":"9d2a01304107_4","name":"1562","type":"P","href":null,"layout":null,"metadata":null,"text":"Given the complexity of predicting exact stock prices, our approach focuses on determining the directional movement of stock prices instead. More specifically, we aim to predict whether the stock price at the end of the third hour will be higher or lower than the last known price at the end of the second hour. To achieve this, our model leverages 2 hours’ worth of data, segmented into 5-minute intervals, to make its predictions. This method not only simplifies the challenge but also aligns more closely with practical trading strategies where directional trends are often more valuable than exact future prices.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_5":{"__typename":"Paragraph","id":"9d2a01304107_5","name":"459d","type":"P","href":null,"layout":null,"metadata":null,"text":"This article will delve into the specifics of employing a Transformer-based model for stock price prediction, exploring the intricacies of the architecture, the rationale behind using such a model, and the potential it holds for the future of algorithmic trading","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_6":{"__typename":"Paragraph","id":"9d2a01304107_6","name":"d68a","type":"P","href":null,"layout":null,"metadata":null,"text":"You can check out my notebook for this project here.\nLets jump into some code!","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":47,"end":51,"href":"https:\u002F\u002Fcolab.research.google.com\u002Fdrive\u002F1j3AYSIxhiNJSCP692pKPbLk4_-kG4Pmh?usp=sharing","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":47,"end":53,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_7":{"__typename":"Paragraph","id":"9d2a01304107_7","name":"abf1","type":"H3","href":null,"layout":null,"metadata":null,"text":"Import Libraries","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_8":{"__typename":"Paragraph","id":"9d2a01304107_8","name":"5c5e","type":"PRE","href":null,"layout":null,"metadata":null,"text":"import math\nimport numpy as np\nimport pandas as pd\n\nimport tensorflow as tf\nfrom tensorflow.keras.models import Model\nfrom tensorflow.keras.callbacks import ModelCheckpoint\nfrom tensorflow.keras.layers import Input, Dense, Dropout, LayerNormalization, MultiHeadAttention, Add, GlobalAveragePooling1D\n\nimport yfinance as yf","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"EXPLICIT","lang":"python"},"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_9":{"__typename":"Paragraph","id":"9d2a01304107_9","name":"73d2","type":"H3","href":null,"layout":null,"metadata":null,"text":"Leveraging Financial Indicators for Enhanced Predictive Analysis","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_10":{"__typename":"Paragraph","id":"9d2a01304107_10","name":"ecbd","type":"P","href":null,"layout":null,"metadata":null,"text":"In the world of stock trading, using the right financial indicators can significantly enhance the predictive capabilities of machine learning models. These indicators provide statistical insights into market trends and behaviors, which are crucial for making informed predictions. Below, we discuss three key metrics used in our model: Bollinger Bands, the Relative Strength Index (RSI), and the Rate of Change (ROC).","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_11":{"__typename":"Paragraph","id":"9d2a01304107_11","name":"13c8","type":"H4","href":null,"layout":null,"metadata":null,"text":"Bollinger Bands","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_12":{"__typename":"Paragraph","id":"9d2a01304107_12","name":"7db4","type":"P","href":null,"layout":null,"metadata":null,"text":"Bollinger Bands are a type of statistical chart characterizing the prices and volatility over time of a financial instrument or commodity. The Bands consist of a middle band being a rolling mean, and two outer bands located at a distance that is a standard deviation away. This setup helps in identifying whether prices are high or low on a relative basis. They are particularly useful for finding periods of oversupply and undersupply, which can signal potential buying or selling opportunities.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_13":{"__typename":"Paragraph","id":"9d2a01304107_13","name":"5525","type":"H4","href":null,"layout":null,"metadata":null,"text":"Relative Strength Index (RSI)","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_14":{"__typename":"Paragraph","id":"9d2a01304107_14","name":"2a64","type":"P","href":null,"layout":null,"metadata":null,"text":"The Relative Strength Index (RSI) is a momentum oscillator that measures the speed and change of price movements. RSI oscillates between zero and 100. Traditionally, and according to Wilder, RSI is considered overbought when above 70 and oversold when below 30. This indicator helps traders identify potential reversal points based on the internal strength of the asset’s price movement.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_15":{"__typename":"Paragraph","id":"9d2a01304107_15","name":"cc6e","type":"H4","href":null,"layout":null,"metadata":null,"text":"Rate of Change (ROC)","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_16":{"__typename":"Paragraph","id":"9d2a01304107_16","name":"cd32","type":"P","href":null,"layout":null,"metadata":null,"text":"The Rate of Change (ROC) is a momentum oscillator, which measures the percentage change between the current price and the price a certain number of periods ago. ROC is often used to detect divergences, which occur when the price of an asset moves in the opposite direction of a technical indicator and may indicate that an asset’s price will undergo a reversal.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_17":{"__typename":"Paragraph","id":"9d2a01304107_17","name":"5c0c","type":"PRE","href":null,"layout":null,"metadata":null,"text":"def calculate_bollinger_bands(data, window=10, num_of_std=2):\n    \"\"\"Calculate Bollinger Bands\"\"\"\n    rolling_mean = data.rolling(window=window).mean()\n    rolling_std = data.rolling(window=window).std()\n    upper_band = rolling_mean + (rolling_std * num_of_std)\n    lower_band = rolling_mean - (rolling_std * num_of_std)\n    return upper_band, lower_band\n\ndef calculate_rsi(data, window=10):\n    \"\"\"Calculate Relative Strength Index\"\"\"\n    delta = data.diff()\n    gain = delta.clip(lower=0)\n    loss = -delta.clip(upper=0)\n    avg_gain = gain.rolling(window=window, min_periods=1).mean()\n    avg_loss = loss.rolling(window=window, min_periods=1).mean()\n    rs = avg_gain \u002F avg_loss\n    rsi = 100 - (100 \u002F (1 + rs))\n    return rsi\n\ndef calculate_roc(data, periods=10):\n    \"\"\"Calculate Rate of Change.\"\"\"\n    roc = ((data - data.shift(periods)) \u002F data.shift(periods)) * 100\n    return roc","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"EXPLICIT","lang":"python"},"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_18":{"__typename":"Paragraph","id":"9d2a01304107_18","name":"cde2","type":"H3","href":null,"layout":null,"metadata":null,"text":"Focusing on Big Tech","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_19":{"__typename":"Paragraph","id":"9d2a01304107_19","name":"ee35","type":"P","href":null,"layout":null,"metadata":null,"text":"In the rapidly evolving tech sector, companies like Meta, Apple, Microsoft, Amazon, and Alphabet (commonly referred to collectively as MAMAA) stand out not only for their size but also for their significant impact on global markets. By focusing our predictive model on these industry leaders, we aim to capture trends and patterns that are most relevant to the big tech sector. This strategic choice allows us to develop a model that can generalize across similarly positioned companies, offering insights into the movements of some of the most influential players in the stock market.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_20":{"__typename":"Paragraph","id":"9d2a01304107_20","name":"9093","type":"PRE","href":null,"layout":null,"metadata":null,"text":"# List of tickers for the big tech companies, forming the MAMAA group\ntickers = ['META', 'AAPL', 'MSFT', 'AMZN', 'GOOG']","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"EXPLICIT","lang":"python"},"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_21":{"__typename":"Paragraph","id":"9d2a01304107_21","name":"ad7d","type":"H3","href":null,"layout":null,"metadata":null,"text":"Standardizing and Enhancing Data for Predictive Accuracy","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_22":{"__typename":"Paragraph","id":"9d2a01304107_22","name":"b89a","type":"P","href":null,"layout":null,"metadata":null,"text":"To ensure our model can accurately interpret trends and make predictions, we meticulously process and enhance the data associated with each company in the MAMAA group. This involves several critical steps that transform raw stock data into a refined format ready for machine learning analysis.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_23":{"__typename":"Paragraph","id":"9d2a01304107_23","name":"97b8","type":"H4","href":null,"layout":null,"metadata":null,"text":"Data Processing","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_24":{"__typename":"Paragraph","id":"9d2a01304107_24","name":"5c8a","type":"P","href":null,"layout":null,"metadata":null,"text":"Data Retrieval: We download 60 days of historical stock data at 5-minute intervals using yfinance. This high-resolution data helps capture intra-day volatility and trends.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":89,"end":97,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":0,"end":15,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_25":{"__typename":"Paragraph","id":"9d2a01304107_25","name":"0b20","type":"P","href":null,"layout":null,"metadata":null,"text":"Feature Engineering:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":20,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_26":{"__typename":"Paragraph","id":"9d2a01304107_26","name":"55be","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Bollinger Bands: We calculate the Bollinger Bands to assess volatility. The width between the upper and lower bands (width) is used as a feature, providing insights into market volatility.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":117,"end":122,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":0,"end":16,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_27":{"__typename":"Paragraph","id":"9d2a01304107_27","name":"a874","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Close Price and Volume: We directly use the closing price and trading volume as features, which are fundamental to most trading models.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":0,"end":23,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_28":{"__typename":"Paragraph","id":"9d2a01304107_28","name":"09a2","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Price Differences: We calculate the difference (diff) between the current close price and the previous close, capturing immediate price movements.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":48,"end":52,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":0,"end":18,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_29":{"__typename":"Paragraph","id":"9d2a01304107_29","name":"1d96","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Percentage Change: The percentage change in close price from the previous close (percent_change_close) highlights the rate of price changes, serving as a momentum indicator.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":81,"end":101,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":0,"end":18,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_30":{"__typename":"Paragraph","id":"9d2a01304107_30","name":"e72d","type":"P","href":null,"layout":null,"metadata":null,"text":"Normalization:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":14,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_31":{"__typename":"Paragraph","id":"9d2a01304107_31","name":"6709","type":"ULI","href":null,"layout":null,"metadata":null,"text":"To ensure all features contribute equally to the model’s learning process, we standardize each feature by subtracting the mean and dividing by the standard deviation (mean and std).","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":167,"end":171,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":176,"end":179,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_32":{"__typename":"Paragraph","id":"9d2a01304107_32","name":"5123","type":"ULI","href":null,"layout":null,"metadata":null,"text":"We save these statistical parameters (mean and standard deviation) for each feature. This is crucial for later “un-scaling” the model’s predictions to interpret them in their original scales.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_33":{"__typename":"Paragraph","id":"9d2a01304107_33","name":"e8d8","type":"PRE","href":null,"layout":null,"metadata":null,"text":"ticker_data_frames = []\nstats = {}\nfor ticker in tickers:\n  \n    # Download historical data for the ticker\n    data = yf.download(ticker, period=\"60d\", interval=\"5m\")\n\n    # Calculate the daily percentage change\n    close = data['Close']\n    upper, lower = calculate_bollinger_bands(close, window=14, num_of_std=2)\n    width = upper - lower\n    rsi = calculate_rsi(close, window=14)\n    roc = calculate_roc(close, periods=14)\n    volume = data['Volume']\n    diff = data['Close'].diff(1)\n    percent_change_close = data['Close'].pct_change() * 100\n\n    # Create a DataFrame for the current ticker and append it to the list\n    ticker_df = pd.DataFrame({\n        ticker+'_close': close,\n        ticker+'_width': width,\n        ticker+'_rsi': rsi,\n        ticker+'_roc': roc,\n        ticker+'_volume': volume,\n        ticker+'_diff': diff,\n        ticker+'_percent_change_close': percent_change_close,\n    })\n    \n    MEAN = ticker_df.mean()\n    STD = ticker_df.std()\n\n    # Keep track of mean and std\n    for column in MEAN.index:\n      stats[f\"{column}_mean\"] = MEAN[column]\n      stats[f\"{column}_std\"] = STD[column]\n    \n    # Normalize the training features\n    ticker_df = (ticker_df - MEAN) \u002F STD\n\n    ticker_data_frames.append(ticker_df)","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"EXPLICIT","lang":"python"},"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_34":{"__typename":"Paragraph","id":"9d2a01304107_34","name":"5c73","type":"H3","href":null,"layout":null,"metadata":null,"text":"Organizing Statistical Data for Model Reference","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_35":{"__typename":"Paragraph","id":"9d2a01304107_35","name":"4a76","type":"P","href":null,"layout":null,"metadata":null,"text":"Once we have computed the necessary statistics for each feature across all tickers, it is essential to organize this data in a structured format. This organization aids in both model training and later stages where we might need to reverse the normalization process for interpretation and analysis.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_36":{"__typename":"Paragraph","id":"9d2a01304107_36","name":"3f56","type":"H4","href":null,"layout":null,"metadata":null,"text":"Storing and Viewing Statistics","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_37":{"__typename":"Paragraph","id":"9d2a01304107_37","name":"0e76","type":"P","href":null,"layout":null,"metadata":null,"text":"The statistical parameters — mean and standard deviation — for each feature are initially stored in a dictionary for ease of access and manipulation. To streamline the usage of these parameters within our model’s training and prediction phases, we convert this dictionary into a Pandas DataFrame. This conversion not only structures the data but also facilitates quick look-ups and operations on the statistical data.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_38":{"__typename":"Paragraph","id":"9d2a01304107_38","name":"d3ac","type":"PRE","href":null,"layout":null,"metadata":null,"text":"# Convert the dictionary containing feature statistics to a DataFrame for easier access\nstats = pd.DataFrame([stats], index=[0])\n\n# Display the DataFrame to verify its structure\nstats.head()","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"EXPLICIT","lang":"python"},"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*n7yaiUukh7X3jfaWXG-QfQ.png":{"__typename":"ImageMetadata","id":"1*n7yaiUukh7X3jfaWXG-QfQ.png","originalHeight":118,"originalWidth":1387,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:9d2a01304107_39":{"__typename":"Paragraph","id":"9d2a01304107_39","name":"1eea","type":"IMG","href":null,"layout":"OUTSET_CENTER","metadata":{"__ref":"ImageMetadata:1*n7yaiUukh7X3jfaWXG-QfQ.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_40":{"__typename":"Paragraph","id":"9d2a01304107_40","name":"3772","type":"H3","href":null,"layout":null,"metadata":null,"text":"Consolidating Data for Comprehensive Analysis","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_41":{"__typename":"Paragraph","id":"9d2a01304107_41","name":"afb9","type":"P","href":null,"layout":null,"metadata":null,"text":"To facilitate a unified analysis and ensure that our model can learn from a broader dataset encompassing all selected big tech companies, we consolidate the individual dataframes into a single structure. This approach allows the model to understand and find patterns across multiple stocks simultaneously.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_42":{"__typename":"Paragraph","id":"9d2a01304107_42","name":"c291","type":"H4","href":null,"layout":null,"metadata":null,"text":"Data Consolidation and Cleaning","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_43":{"__typename":"Paragraph","id":"9d2a01304107_43","name":"0b28","type":"OLI","href":null,"layout":null,"metadata":null,"text":"Concatenation: We concatenate the dataframes for each ticker along the columns. This means each ticker’s features will be side by side, enabling our model to access all relevant data points across different stocks within the same model input.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":14,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_44":{"__typename":"Paragraph","id":"9d2a01304107_44","name":"0b7d","type":"OLI","href":null,"layout":null,"metadata":null,"text":"Handling Infinite Values: In data processing, especially after normalization, it’s possible to encounter infinite values due to division by zero or other anomalies. We replace these infinite values with NaN (Not a Number) to prevent them from affecting subsequent calculations.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":25,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_45":{"__typename":"Paragraph","id":"9d2a01304107_45","name":"f8ed","type":"OLI","href":null,"layout":null,"metadata":null,"text":"Removing Missing Data: We then remove any rows that contain NaN values. This step is crucial to maintain the quality of the dataset, ensuring that the model trains on complete and accurate data only.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":22,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_46":{"__typename":"Paragraph","id":"9d2a01304107_46","name":"c672","type":"OLI","href":null,"layout":null,"metadata":null,"text":"Previewing the Data: Finally, to verify that our data is well-structured and ready for modeling, we display the first few rows. This preview helps confirm that the data alignment and cleaning processes have been executed correctly.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":20,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_47":{"__typename":"Paragraph","id":"9d2a01304107_47","name":"7e90","type":"PRE","href":null,"layout":null,"metadata":null,"text":"df = pd.concat(ticker_data_frames, axis=1)\ndf.replace([np.inf, -np.inf], np.nan, inplace=True)\ndf.dropna(inplace=True)\ndf.head()","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"EXPLICIT","lang":"python"},"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*xkcK0FSavHIwISDEP-NqvA.png":{"__typename":"ImageMetadata","id":"1*xkcK0FSavHIwISDEP-NqvA.png","originalHeight":463,"originalWidth":2498,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:9d2a01304107_48":{"__typename":"Paragraph","id":"9d2a01304107_48","name":"1790","type":"IMG","href":null,"layout":"OUTSET_CENTER","metadata":{"__ref":"ImageMetadata:1*xkcK0FSavHIwISDEP-NqvA.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_49":{"__typename":"Paragraph","id":"9d2a01304107_49","name":"7890","type":"H3","href":null,"layout":null,"metadata":null,"text":"Preparing Data Labels for Predictive Modeling","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_50":{"__typename":"Paragraph","id":"9d2a01304107_50","name":"085a","type":"P","href":null,"layout":null,"metadata":null,"text":"We generate labels by shifting the dataset to align future data points (i.e., future stock prices or indicators) with the current row’s features. This arrangement prepares the model to predict future outcomes based on current input data.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_51":{"__typename":"Paragraph","id":"9d2a01304107_51","name":"6279","type":"H4","href":null,"layout":null,"metadata":null,"text":"Label Creation and Data Alignment","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_52":{"__typename":"Paragraph","id":"9d2a01304107_52","name":"7389","type":"OLI","href":null,"layout":null,"metadata":null,"text":"Creating Labels: We create the labels by shifting the entire DataFrame up by one position. This shift aligns each row with the subsequent time step’s data, which the model will attempt to predict.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":16,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_53":{"__typename":"Paragraph","id":"9d2a01304107_53","name":"31bc","type":"OLI","href":null,"layout":null,"metadata":null,"text":"Ensuring Data Integrity: After shifting the data, the last row in the DataFrame will not have a corresponding future data point to act as a label. To maintain data integrity and avoid training on incomplete data, we remove the last row from both the feature set (df) and the labels.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":24,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_54":{"__typename":"Paragraph","id":"9d2a01304107_54","name":"65c5","type":"PRE","href":null,"layout":null,"metadata":null,"text":"# Shift the dataframe up by one to align current features with the next step's outcomes\nlabels = df.shift(-1)\n\n# Remove the last row from both the features and labels to maintain consistent data pairs\ndf = df.iloc[:-1]\nlabels = labels.iloc[:-1]","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"EXPLICIT","lang":"python"},"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_55":{"__typename":"Paragraph","id":"9d2a01304107_55","name":"1555","type":"H3","href":null,"layout":null,"metadata":null,"text":"Structuring Data into Sequences for Time-Series Forecasting","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_56":{"__typename":"Paragraph","id":"9d2a01304107_56","name":"86c1","type":"P","href":null,"layout":null,"metadata":null,"text":"To train our model effectively on time-series data, it is crucial to structure the input into sequences that reflect the temporal dependencies inherent in stock prices. Our approach involves creating sequences that represent 2 hours of trading data, which prepares the model to predict stock movements in the subsequent hour.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_57":{"__typename":"Paragraph","id":"9d2a01304107_57","name":"b818","type":"H4","href":null,"layout":null,"metadata":null,"text":"Sequence Creation and Label Preparation","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_58":{"__typename":"Paragraph","id":"9d2a01304107_58","name":"6094","type":"OLI","href":null,"layout":null,"metadata":null,"text":"Defining Sequence Length: We define the sequence length as 24, which corresponds to 2 hours of data at 5-minute intervals. This length is chosen to provide the model with enough recent historical data to detect short-term trends and patterns.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":25,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_59":{"__typename":"Paragraph","id":"9d2a01304107_59","name":"467a","type":"OLI","href":null,"layout":null,"metadata":null,"text":"Sequence and Label Generation:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":30,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_60":{"__typename":"Paragraph","id":"9d2a01304107_60","name":"6a09","type":"ULI","href":null,"layout":null,"metadata":null,"text":"The function create_sequences constructs sequences of the specified length and prepares the corresponding labels. We aim to predict the stock price movement an hour beyond the end of each sequence, hence the additional 12 steps (representing 60 minutes) beyond the sequence length.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":13,"end":29,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_61":{"__typename":"Paragraph","id":"9d2a01304107_61","name":"b3e6","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Each label array not only includes the target value but also the mean and standard deviation of the feature set. This inclusion is critical for later stages when we need to un-scale predictions to their original scale for accurate interpretation and evaluation","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_62":{"__typename":"Paragraph","id":"9d2a01304107_62","name":"b249","type":"P","href":null,"layout":null,"metadata":null,"text":"3. Importance of Scaling Information: Attaching the mean and standard deviation to each label is essential for our custom metrics during model evaluation. These scaling factors allow us to convert the model’s output back to the original scale, enabling us to accurately measure performance and make actionable predictions.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":3,"end":37,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_63":{"__typename":"Paragraph","id":"9d2a01304107_63","name":"2557","type":"PRE","href":null,"layout":null,"metadata":null,"text":"SEQUENCE_LEN = 24  # 2 hours of data at 5-minute intervals\n\ndef create_sequences(data, labels, mean, std, sequence_length=SEQUENCE_LEN):\n    sequences = []\n    lab = []\n    data_size = len(data)\n\n    # Loop to create each sequence and its corresponding label\n    for i in range(data_size - (sequence_length + 13)): # Ensure we have data for the label\n        if i == 0:\n          continue\n        sequences.append(data[i:i + sequence_length])  # The sequence of data\n        lab.append([labels[i-1], labels[i + 12], mean[0], std[0]]) # The label and scaling factors\n        \n    return np.array(sequences), np.array(lab)","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"python"},"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_64":{"__typename":"Paragraph","id":"9d2a01304107_64","name":"1aec","type":"H3","href":null,"layout":null,"metadata":null,"text":"Generating Training Sequences for Each Ticker","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_65":{"__typename":"Paragraph","id":"9d2a01304107_65","name":"24cd","type":"P","href":null,"layout":null,"metadata":null,"text":"For our model to learn effectively from the vast array of stock data available, it’s essential to transform the preprocessed data into a format that the neural network can understand and learn from. This involves creating training sequences for each ticker that encapsulate the necessary features and labels.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_66":{"__typename":"Paragraph","id":"9d2a01304107_66","name":"87de","type":"H4","href":null,"layout":null,"metadata":null,"text":"Sequence Generation for Each Ticker","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_67":{"__typename":"Paragraph","id":"9d2a01304107_67","name":"dacc","type":"OLI","href":null,"layout":null,"metadata":null,"text":"Data Extraction: For each ticker, we extract multiple features from the DataFrame. These features include the closing price, Bollinger Band width, RSI, ROC, trading volume, the difference in closing prices, and the percentage change in closing prices. These are key indicators that can help predict stock price movements.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":16,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_68":{"__typename":"Paragraph","id":"9d2a01304107_68","name":"cb5f","type":"OLI","href":null,"layout":null,"metadata":null,"text":"Combining Data: The extracted data is combined into a single array for each ticker. This combination allows us to handle the data more efficiently and ensures that all relevant features are included in the sequence generation process.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":15,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_69":{"__typename":"Paragraph","id":"9d2a01304107_69","name":"ad46","type":"OLI","href":null,"layout":null,"metadata":null,"text":"Sequence and Label Creation:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":28,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_70":{"__typename":"Paragraph","id":"9d2a01304107_70","name":"46dc","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Using the previously defined create_sequences function, we generate sequences of the combined data. This function also prepares the corresponding labels, using the future close price as the target for prediction.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":29,"end":45,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_71":{"__typename":"Paragraph","id":"9d2a01304107_71","name":"f392","type":"ULI","href":null,"layout":null,"metadata":null,"text":"The sequences include scaling factors (mean and standard deviation), ensuring that we can revert the model’s predictions to the original scale for accurate evaluation and interpretation.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_72":{"__typename":"Paragraph","id":"9d2a01304107_72","name":"ecee","type":"PRE","href":null,"layout":null,"metadata":null,"text":"sequences_dict = {}\nsequence_labels = {}\nfor ticker in tickers:\n\n    # Extract close and volume data for the ticker\n    close = df[ticker+'_close'].values\n    width = df[ticker+'_width'].values\n    rsi = df[ticker+'_rsi'].values\n    roc = df[ticker+'_roc'].values\n    volume = df[ticker+'_volume'].values\n    diff = df[ticker+'_diff'].values\n    pct_change = df[ticker+'_percent_change_close'].values\n    \n    # Combine close and volume data\n    ticker_data = np.column_stack((close,\n                                   width,\n                                   rsi,\n                                   roc,\n                                   volume,\n                                   diff,\n                                   pct_change))\n    \n    # Generate sequences\n    attribute = ticker+\"_close\"\n    ticker_sequences, lab = create_sequences(ticker_data,\n                                             labels[attribute].values[SEQUENCE_LEN-1:],\n                                             stats[attribute+\"_mean\"].values,\n                                             stats[attribute+\"_std\"].values)\n    \n    sequences_dict[ticker] = ticker_sequences\n    sequence_labels[ticker] = lab","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"EXPLICIT","lang":"python"},"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_73":{"__typename":"Paragraph","id":"9d2a01304107_73","name":"2c60","type":"H3","href":null,"layout":null,"metadata":null,"text":"Aggregating Data Across Tickers for Unified Model Training","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_74":{"__typename":"Paragraph","id":"9d2a01304107_74","name":"7276","type":"P","href":null,"layout":null,"metadata":null,"text":"To ensure our model benefits from a diverse and comprehensive dataset, we aggregate the sequences and labels from each ticker into a unified dataset. This approach enables the model to learn generalized patterns that apply across different stocks within the big tech sector.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_75":{"__typename":"Paragraph","id":"9d2a01304107_75","name":"6e02","type":"H4","href":null,"layout":null,"metadata":null,"text":"Aggregating Sequences and Labels","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_76":{"__typename":"Paragraph","id":"9d2a01304107_76","name":"beb0","type":"P","href":null,"layout":null,"metadata":null,"text":"Here’s a step-by-step breakdown of how we combine the sequences and labels from all tickers into a consolidated training dataset:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_77":{"__typename":"Paragraph","id":"9d2a01304107_77","name":"c8df","type":"OLI","href":null,"layout":null,"metadata":null,"text":"Data Aggregation: By iterating over each ticker, we extend these lists with sequences and labels generated for each stock, effectively pooling all the data into a single dataset.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":17,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_78":{"__typename":"Paragraph","id":"9d2a01304107_78","name":"5a3d","type":"OLI","href":null,"layout":null,"metadata":null,"text":"Conversion to Numpy Arrays: After aggregating the data, we convert the lists of sequences and labels into Numpy arrays. This conversion is crucial for compatibility with TensorFlow and Keras, which prefer Numpy array inputs for model training and evaluation. It also facilitates efficient handling and computation during the training process.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":27,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_79":{"__typename":"Paragraph","id":"9d2a01304107_79","name":"dcd5","type":"PRE","href":null,"layout":null,"metadata":null,"text":"# Combine data and labels from all tickers\nall_sequences = []\nall_labels = []\n\nfor ticker in tickers:\n    all_sequences.extend(sequences_dict[ticker])\n    all_labels.extend(sequence_labels[ticker])\n\n# Convert to numpy arrays\nall_sequences = np.array(all_sequences)\nall_labels = np.array(all_labels)","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"EXPLICIT","lang":"python"},"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_80":{"__typename":"Paragraph","id":"9d2a01304107_80","name":"7918","type":"H3","href":null,"layout":null,"metadata":null,"text":"Preparing Dataset Splits for Model Training and Evaluation","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_81":{"__typename":"Paragraph","id":"9d2a01304107_81","name":"ffba","type":"P","href":null,"layout":null,"metadata":null,"text":"A crucial step in preparing our dataset for the machine learning workflow is to shuffle and split the data into training, validation, and test sets. This process ensures that the model is trained on a diverse subset of data, validated on unseen data to avoid overfitting, and finally tested on completely separate data to evaluate its performance.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_82":{"__typename":"Paragraph","id":"9d2a01304107_82","name":"63b6","type":"H4","href":null,"layout":null,"metadata":null,"text":"Shuffling and Splitting the Dataset","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_83":{"__typename":"Paragraph","id":"9d2a01304107_83","name":"12ac","type":"OLI","href":null,"layout":null,"metadata":null,"text":"Setting a Random Seed: We set a random seed to ensure reproducibility. This means the random processes will behave the same way each time the code is run, which is important for debugging and comparing model performance across different runs.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":22,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_84":{"__typename":"Paragraph","id":"9d2a01304107_84","name":"b096","type":"OLI","href":null,"layout":null,"metadata":null,"text":"Shuffling the Data: We shuffle the sequences and their corresponding labels to randomize the order. This randomization helps prevent any biases that might occur due to the order in which data was originally processed or collected.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":19,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_85":{"__typename":"Paragraph","id":"9d2a01304107_85","name":"d1d0","type":"OLI","href":null,"layout":null,"metadata":null,"text":"Splitting the Data: We first determine the size of the training set as 90% of the total data. The remaining 10% will be split further into validation and test sets.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":20,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_86":{"__typename":"Paragraph","id":"9d2a01304107_86","name":"a371","type":"OLI","href":null,"layout":null,"metadata":null,"text":"Creating Validation and Test Sets: The validation set is set to 50% of the remaining data. The rest is reserved as the test set. This split provides a good balance, allowing sufficient data for both validation and final evaluation.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":34,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_87":{"__typename":"Paragraph","id":"9d2a01304107_87","name":"072e","type":"PRE","href":null,"layout":null,"metadata":null,"text":"np.random.seed(42)\nshuffled_indices = np.random.permutation(len(all_sequences))\nall_sequences = all_sequences[shuffled_indices]\nall_labels = all_labels[shuffled_indices]\n\ntrain_size = int(len(all_sequences) * 0.9)\n\n# Split sequences\ntrain_sequences = all_sequences[:train_size]\ntrain_labels    = all_labels[:train_size]\n\nother_sequences = all_sequences[train_size:]\nother_labels    = all_labels[train_size:]\n\nshuffled_indices = np.random.permutation(len(other_sequences))\nother_sequences = other_sequences[shuffled_indices]\nother_labels = other_labels[shuffled_indices]\n\nval_size = int(len(other_sequences) * 0.5)\n\nvalidation_sequences = other_sequences[:val_size]\nvalidation_labels = other_labels[:val_size]\n\ntest_sequences = other_sequences[val_size:]\ntest_labels = other_labels[val_size:]","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"EXPLICIT","lang":"python"},"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_88":{"__typename":"Paragraph","id":"9d2a01304107_88","name":"8941","type":"P","href":null,"layout":null,"metadata":null,"text":"Now that we have prepared our data, lets build our transformer model","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_89":{"__typename":"Paragraph","id":"9d2a01304107_89","name":"b966","type":"H3","href":null,"layout":null,"metadata":null,"text":"Building a Transformer Model for Time-Series Forecasting","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_90":{"__typename":"Paragraph","id":"9d2a01304107_90","name":"ef04","type":"P","href":null,"layout":null,"metadata":null,"text":"In this section, we delve into the architecture of the Transformer model, specifically tailored for time-series forecasting. The Transformer, known for its effectiveness in handling sequence data thanks to its attention mechanisms, is particularly well-suited for complex tasks like stock price prediction.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_91":{"__typename":"Paragraph","id":"9d2a01304107_91","name":"718d","type":"H4","href":null,"layout":null,"metadata":null,"text":"Transformer Model Architecture","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_92":{"__typename":"Paragraph","id":"9d2a01304107_92","name":"8bdf","type":"BQ","href":null,"layout":null,"metadata":null,"text":"Transformer Encoder Function:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":29,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_93":{"__typename":"Paragraph","id":"9d2a01304107_93","name":"9ab9","type":"ULI","href":null,"layout":null,"metadata":null,"text":"The encoder function forms the core of our Transformer model. It comprises several key operations that process the input sequences.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_94":{"__typename":"Paragraph","id":"9d2a01304107_94","name":"2210","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Layer Normalization: Normalizes the input layer to speed up the training and stabilize the network.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_95":{"__typename":"Paragraph","id":"9d2a01304107_95","name":"6b28","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Multi-Head Attention: Allows the model to jointly attend to information from different representation subspaces at different positions, capturing various aspects of the input data.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_96":{"__typename":"Paragraph","id":"9d2a01304107_96","name":"16d4","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Feed Forward Network: A simple neural network applied to each position separately and identically, enhancing the model’s ability to process complex patterns.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_97":{"__typename":"Paragraph","id":"9d2a01304107_97","name":"fd2e","type":"PRE","href":null,"layout":null,"metadata":null,"text":"def transformer_encoder(inputs, head_size, num_heads, ff_dim, dropout=0):\n    # Attention and Normalization\n    x = LayerNormalization(epsilon=1e-6)(inputs)\n    x = MultiHeadAttention(key_dim=head_size, num_heads=num_heads, dropout=dropout)(x, x)\n    x = Add()([x, inputs])\n\n    # Feed Forward Part\n    y = LayerNormalization(epsilon=1e-6)(x)\n    y = Dense(ff_dim, activation=\"relu\")(y)\n    y = Dropout(dropout)(y)\n    y = Dense(inputs.shape[-1])(y)\n    return Add()([y, x])","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"EXPLICIT","lang":"python"},"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_98":{"__typename":"Paragraph","id":"9d2a01304107_98","name":"2b11","type":"BQ","href":null,"layout":null,"metadata":null,"text":"Building the Complete Model:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":28,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_99":{"__typename":"Paragraph","id":"9d2a01304107_99","name":"9fde","type":"ULI","href":null,"layout":null,"metadata":null,"text":"The model is built by stacking multiple layers of the transformer encoder to deepen the network, which enhances its ability to learn from data.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_100":{"__typename":"Paragraph","id":"9d2a01304107_100","name":"1971","type":"ULI","href":null,"layout":null,"metadata":null,"text":"A Global Average Pooling layer follows the Transformer blocks to reduce the dimensionality of the output, making the model more manageable and focusing on the most important features.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_101":{"__typename":"Paragraph","id":"9d2a01304107_101","name":"eff3","type":"ULI","href":null,"layout":null,"metadata":null,"text":"The final output layer is a dense layer with a linear activation function, designed to predict continuous values, such as stock prices.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_102":{"__typename":"Paragraph","id":"9d2a01304107_102","name":"7820","type":"PRE","href":null,"layout":null,"metadata":null,"text":"def build_transformer_model(input_shape, head_size, num_heads, ff_dim, num_layers, dropout=0):\n    inputs = Input(shape=input_shape)\n    x = inputs\n    for _ in range(num_layers):\n        x = transformer_encoder(x, head_size, num_heads, ff_dim, dropout)\n    x = GlobalAveragePooling1D()(x)\n    x = LayerNormalization(epsilon=1e-6)(x)\n    outputs = Dense(1, activation=\"linear\")(x)\n    return Model(inputs=inputs, outputs=outputs)","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"EXPLICIT","lang":"python"},"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_103":{"__typename":"Paragraph","id":"9d2a01304107_103","name":"2214","type":"BQ","href":null,"layout":null,"metadata":null,"text":"Model Parameters and Compilation:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":33,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_104":{"__typename":"Paragraph","id":"9d2a01304107_104","name":"7be7","type":"ULI","href":null,"layout":null,"metadata":null,"text":"We specify the model parameters such as the input shape, head size, number of heads, dimensionality of the feed-forward network, number of layers, and dropout rate.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_105":{"__typename":"Paragraph","id":"9d2a01304107_105","name":"ad50","type":"ULI","href":null,"layout":null,"metadata":null,"text":"These parameters are crucial as they define how deep and complex the model is, influencing its ability to learn and generalize.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_106":{"__typename":"Paragraph","id":"9d2a01304107_106","name":"8072","type":"PRE","href":null,"layout":null,"metadata":null,"text":"input_shape = train_sequences.shape[1:]\nhead_size = 256\nnum_heads = 16\nff_dim = 1024\nnum_layers = 12\ndropout = 0.20\n\nmodel = build_transformer_model(input_shape, head_size, num_heads, ff_dim, num_layers, dropout)\nmodel.summary()","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"EXPLICIT","lang":"python"},"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*IcRJj9NmCANxpU8Z6Fe5gQ.png":{"__typename":"ImageMetadata","id":"1*IcRJj9NmCANxpU8Z6Fe5gQ.png","originalHeight":83,"originalWidth":459,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:9d2a01304107_107":{"__typename":"Paragraph","id":"9d2a01304107_107","name":"dc2e","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*IcRJj9NmCANxpU8Z6Fe5gQ.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_108":{"__typename":"Paragraph","id":"9d2a01304107_108","name":"481f","type":"H3","href":null,"layout":null,"metadata":null,"text":"Implementing Custom Loss Function and Accuracy Metric","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_109":{"__typename":"Paragraph","id":"9d2a01304107_109","name":"1084","type":"P","href":null,"layout":null,"metadata":null,"text":"To optimize our Transformer model for stock price prediction, we define a custom mean absolute error (MAE) loss function and a directional accuracy metric. These functions are tailored to accurately assess the performance of our model in predicting the direction of stock price movements, which is often more valuable than predicting exact prices in financial markets.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_110":{"__typename":"Paragraph","id":"9d2a01304107_110","name":"805c","type":"H4","href":null,"layout":null,"metadata":null,"text":"Custom MAE Loss Function & Directional Accuracy","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_111":{"__typename":"Paragraph","id":"9d2a01304107_111","name":"bd07","type":"OLI","href":null,"layout":null,"metadata":null,"text":"Custom MAE Loss Function: The custom MAE loss function calculates the mean absolute error between the predicted next value and the actual next value. This loss function helps in minimizing the prediction error in terms of actual price values.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":25,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_112":{"__typename":"Paragraph","id":"9d2a01304107_112","name":"b378","type":"OLI","href":null,"layout":null,"metadata":null,"text":"Directional Accuracy Metric:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":28,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_113":{"__typename":"Paragraph","id":"9d2a01304107_113","name":"f15d","type":"ULI","href":null,"layout":null,"metadata":null,"text":"This metric calculates the accuracy with which the model predicts the direction of price movement, rather than the exact values. It compares the sign of the true change in price (up or down) to the sign of the predicted change.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_114":{"__typename":"Paragraph","id":"9d2a01304107_114","name":"b33a","type":"ULI","href":null,"layout":null,"metadata":null,"text":"The metric is essential for trading strategies where the correct prediction of price movement direction can yield significant returns.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_115":{"__typename":"Paragraph","id":"9d2a01304107_115","name":"fb59","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Note: Directional Accuracy is the reason why we must have Mean and Standard Deviation with our label.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":101,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":0,"end":101,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_116":{"__typename":"Paragraph","id":"9d2a01304107_116","name":"b2f8","type":"PRE","href":null,"layout":null,"metadata":null,"text":"def custom_mae_loss(y_true, y_pred):\n    y_true_next = tf.cast(y_true[:, 1], tf.float64)  # Extract the true next values, scaled\n    y_pred_next = tf.cast(y_pred[:, 0], tf.float64)  # Extract the predicted next values, scaled\n    abs_error = tf.abs(y_true_next - y_pred_next)  # Calculate the absolute error\n    return tf.reduce_mean(abs_error)  # Return the mean of these errors\n\ndef dir_acc(y_true, y_pred):\n    mean, std = tf.cast(y_true[:, 2], tf.float64), tf.cast(y_true[:, 3], tf.float64)  # Retrieve scaling factors\n    y_true_prev = (tf.cast(y_true[:, 0], tf.float64) * std) + mean  # Un-scale previous true price\n    y_true_next = (tf.cast(y_true[:, 1], tf.float64) * std) + mean  # Un-scale next true price\n    y_pred_next = (tf.cast(y_pred[:, 0], tf.float64) * std) + mean  # Un-scale predicted next price\n\n    true_change = y_true_next - y_true_prev  # Calculate true change\n    pred_change = y_pred_next - y_true_prev  # Calculate predicted change\n\n    correct_direction = tf.equal(tf.sign(true_change), tf.sign(pred_change))  # Check if the signs match\n    return tf.reduce_mean(tf.cast(correct_direction, tf.float64))  # Return the mean of correct directions","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"EXPLICIT","lang":"python"},"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_117":{"__typename":"Paragraph","id":"9d2a01304107_117","name":"2803","type":"H3","href":null,"layout":null,"metadata":null,"text":"Optimizing Training with Callbacks and Learning Rate Scheduling","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_118":{"__typename":"Paragraph","id":"9d2a01304107_118","name":"cf5f","type":"P","href":null,"layout":null,"metadata":null,"text":"To maximize the performance of our Transformer model and ensure robust training, we implement several TensorFlow callbacks. These include mechanisms to save the best performing models and to adjust the learning rate dynamically during training. Such techniques help improve the model’s convergence and generalization capabilities.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_119":{"__typename":"Paragraph","id":"9d2a01304107_119","name":"28b7","type":"H4","href":null,"layout":null,"metadata":null,"text":"Model Checkpoint Callbacks","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_120":{"__typename":"Paragraph","id":"9d2a01304107_120","name":"ac7c","type":"OLI","href":null,"layout":null,"metadata":null,"text":"Saving the Best Training Model: We use ModelCheckpoint to automatically save the model weights that achieve the highest 'directional accuracy' during training. This ensures that we retain the best model iteration, potentially preventing overfitting on the training data.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":39,"end":54,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":0,"end":31,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_121":{"__typename":"Paragraph","id":"9d2a01304107_121","name":"802e","type":"OLI","href":null,"layout":null,"metadata":null,"text":"Saving the Best Validation Model: Similarly, we set another checkpoint for the validation phase. This saves the model iteration that performs best on the validation dataset, according to the ‘directional accuracy’ metric. It’s crucial for tuning the model to perform well on unseen data.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":33,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_122":{"__typename":"Paragraph","id":"9d2a01304107_122","name":"718a","type":"OLI","href":null,"layout":null,"metadata":null,"text":"Dynamic Learning Rate Adjustment:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":33,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_123":{"__typename":"Paragraph","id":"9d2a01304107_123","name":"b4e2","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Adjusting the learning rate during training can significantly impact the model’s training dynamics and final performance. We implement a custom learning rate scheduler that:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_124":{"__typename":"Paragraph","id":"9d2a01304107_124","name":"8edb","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Warms up the learning rate linearly during the initial phase.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_125":{"__typename":"Paragraph","id":"9d2a01304107_125","name":"adb8","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Holds the maximum learning rate for a sustain phase, if defined.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_126":{"__typename":"Paragraph","id":"9d2a01304107_126","name":"001c","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Applies a cosine decay for the learning rate to smoothly reduce it to a minimum, helping the model to fine-tune its weights in later epochs.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_127":{"__typename":"Paragraph","id":"9d2a01304107_127","name":"9b80","type":"PRE","href":null,"layout":null,"metadata":null,"text":"# Define a callback to save the best model\ncheckpoint_callback_train = ModelCheckpoint(\n    \"transformer_train_model.keras\",  # Filepath to save the best model\n    monitor=\"dir_acc\",  #\"loss\",  # Metric to monitor\n    save_best_only=True,  # Save only the best model\n    mode=\"max\",  # Minimize the monitored metric \n    verbose=1,  # Display progress\n)\n\n# Define a callback to save the best model\ncheckpoint_callback_val = ModelCheckpoint(\n    \"transformer_val_model.keras\",  # Filepath to save the best model\n    monitor=\"val_dir_acc\", #\"val_loss\",  # Metric to monitor\n    save_best_only=True,  # Save only the best model\n    mode=\"max\",  # Minimize the monitored metric \n    verbose=1,  # Display progress\n)\n\ndef get_lr_callback(batch_size=16, mode='cos', epochs=500, plot=False):\n    lr_start, lr_max, lr_min = 0.0001, 0.005, 0.00001  # Adjust learning rate boundaries\n    lr_ramp_ep = int(0.30 * epochs)  # 30% of epochs for warm-up\n    lr_sus_ep = max(0, int(0.10 * epochs) - lr_ramp_ep)  # Optional sustain phase, adjust as needed\n\n    def lrfn(epoch):\n        if epoch \u003C lr_ramp_ep:  # Warm-up phase\n            lr = (lr_max - lr_start) \u002F lr_ramp_ep * epoch + lr_start\n        elif epoch \u003C lr_ramp_ep + lr_sus_ep:  # Sustain phase at max learning rate\n            lr = lr_max\n        elif mode == 'cos':\n            decay_total_epochs, decay_epoch_index = epochs - lr_ramp_ep - lr_sus_ep, epoch - lr_ramp_ep - lr_sus_ep\n            phase = math.pi * decay_epoch_index \u002F decay_total_epochs\n            lr = (lr_max - lr_min) * 0.5 * (1 + math.cos(phase)) + lr_min\n        else:\n            lr = lr_min  # Default to minimum learning rate if mode is not recognized\n\n        return lr\n\n    if plot:  # Plot learning rate curve if plot is True\n        plt.figure(figsize=(10, 5))\n        plt.plot(np.arange(epochs), [lrfn(epoch) for epoch in np.arange(epochs)], marker='o')\n        plt.xlabel('Epoch')\n        plt.ylabel('Learning Rate')\n        plt.title('Learning Rate Scheduler')\n        plt.show()\n\n    return tf.keras.callbacks.LearningRateScheduler(lrfn, verbose=True)","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"EXPLICIT","lang":"python"},"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*ZsbF0HgSM9IBd-0XexYrLA.png":{"__typename":"ImageMetadata","id":"1*ZsbF0HgSM9IBd-0XexYrLA.png","originalHeight":468,"originalWidth":862,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:9d2a01304107_128":{"__typename":"Paragraph","id":"9d2a01304107_128","name":"3310","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*ZsbF0HgSM9IBd-0XexYrLA.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_129":{"__typename":"Paragraph","id":"9d2a01304107_129","name":"3413","type":"H3","href":null,"layout":null,"metadata":null,"text":"Training the Transformer Model","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_130":{"__typename":"Paragraph","id":"9d2a01304107_130","name":"526f","type":"P","href":null,"layout":null,"metadata":null,"text":"Now that we have set up our model and defined the necessary callbacks and learning rate adjustments, we can proceed to train the model. Training involves feeding the model with sequences of stock data and optimizing the model parameters to minimize prediction errors on the training data while validating its performance on unseen validation data.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_131":{"__typename":"Paragraph","id":"9d2a01304107_131","name":"b32a","type":"H4","href":null,"layout":null,"metadata":null,"text":"Model Training Process","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_132":{"__typename":"Paragraph","id":"9d2a01304107_132","name":"dc21","type":"OLI","href":null,"layout":null,"metadata":null,"text":"Setting Training Parameters: We define the BATCH_SIZE and EPOCHS, which are crucial for determining how the data is fed into the model and how many times the entire dataset is passed through the model, respectively.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":43,"end":53,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":58,"end":64,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":0,"end":28,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_133":{"__typename":"Paragraph","id":"9d2a01304107_133","name":"e673","type":"OLI","href":null,"layout":null,"metadata":null,"text":"Model Fitting:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":14,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_134":{"__typename":"Paragraph","id":"9d2a01304107_134","name":"4fd4","type":"ULI","href":null,"layout":null,"metadata":null,"text":"The fit method on our model object is used to start the training process. We specify the training data, the corresponding labels, the validation data, and the number of epochs.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":4,"end":7,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_135":{"__typename":"Paragraph","id":"9d2a01304107_135","name":"109f","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Callbacks including model checkpoints and learning rate adjustments are passed to monitor and enhance the training process as needed.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_136":{"__typename":"Paragraph","id":"9d2a01304107_136","name":"ddec","type":"PRE","href":null,"layout":null,"metadata":null,"text":"BATCH_SIZE = 64  # Number of training examples used to calculate each iteration's gradient\nEPOCHS = 100  # Total number of times the entire dataset is passed through the network\n\nmodel.fit(\n    train_sequences,  # Training features\n    train_labels,  # Training labels\n    validation_data=(validation_sequences, validation_labels),  # Validation data\n    epochs=EPOCHS,  # Number of epochs to train for\n    batch_size=BATCH_SIZE,  # Size of each batch\n    shuffle=True,  # Shuffle training data before each epoch\n    callbacks=[checkpoint_callback_train, checkpoint_callback_val, get_lr_callback(batch_size=BATCH_SIZE, epochs=EPOCHS)]  # Callbacks for saving models and adjusting learning rate\n)","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"makefile"},"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*KJb9_JqK62Db-_D9A1urrg.png":{"__typename":"ImageMetadata","id":"1*KJb9_JqK62Db-_D9A1urrg.png","originalHeight":530,"originalWidth":1267,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:9d2a01304107_137":{"__typename":"Paragraph","id":"9d2a01304107_137","name":"8791","type":"IMG","href":null,"layout":"OUTSET_CENTER","metadata":{"__ref":"ImageMetadata:1*KJb9_JqK62Db-_D9A1urrg.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*8b8if47FR9gyz1bANftuFA.png":{"__typename":"ImageMetadata","id":"1*8b8if47FR9gyz1bANftuFA.png","originalHeight":520,"originalWidth":1264,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:9d2a01304107_138":{"__typename":"Paragraph","id":"9d2a01304107_138","name":"5a40","type":"IMG","href":null,"layout":"OUTSET_CENTER","metadata":{"__ref":"ImageMetadata:1*8b8if47FR9gyz1bANftuFA.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_139":{"__typename":"Paragraph","id":"9d2a01304107_139","name":"5ee5","type":"H3","href":null,"layout":null,"metadata":null,"text":"Evaluating the Transformer Model’s Performance","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_140":{"__typename":"Paragraph","id":"9d2a01304107_140","name":"9ce6","type":"P","href":null,"layout":null,"metadata":null,"text":"After training the model and optimizing its parameters through various training epochs, the next step is to load the best-performing model and evaluate its performance on the test dataset. This step is crucial to verify the model’s effectiveness in making predictions in a real-world scenario.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_141":{"__typename":"Paragraph","id":"9d2a01304107_141","name":"3832","type":"H4","href":null,"layout":null,"metadata":null,"text":"Model Evaluation and Metric Calculation","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_142":{"__typename":"Paragraph","id":"9d2a01304107_142","name":"cca8","type":"P","href":null,"layout":null,"metadata":null,"text":"Loading the Best Model Weights: We begin by loading the weights of the model that performed best on the validation dataset. This ensures that the evaluation is done using the most effective version of the trained model.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":31,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_143":{"__typename":"Paragraph","id":"9d2a01304107_143","name":"d274","type":"OLI","href":null,"layout":null,"metadata":null,"text":"Model Evaluation on Test Data: We use the evaluate method to assess the model’s performance on the test dataset. This method computes the loss and any other metrics we defined earlier, like directional accuracy, on this new dataset.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":42,"end":50,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":0,"end":30,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_144":{"__typename":"Paragraph","id":"9d2a01304107_144","name":"0a69","type":"OLI","href":null,"layout":null,"metadata":null,"text":"Calculating Additional Metrics: To gain more insights into the model’s predictive power, we calculate the R-squared statistic, which provides a measure of how well the observed outcomes are replicated by the model, based on the proportion of total variation of outcomes explained by the model.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":31,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_145":{"__typename":"Paragraph","id":"9d2a01304107_145","name":"e8f4","type":"PRE","href":null,"layout":null,"metadata":null,"text":"model.load_weights(\"transformer_val_model.keras\")  # Load the best model from the validation phase\naccuracy = model.evaluate(test_sequences, test_labels)[1]  # Evaluate the model on the test data\nprint(accuracy)\n\nfrom sklearn.metrics import r2_score\n\npredictions = model.predict(test_sequences)  # Make predictions on the test dataset\nr2 = r2_score(test_labels[:, 1], predictions[:, 0])  # Calculate R-squared value\nprint(f\"R-squared: {r2}\")","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"python"},"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*dyqTQDByFO4JUd7ZS_ujhA.png":{"__typename":"ImageMetadata","id":"1*dyqTQDByFO4JUd7ZS_ujhA.png","originalHeight":79,"originalWidth":738,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:9d2a01304107_146":{"__typename":"Paragraph","id":"9d2a01304107_146","name":"0216","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*dyqTQDByFO4JUd7ZS_ujhA.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_147":{"__typename":"Paragraph","id":"9d2a01304107_147","name":"2544","type":"H3","href":null,"layout":null,"metadata":null,"text":"Conclusion and Future Directions","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_148":{"__typename":"Paragraph","id":"9d2a01304107_148","name":"3428","type":"P","href":null,"layout":null,"metadata":null,"text":"Our journey through developing and training a Transformer model for predicting stock price movements has shown promising results. Starting from a baseline accuracy of 50%, we have achieved significant improvements, reaching directional accuracies around 70% towards the end of 100 training epochs. This progression underscores the potential of our model to effectively capture and predict trends in stock prices.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_149":{"__typename":"Paragraph","id":"9d2a01304107_149","name":"8cae","type":"H4","href":null,"layout":null,"metadata":null,"text":"Achievements","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_150":{"__typename":"Paragraph","id":"9d2a01304107_150","name":"ce39","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Model Performance: The improvement in accuracy demonstrates the model’s capacity to learn complex patterns in the stock market data, affirming the effectiveness of the Transformer architecture for this type of time-series analysis.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_151":{"__typename":"Paragraph","id":"9d2a01304107_151","name":"5a7f","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Progressive Learning: The continued enhancements observed up to the 100th epoch indicate that the model benefits from extended training periods, progressively refining its predictions.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_152":{"__typename":"Paragraph","id":"9d2a01304107_152","name":"538c","type":"H4","href":null,"layout":null,"metadata":null,"text":"Challenges and Limitations","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_153":{"__typename":"Paragraph","id":"9d2a01304107_153","name":"dc30","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Hardware and Time Constraints: Despite the promising improvements, further training was curtailed by limitations in available computational resources and time. Such constraints are common in real-world scenarios and need to be planned for accordingly.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_154":{"__typename":"Paragraph","id":"9d2a01304107_154","name":"fffc","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Convergence: The model had not fully converged within the allocated 100 epochs, suggesting that additional epochs could yield further gains in accuracy.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_155":{"__typename":"Paragraph","id":"9d2a01304107_155","name":"ad1c","type":"H4","href":null,"layout":null,"metadata":null,"text":"Recommendations for Future Work","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_156":{"__typename":"Paragraph","id":"9d2a01304107_156","name":"04f3","type":"OLI","href":null,"layout":null,"metadata":null,"text":"Extended Training: If resources permit, future experiments should consider extending the number of epochs. This could help the model to fully converge and potentially uncover more nuanced patterns in the data.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_157":{"__typename":"Paragraph","id":"9d2a01304107_157","name":"a6b2","type":"OLI","href":null,"layout":null,"metadata":null,"text":"Hardware Optimization: Leveraging more powerful computing resources or cloud-based platforms could mitigate hardware limitations, allowing for more extensive training and experimentation.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_158":{"__typename":"Paragraph","id":"9d2a01304107_158","name":"f42a","type":"OLI","href":null,"layout":null,"metadata":null,"text":"Hyperparameter Tuning: Experimenting with different model architectures, learning rates, and other hyperparameters could further enhance model performance.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_159":{"__typename":"Paragraph","id":"9d2a01304107_159","name":"2c5c","type":"OLI","href":null,"layout":null,"metadata":null,"text":"Feature Engineering: Incorporating additional features or experimenting with different combinations of existing indicators might provide new insights and improve predictive accuracy.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_160":{"__typename":"Paragraph","id":"9d2a01304107_160","name":"512a","type":"H4","href":null,"layout":null,"metadata":null,"text":"Final Thoughts","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_161":{"__typename":"Paragraph","id":"9d2a01304107_161","name":"d8e5","type":"P","href":null,"layout":null,"metadata":null,"text":"The work done so far lays a solid foundation for future exploration and improvements. The Transformer model, with its advanced capabilities for handling sequential data, presents a robust framework for financial market analysis. While we have encountered practical limitations, the pathway for enhancing this model is clear and well-defined. Continued efforts in this direction are likely to yield a model that is not only accurate but also invaluable for real-time trading strategies.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9d2a01304107_162":{"__typename":"Paragraph","id":"9d2a01304107_162","name":"4b9d","type":"P","href":null,"layout":null,"metadata":null,"text":"You can check out my notebook for this project here.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":47,"end":51,"href":"https:\u002F\u002Fcolab.research.google.com\u002Fdrive\u002F1j3AYSIxhiNJSCP692pKPbLk4_-kG4Pmh?usp=sharing","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*DkD1UqtzggbRdfe8":{"__typename":"ImageMetadata","id":"0*DkD1UqtzggbRdfe8","originalHeight":1024,"originalWidth":1024,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:9d2a01304107_163":{"__typename":"Paragraph","id":"9d2a01304107_163","name":"9740","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:0*DkD1UqtzggbRdfe8"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Membership:d171e69d6a0d":{"__typename":"Membership","tier":"MEMBER","id":"d171e69d6a0d"},"Tag:transformers":{"__typename":"Tag","id":"transformers","displayTitle":"Transformers","normalizedTagSlug":"transformers"},"Tag:machine-learning":{"__typename":"Tag","id":"machine-learning","displayTitle":"Machine Learning","normalizedTagSlug":"machine-learning"},"Tag:artificial-intelligence":{"__typename":"Tag","id":"artificial-intelligence","displayTitle":"Artificial Intelligence","normalizedTagSlug":"artificial-intelligence"},"Tag:stock-market":{"__typename":"Tag","id":"stock-market","displayTitle":"Stock Market","normalizedTagSlug":"stock-market"},"Tag:python":{"__typename":"Tag","id":"python","displayTitle":"Python","normalizedTagSlug":"python"},"Post:2d84341ff213":{"__typename":"Post","id":"2d84341ff213","collection":null,"content({\"postMeteringOptions\":{}})":{"__typename":"PostContent","isLockedPreviewOnly":false,"bodyModel":{"__typename":"RichText","sections":[{"__typename":"Section","name":"8fb9","startIndex":0,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null},{"__typename":"Section","name":"4792","startIndex":7,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null},{"__typename":"Section","name":"777c","startIndex":89,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null},{"__typename":"Section","name":"8917","startIndex":138,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null},{"__typename":"Section","name":"9e41","startIndex":147,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null}],"paragraphs":[{"__ref":"Paragraph:9d2a01304107_0"},{"__ref":"Paragraph:9d2a01304107_1"},{"__ref":"Paragraph:9d2a01304107_2"},{"__ref":"Paragraph:9d2a01304107_3"},{"__ref":"Paragraph:9d2a01304107_4"},{"__ref":"Paragraph:9d2a01304107_5"},{"__ref":"Paragraph:9d2a01304107_6"},{"__ref":"Paragraph:9d2a01304107_7"},{"__ref":"Paragraph:9d2a01304107_8"},{"__ref":"Paragraph:9d2a01304107_9"},{"__ref":"Paragraph:9d2a01304107_10"},{"__ref":"Paragraph:9d2a01304107_11"},{"__ref":"Paragraph:9d2a01304107_12"},{"__ref":"Paragraph:9d2a01304107_13"},{"__ref":"Paragraph:9d2a01304107_14"},{"__ref":"Paragraph:9d2a01304107_15"},{"__ref":"Paragraph:9d2a01304107_16"},{"__ref":"Paragraph:9d2a01304107_17"},{"__ref":"Paragraph:9d2a01304107_18"},{"__ref":"Paragraph:9d2a01304107_19"},{"__ref":"Paragraph:9d2a01304107_20"},{"__ref":"Paragraph:9d2a01304107_21"},{"__ref":"Paragraph:9d2a01304107_22"},{"__ref":"Paragraph:9d2a01304107_23"},{"__ref":"Paragraph:9d2a01304107_24"},{"__ref":"Paragraph:9d2a01304107_25"},{"__ref":"Paragraph:9d2a01304107_26"},{"__ref":"Paragraph:9d2a01304107_27"},{"__ref":"Paragraph:9d2a01304107_28"},{"__ref":"Paragraph:9d2a01304107_29"},{"__ref":"Paragraph:9d2a01304107_30"},{"__ref":"Paragraph:9d2a01304107_31"},{"__ref":"Paragraph:9d2a01304107_32"},{"__ref":"Paragraph:9d2a01304107_33"},{"__ref":"Paragraph:9d2a01304107_34"},{"__ref":"Paragraph:9d2a01304107_35"},{"__ref":"Paragraph:9d2a01304107_36"},{"__ref":"Paragraph:9d2a01304107_37"},{"__ref":"Paragraph:9d2a01304107_38"},{"__ref":"Paragraph:9d2a01304107_39"},{"__ref":"Paragraph:9d2a01304107_40"},{"__ref":"Paragraph:9d2a01304107_41"},{"__ref":"Paragraph:9d2a01304107_42"},{"__ref":"Paragraph:9d2a01304107_43"},{"__ref":"Paragraph:9d2a01304107_44"},{"__ref":"Paragraph:9d2a01304107_45"},{"__ref":"Paragraph:9d2a01304107_46"},{"__ref":"Paragraph:9d2a01304107_47"},{"__ref":"Paragraph:9d2a01304107_48"},{"__ref":"Paragraph:9d2a01304107_49"},{"__ref":"Paragraph:9d2a01304107_50"},{"__ref":"Paragraph:9d2a01304107_51"},{"__ref":"Paragraph:9d2a01304107_52"},{"__ref":"Paragraph:9d2a01304107_53"},{"__ref":"Paragraph:9d2a01304107_54"},{"__ref":"Paragraph:9d2a01304107_55"},{"__ref":"Paragraph:9d2a01304107_56"},{"__ref":"Paragraph:9d2a01304107_57"},{"__ref":"Paragraph:9d2a01304107_58"},{"__ref":"Paragraph:9d2a01304107_59"},{"__ref":"Paragraph:9d2a01304107_60"},{"__ref":"Paragraph:9d2a01304107_61"},{"__ref":"Paragraph:9d2a01304107_62"},{"__ref":"Paragraph:9d2a01304107_63"},{"__ref":"Paragraph:9d2a01304107_64"},{"__ref":"Paragraph:9d2a01304107_65"},{"__ref":"Paragraph:9d2a01304107_66"},{"__ref":"Paragraph:9d2a01304107_67"},{"__ref":"Paragraph:9d2a01304107_68"},{"__ref":"Paragraph:9d2a01304107_69"},{"__ref":"Paragraph:9d2a01304107_70"},{"__ref":"Paragraph:9d2a01304107_71"},{"__ref":"Paragraph:9d2a01304107_72"},{"__ref":"Paragraph:9d2a01304107_73"},{"__ref":"Paragraph:9d2a01304107_74"},{"__ref":"Paragraph:9d2a01304107_75"},{"__ref":"Paragraph:9d2a01304107_76"},{"__ref":"Paragraph:9d2a01304107_77"},{"__ref":"Paragraph:9d2a01304107_78"},{"__ref":"Paragraph:9d2a01304107_79"},{"__ref":"Paragraph:9d2a01304107_80"},{"__ref":"Paragraph:9d2a01304107_81"},{"__ref":"Paragraph:9d2a01304107_82"},{"__ref":"Paragraph:9d2a01304107_83"},{"__ref":"Paragraph:9d2a01304107_84"},{"__ref":"Paragraph:9d2a01304107_85"},{"__ref":"Paragraph:9d2a01304107_86"},{"__ref":"Paragraph:9d2a01304107_87"},{"__ref":"Paragraph:9d2a01304107_88"},{"__ref":"Paragraph:9d2a01304107_89"},{"__ref":"Paragraph:9d2a01304107_90"},{"__ref":"Paragraph:9d2a01304107_91"},{"__ref":"Paragraph:9d2a01304107_92"},{"__ref":"Paragraph:9d2a01304107_93"},{"__ref":"Paragraph:9d2a01304107_94"},{"__ref":"Paragraph:9d2a01304107_95"},{"__ref":"Paragraph:9d2a01304107_96"},{"__ref":"Paragraph:9d2a01304107_97"},{"__ref":"Paragraph:9d2a01304107_98"},{"__ref":"Paragraph:9d2a01304107_99"},{"__ref":"Paragraph:9d2a01304107_100"},{"__ref":"Paragraph:9d2a01304107_101"},{"__ref":"Paragraph:9d2a01304107_102"},{"__ref":"Paragraph:9d2a01304107_103"},{"__ref":"Paragraph:9d2a01304107_104"},{"__ref":"Paragraph:9d2a01304107_105"},{"__ref":"Paragraph:9d2a01304107_106"},{"__ref":"Paragraph:9d2a01304107_107"},{"__ref":"Paragraph:9d2a01304107_108"},{"__ref":"Paragraph:9d2a01304107_109"},{"__ref":"Paragraph:9d2a01304107_110"},{"__ref":"Paragraph:9d2a01304107_111"},{"__ref":"Paragraph:9d2a01304107_112"},{"__ref":"Paragraph:9d2a01304107_113"},{"__ref":"Paragraph:9d2a01304107_114"},{"__ref":"Paragraph:9d2a01304107_115"},{"__ref":"Paragraph:9d2a01304107_116"},{"__ref":"Paragraph:9d2a01304107_117"},{"__ref":"Paragraph:9d2a01304107_118"},{"__ref":"Paragraph:9d2a01304107_119"},{"__ref":"Paragraph:9d2a01304107_120"},{"__ref":"Paragraph:9d2a01304107_121"},{"__ref":"Paragraph:9d2a01304107_122"},{"__ref":"Paragraph:9d2a01304107_123"},{"__ref":"Paragraph:9d2a01304107_124"},{"__ref":"Paragraph:9d2a01304107_125"},{"__ref":"Paragraph:9d2a01304107_126"},{"__ref":"Paragraph:9d2a01304107_127"},{"__ref":"Paragraph:9d2a01304107_128"},{"__ref":"Paragraph:9d2a01304107_129"},{"__ref":"Paragraph:9d2a01304107_130"},{"__ref":"Paragraph:9d2a01304107_131"},{"__ref":"Paragraph:9d2a01304107_132"},{"__ref":"Paragraph:9d2a01304107_133"},{"__ref":"Paragraph:9d2a01304107_134"},{"__ref":"Paragraph:9d2a01304107_135"},{"__ref":"Paragraph:9d2a01304107_136"},{"__ref":"Paragraph:9d2a01304107_137"},{"__ref":"Paragraph:9d2a01304107_138"},{"__ref":"Paragraph:9d2a01304107_139"},{"__ref":"Paragraph:9d2a01304107_140"},{"__ref":"Paragraph:9d2a01304107_141"},{"__ref":"Paragraph:9d2a01304107_142"},{"__ref":"Paragraph:9d2a01304107_143"},{"__ref":"Paragraph:9d2a01304107_144"},{"__ref":"Paragraph:9d2a01304107_145"},{"__ref":"Paragraph:9d2a01304107_146"},{"__ref":"Paragraph:9d2a01304107_147"},{"__ref":"Paragraph:9d2a01304107_148"},{"__ref":"Paragraph:9d2a01304107_149"},{"__ref":"Paragraph:9d2a01304107_150"},{"__ref":"Paragraph:9d2a01304107_151"},{"__ref":"Paragraph:9d2a01304107_152"},{"__ref":"Paragraph:9d2a01304107_153"},{"__ref":"Paragraph:9d2a01304107_154"},{"__ref":"Paragraph:9d2a01304107_155"},{"__ref":"Paragraph:9d2a01304107_156"},{"__ref":"Paragraph:9d2a01304107_157"},{"__ref":"Paragraph:9d2a01304107_158"},{"__ref":"Paragraph:9d2a01304107_159"},{"__ref":"Paragraph:9d2a01304107_160"},{"__ref":"Paragraph:9d2a01304107_161"},{"__ref":"Paragraph:9d2a01304107_162"},{"__ref":"Paragraph:9d2a01304107_163"}]},"validatedShareKey":"","shareKeyCreator":null},"creator":{"__ref":"User:60c8a92cde0b"},"inResponseToEntityType":null,"isLocked":false,"isMarkedPaywallOnly":false,"lockedSource":"LOCKED_POST_SOURCE_NONE","mediumUrl":"https:\u002F\u002Fmedium.com\u002F@Matthew_Frank\u002Fstock-price-prediction-using-transformers-2d84341ff213","primaryTopic":null,"topics":[{"__typename":"Topic","slug":"machine-learning"},{"__typename":"Topic","slug":"data-science"}],"isPublished":true,"latestPublishedVersion":"9d2a01304107","visibility":"PUBLIC","postResponses":{"__typename":"PostResponses","count":4},"createdAt":1714928941749,"firstPublishedAt":1714947331568,"latestPublishedAt":1715022059212,"clapCount":73,"allowResponses":true,"isLimitedState":false,"title":"Stock Price Prediction Using Transformers","isSeries":false,"sequence":null,"uniqueSlug":"stock-price-prediction-using-transformers-2d84341ff213","socialTitle":"","socialDek":"","noIndex":null,"canonicalUrl":"","metaDescription":"","readingTime":19.337106918238995,"previewContent":{"__typename":"PreviewContent","subtitle":"Introduction: The Evolving Landscape of Stock Price Prediction"},"previewImage":{"__ref":"ImageMetadata:0*DkD1UqtzggbRdfe8"},"isShortform":false,"seoTitle":"","updatedAt":1716709933681,"shortformType":"SHORTFORM_TYPE_LINK","seoDescription":"","isSuspended":false,"license":"ALL_RIGHTS_RESERVED","tags":[{"__ref":"Tag:transformers"},{"__ref":"Tag:machine-learning"},{"__ref":"Tag:artificial-intelligence"},{"__ref":"Tag:stock-market"},{"__ref":"Tag:python"}],"isNewsletter":false,"statusForCollection":null,"pendingCollection":null,"detectedLanguage":"en","wordCount":4824,"layerCake":4}}</script><script>window.__MIDDLEWARE_STATE__={"session":{"xsrf":""},"cache":{"cacheStatus":"HIT"}}</script><script src="https://cdn-client.medium.com/lite/static/js/manifest.a6cdf6de.js"></script><script src="https://cdn-client.medium.com/lite/static/js/2640.3217006c.js"></script><script src="https://cdn-client.medium.com/lite/static/js/main.1711822f.js"></script><script src="https://cdn-client.medium.com/lite/static/js/instrumentation.4ddbf12e.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/reporting.2021fe63.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4398.db4d4378.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7883.0e445e04.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9281.e9be8bce.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7111.b294e9da.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6481.362dec70.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6625.5bfe736a.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5924.eb210b66.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/3418.eb013b5a.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5971.2133e397.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5514.32e692f6.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5203.e7f058c5.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7098.93054372.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8051.78428c80.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8558.abbaadfd.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/1711.7605eb3e.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8597.762eae49.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9174.b3a1cedd.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8883.2f95bbf4.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/705.e5898c57.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2911.d072adec.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8580.feeb2549.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6046.f9be485b.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/500.d5389c14.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9408.22b56993.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6605.84e81b15.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6637.661bd7cf.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7421.3f94f5ea.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/51.d8fb2684.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2133.c8ba56b1.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/PostPage.MainContent.4516cd38.chunk.js"></script><script>window.main();</script><script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"rayId":"896664c1bca96f3b","version":"2024.4.1","token":"0b5f665943484354a59c39c6833f7078"}' crossorigin="anonymous"></script>
</body></html>